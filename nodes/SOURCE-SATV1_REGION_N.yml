steps:
  SATV1_REGION_N-a51b8309-eb5f-4f45-9fff-e561e7143242:
    operation:
      config:
        postSQL: ""
        preSQL: ""
      database: ""
      dependencies: []
      deployEnabled: true
      description: Region data as defined by TPC-H
      isDataVault: false
      isMultisource: false
      locationID: ""
      locationName: SOURCE
      materializationType: view
      metadata:
        appliedNodeTests: []
        columns:
          - columnReference:
              columnCounter: de383886-b6bb-4e86-add9-1af28e743d82
              stepCounter: a51b8309-eb5f-4f45-9fff-e561e7143242
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: R_REGIONKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 01d4a840-3422-4ed5-a82c-ea1caf865f7c
                    stepCounter: 94d6f2ff-d7ee-45ed-bdb5-422a7fba69c1
                transform: ""
          - columnReference:
              columnCounter: 4d4c1be6-677c-4055-8b52-d5aa908aa324
              stepCounter: a51b8309-eb5f-4f45-9fff-e561e7143242
            dataType: VARCHAR(25)
            description: ""
            hashColumns: []
            hashDetails: null
            name: R_NAME
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 71864f4b-1a97-45ef-b3af-e256543644a8
                    stepCounter: 94d6f2ff-d7ee-45ed-bdb5-422a7fba69c1
                transform: ""
          - columnReference:
              columnCounter: 21609e43-3be3-4402-921e-e1dc79cb3ebf
              stepCounter: a51b8309-eb5f-4f45-9fff-e561e7143242
            dataType: VARCHAR(152)
            description: ""
            hashColumns: []
            hashDetails: null
            name: R_COMMENT
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: e0b851b5-ee71-4de4-9b8c-b4a024d46fa6
                    stepCounter: 94d6f2ff-d7ee-45ed-bdb5-422a7fba69c1
                transform: ""
          - columnReference:
              columnCounter: acb20944-2a17-442f-871d-6b7f49ccb874
              stepCounter: a51b8309-eb5f-4f45-9fff-e561e7143242
            dataType: TIMESTAMP
            description: The Load Date Timestamp (LDTS) describes when this data first arrived in the Data Warehouse.
            hashColumns: []
            hashDetails: null
            name: LDTS
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 6be03c20-989b-4426-bffd-289d64c61b75
                    stepCounter: 94d6f2ff-d7ee-45ed-bdb5-422a7fba69c1
                transform: ""
          - columnReference:
              columnCounter: 31548f51-92f7-402c-98e4-0253e4b05f2c
              stepCounter: a51b8309-eb5f-4f45-9fff-e561e7143242
            dataType: STRING
            description: The Record Source (RSRC) describes the source of this data.
            hashColumns: []
            hashDetails: null
            name: RSRC
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 975fef25-846f-4808-bf66-44a9522ca290
                    stepCounter: 94d6f2ff-d7ee-45ed-bdb5-422a7fba69c1
                transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: d7eca8cc-345f-4f28-9c74-f0330c7a0221
              stepCounter: a51b8309-eb5f-4f45-9fff-e561e7143242
            config: {}
            dataType: TIMESTAMP
            defaultValue: ""
            description: ""
            hashColumns: []
            is_system_ledts: true
            name: LEDTS
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: |-
                  COALESCE(LEAD("{{ datavault4coalesce.config.ldts_alias }}" - INTERVAL '1 MICROSECOND') 
                  OVER (PARTITION BY "{{ get_value_by_column_attribute("is_hk") }}" 
                  ORDER BY "{{ datavault4coalesce.config.ldts_alias }}"), {{ datavault4coalesce__string_to_timestamp(datavault4coalesce.config.timestamp_format, datavault4coalesce.config.end_of_all_times) }})
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: e87ec8f8-67de-4df7-a224-7a47a062b4d3
              stepCounter: a51b8309-eb5f-4f45-9fff-e561e7143242
            config: {}
            dataType: BOOLEAN
            defaultValue: ""
            description: ""
            hashColumns: []
            is_system_current_col: true
            name: IS_CURRENT
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: |-
                  CASE 
                    WHEN 
                      LEAD("{{ datavault4coalesce.config.ldts_alias }}" - INTERVAL '1 MICROSECOND') 
                      OVER (PARTITION BY "{{ get_value_by_column_attribute("is_hk") }}" 
                      ORDER BY "{{ datavault4coalesce.config.ldts_alias }}") IS NULL 
                    THEN TRUE 
                    ELSE FALSE 
                  END
        cteString: ""
        enabledColumnTestIDs: []
        sourceMapping:
          - customSQL:
              customSQL: ""
            dependencies:
              - locationName: SOURCE
                nodeName: SATV0_REGION_N
            join:
              joinCondition: FROM {{ ref('SOURCE', 'SATV0_REGION_N') }} "SATV0_REGION_N"
            name: SATV1_REGION_N
            noLinkRefs: []
      name: SATV1_REGION_N
      overrideSQL: false
      schema: ""
      sqlType: SCALEFREE-DATAVAULT4COALESCE::9
      type: sql
    stepCounter: a51b8309-eb5f-4f45-9fff-e561e7143242
