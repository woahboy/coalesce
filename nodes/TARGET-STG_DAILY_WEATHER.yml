fileVersion: 1
id: c04f871d-6db8-4066-b341-2b80b7069f56
name: STG_DAILY_WEATHER
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0a5e5103-8af6-4044-b6fa-1c60401a7739
          stepCounter: c04f871d-6db8-4066-b341-2b80b7069f56
        config: {}
        dataType: VARIANT
        description: ""
        name: V
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b24b3e95-ad02-4df0-9a06-7d97ba4764e7
                stepCounter: 6918440d-ac88-47a2-9eba-35ac23f9c906
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 41b80ee9-21bb-4f10-9035-0afd1fe4d948
          stepCounter: c04f871d-6db8-4066-b341-2b80b7069f56
        config: {}
        dataType: TIMESTAMP_NTZ(9)
        description: ""
        name: T
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 77d4362f-ded4-4f71-84a8-37ce4b98bd2d
                stepCounter: 6918440d-ac88-47a2-9eba-35ac23f9c906
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 24ef2de3-2e4e-498b-ac27-861dab86e944
          stepCounter: c04f871d-6db8-4066-b341-2b80b7069f56
        config: {}
        dataType: DOUBLE
        description: ""
        name: city_coord_lat
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b24b3e95-ad02-4df0-9a06-7d97ba4764e7
                stepCounter: 6918440d-ac88-47a2-9eba-35ac23f9c906
            transform: "\"DAILY_WEATHER\".\"V\":\"city\".\"coord\".\"lat\"::DOUBLE"
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 116b7cdf-e19a-4ecd-9d4d-84ae3457de9c
          stepCounter: c04f871d-6db8-4066-b341-2b80b7069f56
        config: {}
        dataType: DOUBLE
        description: ""
        name: city_coord_lon
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b24b3e95-ad02-4df0-9a06-7d97ba4764e7
                stepCounter: 6918440d-ac88-47a2-9eba-35ac23f9c906
            transform: "\"DAILY_WEATHER\".\"V\":\"city\".\"coord\".\"lon\"::DOUBLE"
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: aca6fab9-6cf1-425f-a9a4-87af80b64294
          stepCounter: c04f871d-6db8-4066-b341-2b80b7069f56
        config: {}
        dataType: STRING
        description: ""
        name: city_country
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b24b3e95-ad02-4df0-9a06-7d97ba4764e7
                stepCounter: 6918440d-ac88-47a2-9eba-35ac23f9c906
            transform: "\"DAILY_WEATHER\".\"V\":\"city\".\"country\"::STRING"
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 0386574a-7bd3-4d7e-9895-05a03ed3b0c3
          stepCounter: c04f871d-6db8-4066-b341-2b80b7069f56
        config: {}
        dataType: DOUBLE
        description: ""
        name: city_id
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b24b3e95-ad02-4df0-9a06-7d97ba4764e7
                stepCounter: 6918440d-ac88-47a2-9eba-35ac23f9c906
            transform: "\"DAILY_WEATHER\".\"V\":\"city\".\"id\"::DOUBLE"
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: ef201fe7-4eaf-4231-bceb-078397cdd5a9
          stepCounter: c04f871d-6db8-4066-b341-2b80b7069f56
        config: {}
        dataType: STRING
        description: ""
        name: city_name
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b24b3e95-ad02-4df0-9a06-7d97ba4764e7
                stepCounter: 6918440d-ac88-47a2-9eba-35ac23f9c906
            transform: "\"DAILY_WEATHER\".\"V\":\"city\".\"name\"::STRING"
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 85d0c01e-3362-4c37-ba99-47e9419797c5
          stepCounter: c04f871d-6db8-4066-b341-2b80b7069f56
        config: {}
        dataType: DOUBLE
        description: ""
        name: data_clouds
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b24b3e95-ad02-4df0-9a06-7d97ba4764e7
                stepCounter: 6918440d-ac88-47a2-9eba-35ac23f9c906
            transform: "\"V_data\".value:\"clouds\"::DOUBLE"
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 23d24442-5683-438f-9ea4-2e22c1fb1b85
          stepCounter: c04f871d-6db8-4066-b341-2b80b7069f56
        config: {}
        dataType: DOUBLE
        description: ""
        name: data_deg
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b24b3e95-ad02-4df0-9a06-7d97ba4764e7
                stepCounter: 6918440d-ac88-47a2-9eba-35ac23f9c906
            transform: "\"V_data\".value:\"deg\"::DOUBLE"
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 5af5d5e7-f2e6-4590-98af-c0dc72b1c3ac
          stepCounter: c04f871d-6db8-4066-b341-2b80b7069f56
        config: {}
        dataType: DOUBLE
        description: ""
        name: data_dt
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b24b3e95-ad02-4df0-9a06-7d97ba4764e7
                stepCounter: 6918440d-ac88-47a2-9eba-35ac23f9c906
            transform: "\"V_data\".value:\"dt\"::DOUBLE"
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 215a71f6-9c6f-4e1f-8243-c3b0d5115256
          stepCounter: c04f871d-6db8-4066-b341-2b80b7069f56
        config: {}
        dataType: DOUBLE
        description: ""
        name: data_humidity
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b24b3e95-ad02-4df0-9a06-7d97ba4764e7
                stepCounter: 6918440d-ac88-47a2-9eba-35ac23f9c906
            transform: "\"V_data\".value:\"humidity\"::DOUBLE"
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: ebda5378-3d71-44f2-9981-3687874e6f18
          stepCounter: c04f871d-6db8-4066-b341-2b80b7069f56
        config: {}
        dataType: DOUBLE
        description: ""
        name: data_pressure
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b24b3e95-ad02-4df0-9a06-7d97ba4764e7
                stepCounter: 6918440d-ac88-47a2-9eba-35ac23f9c906
            transform: "\"V_data\".value:\"pressure\"::DOUBLE"
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 5fb6b420-52d3-4124-95a5-3a52cd68b3c2
          stepCounter: c04f871d-6db8-4066-b341-2b80b7069f56
        config: {}
        dataType: DOUBLE
        description: ""
        name: data_rain
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b24b3e95-ad02-4df0-9a06-7d97ba4764e7
                stepCounter: 6918440d-ac88-47a2-9eba-35ac23f9c906
            transform: "\"V_data\".value:\"rain\"::DOUBLE"
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 11feb18d-7729-4156-8495-3c741fe2f8ce
          stepCounter: c04f871d-6db8-4066-b341-2b80b7069f56
        config: {}
        dataType: DOUBLE
        description: ""
        name: data_speed
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b24b3e95-ad02-4df0-9a06-7d97ba4764e7
                stepCounter: 6918440d-ac88-47a2-9eba-35ac23f9c906
            transform: "\"V_data\".value:\"speed\"::DOUBLE"
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 22b69a5a-d0a2-4d22-97bc-3bd3b9d4f399
          stepCounter: c04f871d-6db8-4066-b341-2b80b7069f56
        config: {}
        dataType: DOUBLE
        description: ""
        name: data_temp_day
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b24b3e95-ad02-4df0-9a06-7d97ba4764e7
                stepCounter: 6918440d-ac88-47a2-9eba-35ac23f9c906
            transform: "\"V_data\".value:\"temp\".\"day\"::DOUBLE"
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 04bf75d0-c513-4254-881f-ba8b2f5c95cc
          stepCounter: c04f871d-6db8-4066-b341-2b80b7069f56
        config: {}
        dataType: DOUBLE
        description: ""
        name: data_temp_eve
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b24b3e95-ad02-4df0-9a06-7d97ba4764e7
                stepCounter: 6918440d-ac88-47a2-9eba-35ac23f9c906
            transform: "\"V_data\".value:\"temp\".\"eve\"::DOUBLE"
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 2c78f145-dfbb-42f1-9bd7-19dda17db7df
          stepCounter: c04f871d-6db8-4066-b341-2b80b7069f56
        config: {}
        dataType: DOUBLE
        description: ""
        name: data_temp_max
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b24b3e95-ad02-4df0-9a06-7d97ba4764e7
                stepCounter: 6918440d-ac88-47a2-9eba-35ac23f9c906
            transform: "\"V_data\".value:\"temp\".\"max\"::DOUBLE"
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 7af13828-8462-47f5-a95d-2d07f0a629bc
          stepCounter: c04f871d-6db8-4066-b341-2b80b7069f56
        config: {}
        dataType: DOUBLE
        description: ""
        name: data_temp_min
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b24b3e95-ad02-4df0-9a06-7d97ba4764e7
                stepCounter: 6918440d-ac88-47a2-9eba-35ac23f9c906
            transform: "\"V_data\".value:\"temp\".\"min\"::DOUBLE"
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: aa583f10-9ee4-4c50-a2dd-9c4f77da270b
          stepCounter: c04f871d-6db8-4066-b341-2b80b7069f56
        config: {}
        dataType: DOUBLE
        description: ""
        name: data_temp_morn
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b24b3e95-ad02-4df0-9a06-7d97ba4764e7
                stepCounter: 6918440d-ac88-47a2-9eba-35ac23f9c906
            transform: "\"V_data\".value:\"temp\".\"morn\"::DOUBLE"
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 96dd056c-8070-4c23-9360-39abd230a3e6
          stepCounter: c04f871d-6db8-4066-b341-2b80b7069f56
        config: {}
        dataType: DOUBLE
        description: ""
        name: data_temp_night
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b24b3e95-ad02-4df0-9a06-7d97ba4764e7
                stepCounter: 6918440d-ac88-47a2-9eba-35ac23f9c906
            transform: "\"V_data\".value:\"temp\".\"night\"::DOUBLE"
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 89f462c7-74a5-438b-a145-b65d8d3703f3
          stepCounter: c04f871d-6db8-4066-b341-2b80b7069f56
        config: {}
        dataType: DOUBLE
        description: ""
        name: data_uvi
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b24b3e95-ad02-4df0-9a06-7d97ba4764e7
                stepCounter: 6918440d-ac88-47a2-9eba-35ac23f9c906
            transform: "\"V_data\".value:\"uvi\"::DOUBLE"
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 3344e201-08b3-4d84-a3fc-3e49c1c295a7
          stepCounter: c04f871d-6db8-4066-b341-2b80b7069f56
        config: {}
        dataType: STRING
        description: ""
        name: data_weather_description
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b24b3e95-ad02-4df0-9a06-7d97ba4764e7
                stepCounter: 6918440d-ac88-47a2-9eba-35ac23f9c906
            transform: "\"V_data_weather\".value:\"description\"::STRING"
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: b04aaa5e-42b4-4ff2-8449-d21f77a4edfa
          stepCounter: c04f871d-6db8-4066-b341-2b80b7069f56
        config: {}
        dataType: STRING
        description: ""
        name: data_weather_icon
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b24b3e95-ad02-4df0-9a06-7d97ba4764e7
                stepCounter: 6918440d-ac88-47a2-9eba-35ac23f9c906
            transform: "\"V_data_weather\".value:\"icon\"::STRING"
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: e1587365-3295-4490-9487-42fadb24b9c9
          stepCounter: c04f871d-6db8-4066-b341-2b80b7069f56
        config: {}
        dataType: DOUBLE
        description: ""
        name: data_weather_id
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b24b3e95-ad02-4df0-9a06-7d97ba4764e7
                stepCounter: 6918440d-ac88-47a2-9eba-35ac23f9c906
            transform: "\"V_data_weather\".value:\"id\"::DOUBLE"
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: c45a9bca-466c-4aeb-8566-86f0b7e8389e
          stepCounter: c04f871d-6db8-4066-b341-2b80b7069f56
        config: {}
        dataType: STRING
        description: ""
        name: data_weather_main
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b24b3e95-ad02-4df0-9a06-7d97ba4764e7
                stepCounter: 6918440d-ac88-47a2-9eba-35ac23f9c906
            transform: "\"V_data_weather\".value:\"main\"::STRING"
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 4bc6570e-b050-4051-b9c9-61242f19b88f
          stepCounter: c04f871d-6db8-4066-b341-2b80b7069f56
        config: {}
        dataType: DOUBLE
        description: ""
        name: time
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b24b3e95-ad02-4df0-9a06-7d97ba4764e7
                stepCounter: 6918440d-ac88-47a2-9eba-35ac23f9c906
            transform: "\"DAILY_WEATHER\".\"V\":\"time\"::DOUBLE"
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: SOURCE_CUSTOM
            nodeName: DAILY_WEATHER
        join:
          joinCondition: |-
            FROM {{ ref('SOURCE_CUSTOM', 'DAILY_WEATHER') }} "DAILY_WEATHER", 
            lateral flatten(input => "V":"data", OUTER => TRUE) "V_data", 
            lateral flatten(input => "V_data".value:"weather", OUTER => TRUE) "V_data_weather"
        name: STG_DAILY_WEATHER
        noLinkRefs: []
  name: STG_DAILY_WEATHER
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
