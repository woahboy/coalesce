fileVersion: 1
id: e6415ec7-8bda-4aca-9b49-1569c69a79f9
name: STG_DAILY_WEATHER
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d8ea148f-cc4e-49c7-b2f3-a7eb9590683f
          stepCounter: e6415ec7-8bda-4aca-9b49-1569c69a79f9
        config: {}
        dataType: VARIANT
        description: ""
        name: V
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1e69a4ee-c523-4585-b492-db48add4684f
                stepCounter: 9bde49a5-9c74-4274-9e47-4ceadbaad27e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 69e22565-be2f-45c5-b2b6-22b6ffbb5cb5
          stepCounter: e6415ec7-8bda-4aca-9b49-1569c69a79f9
        config: {}
        dataType: TIMESTAMP_NTZ(9)
        description: ""
        name: T
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 85b22bb1-937b-401d-a14f-3bf738c5f70d
                stepCounter: 9bde49a5-9c74-4274-9e47-4ceadbaad27e
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: d3e71ab6-b3d7-47d1-b66c-710717d2ae74
          stepCounter: e6415ec7-8bda-4aca-9b49-1569c69a79f9
        config: {}
        dataType: DOUBLE
        description: ""
        name: city_coord_lat
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1e69a4ee-c523-4585-b492-db48add4684f
                stepCounter: 9bde49a5-9c74-4274-9e47-4ceadbaad27e
            transform: "\"DAILY_WEATHER\".\"V\":\"city\".\"coord\".\"lat\"::DOUBLE"
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: ce97c05c-4134-4c0c-b707-aff6242022cf
          stepCounter: e6415ec7-8bda-4aca-9b49-1569c69a79f9
        config: {}
        dataType: DOUBLE
        description: ""
        name: city_coord_lon
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1e69a4ee-c523-4585-b492-db48add4684f
                stepCounter: 9bde49a5-9c74-4274-9e47-4ceadbaad27e
            transform: "\"DAILY_WEATHER\".\"V\":\"city\".\"coord\".\"lon\"::DOUBLE"
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 69b7994a-eb1f-4553-b866-c1725c692156
          stepCounter: e6415ec7-8bda-4aca-9b49-1569c69a79f9
        config: {}
        dataType: STRING
        description: ""
        name: city_country
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1e69a4ee-c523-4585-b492-db48add4684f
                stepCounter: 9bde49a5-9c74-4274-9e47-4ceadbaad27e
            transform: "\"DAILY_WEATHER\".\"V\":\"city\".\"country\"::STRING"
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 8dd19d6b-a4c0-407d-93f7-fe362add3dc5
          stepCounter: e6415ec7-8bda-4aca-9b49-1569c69a79f9
        config: {}
        dataType: DOUBLE
        description: ""
        name: city_id
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1e69a4ee-c523-4585-b492-db48add4684f
                stepCounter: 9bde49a5-9c74-4274-9e47-4ceadbaad27e
            transform: "\"DAILY_WEATHER\".\"V\":\"city\".\"id\"::DOUBLE"
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: a7fc766b-7225-4edc-99ec-9873e3c1b839
          stepCounter: e6415ec7-8bda-4aca-9b49-1569c69a79f9
        config: {}
        dataType: STRING
        description: ""
        name: city_name
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1e69a4ee-c523-4585-b492-db48add4684f
                stepCounter: 9bde49a5-9c74-4274-9e47-4ceadbaad27e
            transform: "\"DAILY_WEATHER\".\"V\":\"city\".\"name\"::STRING"
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 9426abca-b723-4da6-88d8-4fdb5d7b926b
          stepCounter: e6415ec7-8bda-4aca-9b49-1569c69a79f9
        config: {}
        dataType: DOUBLE
        description: ""
        name: data_clouds
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1e69a4ee-c523-4585-b492-db48add4684f
                stepCounter: 9bde49a5-9c74-4274-9e47-4ceadbaad27e
            transform: "\"V_data\".value:\"clouds\"::DOUBLE"
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: ae6e97e2-0406-4b79-ab59-5b71b0be346a
          stepCounter: e6415ec7-8bda-4aca-9b49-1569c69a79f9
        config: {}
        dataType: DOUBLE
        description: ""
        name: data_deg
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1e69a4ee-c523-4585-b492-db48add4684f
                stepCounter: 9bde49a5-9c74-4274-9e47-4ceadbaad27e
            transform: "\"V_data\".value:\"deg\"::DOUBLE"
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: cb5ccd1f-676b-4613-bd02-0fa764678bde
          stepCounter: e6415ec7-8bda-4aca-9b49-1569c69a79f9
        config: {}
        dataType: DOUBLE
        description: ""
        name: data_dt
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1e69a4ee-c523-4585-b492-db48add4684f
                stepCounter: 9bde49a5-9c74-4274-9e47-4ceadbaad27e
            transform: "\"V_data\".value:\"dt\"::DOUBLE"
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 8d53e641-a37d-4117-96a5-c962867c0f4e
          stepCounter: e6415ec7-8bda-4aca-9b49-1569c69a79f9
        config: {}
        dataType: DOUBLE
        description: ""
        name: data_humidity
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1e69a4ee-c523-4585-b492-db48add4684f
                stepCounter: 9bde49a5-9c74-4274-9e47-4ceadbaad27e
            transform: "\"V_data\".value:\"humidity\"::DOUBLE"
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 1249a9ea-bf18-45af-ae36-ffd70f31071e
          stepCounter: e6415ec7-8bda-4aca-9b49-1569c69a79f9
        config: {}
        dataType: DOUBLE
        description: ""
        name: data_pressure
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1e69a4ee-c523-4585-b492-db48add4684f
                stepCounter: 9bde49a5-9c74-4274-9e47-4ceadbaad27e
            transform: "\"V_data\".value:\"pressure\"::DOUBLE"
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: d20391b4-c21a-437a-843d-feabafc783e0
          stepCounter: e6415ec7-8bda-4aca-9b49-1569c69a79f9
        config: {}
        dataType: DOUBLE
        description: ""
        name: data_rain
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1e69a4ee-c523-4585-b492-db48add4684f
                stepCounter: 9bde49a5-9c74-4274-9e47-4ceadbaad27e
            transform: "\"V_data\".value:\"rain\"::DOUBLE"
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 25484c8e-981e-451e-80d1-94bb79127e5e
          stepCounter: e6415ec7-8bda-4aca-9b49-1569c69a79f9
        config: {}
        dataType: DOUBLE
        description: ""
        name: data_speed
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1e69a4ee-c523-4585-b492-db48add4684f
                stepCounter: 9bde49a5-9c74-4274-9e47-4ceadbaad27e
            transform: "\"V_data\".value:\"speed\"::DOUBLE"
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: f9a76635-df14-4da3-a56c-f021c7526f41
          stepCounter: e6415ec7-8bda-4aca-9b49-1569c69a79f9
        config: {}
        dataType: DOUBLE
        description: ""
        name: data_temp_day
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1e69a4ee-c523-4585-b492-db48add4684f
                stepCounter: 9bde49a5-9c74-4274-9e47-4ceadbaad27e
            transform: "\"V_data\".value:\"temp\".\"day\"::DOUBLE"
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: d118dad7-bba8-488e-b5a3-371776ad9ad1
          stepCounter: e6415ec7-8bda-4aca-9b49-1569c69a79f9
        config: {}
        dataType: DOUBLE
        description: ""
        name: data_temp_eve
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1e69a4ee-c523-4585-b492-db48add4684f
                stepCounter: 9bde49a5-9c74-4274-9e47-4ceadbaad27e
            transform: "\"V_data\".value:\"temp\".\"eve\"::DOUBLE"
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 7dbb2fa2-f793-43a1-83fd-5b2d74976085
          stepCounter: e6415ec7-8bda-4aca-9b49-1569c69a79f9
        config: {}
        dataType: DOUBLE
        description: ""
        name: data_temp_max
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1e69a4ee-c523-4585-b492-db48add4684f
                stepCounter: 9bde49a5-9c74-4274-9e47-4ceadbaad27e
            transform: "\"V_data\".value:\"temp\".\"max\"::DOUBLE"
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 6295b399-08c2-44df-888d-39044929d647
          stepCounter: e6415ec7-8bda-4aca-9b49-1569c69a79f9
        config: {}
        dataType: DOUBLE
        description: ""
        name: data_temp_min
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1e69a4ee-c523-4585-b492-db48add4684f
                stepCounter: 9bde49a5-9c74-4274-9e47-4ceadbaad27e
            transform: "\"V_data\".value:\"temp\".\"min\"::DOUBLE"
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 1d209260-438f-4528-98cd-ce1e71293468
          stepCounter: e6415ec7-8bda-4aca-9b49-1569c69a79f9
        config: {}
        dataType: DOUBLE
        description: ""
        name: data_temp_morn
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1e69a4ee-c523-4585-b492-db48add4684f
                stepCounter: 9bde49a5-9c74-4274-9e47-4ceadbaad27e
            transform: "\"V_data\".value:\"temp\".\"morn\"::DOUBLE"
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 70b8e16c-eeea-492d-ab2e-42712ab7b2bc
          stepCounter: e6415ec7-8bda-4aca-9b49-1569c69a79f9
        config: {}
        dataType: DOUBLE
        description: ""
        name: data_temp_night
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1e69a4ee-c523-4585-b492-db48add4684f
                stepCounter: 9bde49a5-9c74-4274-9e47-4ceadbaad27e
            transform: "\"V_data\".value:\"temp\".\"night\"::DOUBLE"
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 4d90eb2a-8604-4058-8a92-735bd735693d
          stepCounter: e6415ec7-8bda-4aca-9b49-1569c69a79f9
        config: {}
        dataType: DOUBLE
        description: ""
        name: data_uvi
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1e69a4ee-c523-4585-b492-db48add4684f
                stepCounter: 9bde49a5-9c74-4274-9e47-4ceadbaad27e
            transform: "\"V_data\".value:\"uvi\"::DOUBLE"
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 01698d58-13e3-4a7a-a100-05eb74f9a99c
          stepCounter: e6415ec7-8bda-4aca-9b49-1569c69a79f9
        config: {}
        dataType: STRING
        description: ""
        name: data_weather_description
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1e69a4ee-c523-4585-b492-db48add4684f
                stepCounter: 9bde49a5-9c74-4274-9e47-4ceadbaad27e
            transform: "\"V_data_weather\".value:\"description\"::STRING"
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: e1e84492-0372-4e5a-8d7b-4e0132445604
          stepCounter: e6415ec7-8bda-4aca-9b49-1569c69a79f9
        config: {}
        dataType: STRING
        description: ""
        name: data_weather_icon
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1e69a4ee-c523-4585-b492-db48add4684f
                stepCounter: 9bde49a5-9c74-4274-9e47-4ceadbaad27e
            transform: "\"V_data_weather\".value:\"icon\"::STRING"
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: febec29a-8553-422d-83a6-c429a5f6a1fd
          stepCounter: e6415ec7-8bda-4aca-9b49-1569c69a79f9
        config: {}
        dataType: DOUBLE
        description: ""
        name: data_weather_id
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1e69a4ee-c523-4585-b492-db48add4684f
                stepCounter: 9bde49a5-9c74-4274-9e47-4ceadbaad27e
            transform: "\"V_data_weather\".value:\"id\"::DOUBLE"
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 4f4a6c2d-7915-4a8e-8b3d-1c0b2414a023
          stepCounter: e6415ec7-8bda-4aca-9b49-1569c69a79f9
        config: {}
        dataType: STRING
        description: ""
        name: data_weather_main
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1e69a4ee-c523-4585-b492-db48add4684f
                stepCounter: 9bde49a5-9c74-4274-9e47-4ceadbaad27e
            transform: "\"V_data_weather\".value:\"main\"::STRING"
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 2cbdd53d-e171-4efb-bc6f-365ff60aeaf2
          stepCounter: e6415ec7-8bda-4aca-9b49-1569c69a79f9
        config: {}
        dataType: DOUBLE
        description: ""
        name: time
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1e69a4ee-c523-4585-b492-db48add4684f
                stepCounter: 9bde49a5-9c74-4274-9e47-4ceadbaad27e
            transform: "\"DAILY_WEATHER\".\"V\":\"time\"::DOUBLE"
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: SOURCE_CUSTOM
            nodeName: DAILY_WEATHER
        join:
          joinCondition: |-
            FROM {{ ref('SOURCE_CUSTOM', 'DAILY_WEATHER') }} "DAILY_WEATHER", 
            lateral flatten(input => "V":"data", OUTER => TRUE) "V_data", 
            lateral flatten(input => "V_data".value:"weather", OUTER => TRUE) "V_data_weather"
        name: STG_DAILY_WEATHER
        noLinkRefs: []
  name: STG_DAILY_WEATHER
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
