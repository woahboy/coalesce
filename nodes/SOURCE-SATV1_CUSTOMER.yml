steps:
  SATV1_CUSTOMER-ed32da1f-3eee-4b45-8827-966b0330672a:
    operation:
      config:
        postSQL: ""
        preSQL: ""
      database: ""
      deployEnabled: true
      description: Customer data as defined by TPC-H
      isDataVault: false
      isMultisource: false
      locationName: SOURCE
      materializationType: view
      metadata:
        appliedNodeTests: []
        columns:
          - columnReference:
              columnCounter: 8f70cc52-9226-4d9f-9942-92b8376d1e2a
              stepCounter: ed32da1f-3eee-4b45-8827-966b0330672a
            config:
              is_hk: true
            dataType: STRING
            description: ""
            hashColumns: []
            hashDetails: null
            name: HUB_CUSTOMER_HK
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: f3b655ee-86d4-4e68-b1cf-27f00d931c9f
                    stepCounter: 411e4834-dfb2-4800-a520-7f417f479095
                transform: ""
          - columnReference:
              columnCounter: 05a4d84d-2cd6-49e1-9950-e49ce4f449c0
              stepCounter: ed32da1f-3eee-4b45-8827-966b0330672a
            dataType: STRING
            description: ""
            hashColumns: []
            hashDetails: null
            name: SAT_CUSTOMER1_HD
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2f34a020-1e52-4b69-a270-0a300debca35
                    stepCounter: 411e4834-dfb2-4800-a520-7f417f479095
                transform: ""
          - columnReference:
              columnCounter: f8c2bbe7-0341-4a26-b1be-e8eb0b08f0df
              stepCounter: ed32da1f-3eee-4b45-8827-966b0330672a
            dataType: VARCHAR(25)
            description: ""
            hashColumns: []
            hashDetails: null
            name: C_NAME
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 470e66e7-fa12-4479-b1d6-84cd170d3f0f
                    stepCounter: 411e4834-dfb2-4800-a520-7f417f479095
                transform: ""
          - columnReference:
              columnCounter: 2dda06d6-909d-4819-8809-095ab729e0ce
              stepCounter: ed32da1f-3eee-4b45-8827-966b0330672a
            dataType: VARCHAR(40)
            description: ""
            hashColumns: []
            hashDetails: null
            name: C_ADDRESS
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 737f43ec-77f5-4235-945b-86c9c51d21f2
                    stepCounter: 411e4834-dfb2-4800-a520-7f417f479095
                transform: ""
          - columnReference:
              columnCounter: a75c83ef-9007-44d7-bc5d-a82dbeab790b
              stepCounter: ed32da1f-3eee-4b45-8827-966b0330672a
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: C_NATIONKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: e6a2b99e-759d-4035-a4ba-a051b18124fc
                    stepCounter: 411e4834-dfb2-4800-a520-7f417f479095
                transform: ""
          - columnReference:
              columnCounter: 2671ecc9-64c0-4d0f-91fd-d5202e0ad891
              stepCounter: ed32da1f-3eee-4b45-8827-966b0330672a
            dataType: VARCHAR(15)
            description: ""
            hashColumns: []
            hashDetails: null
            name: C_PHONE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 9551ceab-4e65-43f1-8971-3f6016a76a2a
                    stepCounter: 411e4834-dfb2-4800-a520-7f417f479095
                transform: ""
          - columnReference:
              columnCounter: 67bcc6cc-f180-45b5-9484-7f42fb162f74
              stepCounter: ed32da1f-3eee-4b45-8827-966b0330672a
            dataType: TIMESTAMP
            description: The Load Date Timestamp (LDTS) describes when this data first arrived in the Data Warehouse.
            hashColumns: []
            hashDetails: null
            name: LDTS
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 081d4cbf-74c3-4ffa-9fb9-a937ebad988e
                    stepCounter: 411e4834-dfb2-4800-a520-7f417f479095
                transform: ""
          - columnReference:
              columnCounter: 4c6c6141-75af-41a4-93cc-515e61673071
              stepCounter: ed32da1f-3eee-4b45-8827-966b0330672a
            dataType: STRING
            description: The Record Source (RSRC) describes the source of this data.
            hashColumns: []
            hashDetails: null
            name: RSRC
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: f75bfe78-dcbc-4d7e-96a5-aeb248d3bd22
                    stepCounter: 411e4834-dfb2-4800-a520-7f417f479095
                transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 0850e90b-8c72-42a1-a058-4fcedaf5dee3
              stepCounter: ed32da1f-3eee-4b45-8827-966b0330672a
            config: {}
            dataType: TIMESTAMP
            defaultValue: ""
            description: ""
            hashColumns: []
            is_system_ledts: true
            name: LEDTS
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: |-
                  COALESCE(LEAD("{{ datavault4coalesce.config.ldts_alias }}" - INTERVAL '1 MICROSECOND') 
                  OVER (PARTITION BY "{{ get_value_by_column_attribute("is_hk") }}" 
                  ORDER BY "{{ datavault4coalesce.config.ldts_alias }}"), {{ datavault4coalesce__string_to_timestamp(datavault4coalesce.config.timestamp_format, datavault4coalesce.config.end_of_all_times) }})
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 193f8084-1c80-4f3e-9949-ab53f19ce59c
              stepCounter: ed32da1f-3eee-4b45-8827-966b0330672a
            config: {}
            dataType: BOOLEAN
            defaultValue: ""
            description: ""
            hashColumns: []
            is_system_current_col: true
            name: IS_CURRENT
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: |-
                  CASE 
                    WHEN 
                      LEAD("{{ datavault4coalesce.config.ldts_alias }}" - INTERVAL '1 MICROSECOND') 
                      OVER (PARTITION BY "{{ get_value_by_column_attribute("is_hk") }}" 
                      ORDER BY "{{ datavault4coalesce.config.ldts_alias }}") IS NULL 
                    THEN TRUE 
                    ELSE FALSE 
                  END
        cteString: ""
        enabledColumnTestIDs: []
        sourceMapping:
          - customSQL:
              customSQL: ""
            dependencies:
              - locationName: SOURCE
                nodeName: SATV0_CUSTOMER
            join:
              joinCondition: FROM {{ ref('SOURCE', 'SATV0_CUSTOMER') }} "SATV0_CUSTOMER"
            name: SATV1_CUSTOMER
            noLinkRefs: []
      name: SATV1_CUSTOMER
      overrideSQL: false
      schema: ""
      sqlType: SCALEFREE-DATAVAULT4COALESCE::9
      type: sql
    stepCounter: ed32da1f-3eee-4b45-8827-966b0330672a
