fileVersion: 1
id: 5d744d60-4a6c-4093-a49e-d18e9aea30f9
name: TEMP_EDW_D_POLICY_EPIC_US
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 77a75712-c935-4f62-8059-589d56c9826c
          stepCounter: 5d744d60-4a6c-4093-a49e-d18e9aea30f9
        config: {}
        dataType: BOOLEAN
        description: ""
        name: ETL_ACTIVE_IND
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a7c82c17-b632-45cb-9254-cd23df6e4d36
                stepCounter: b5ebe4ea-2a2b-4803-809f-ad3abd50eade
            transform: IFF("S_DIM_POLICY"."IS_DELETED", FALSE, TRUE)
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 47df6961-43b3-4b3e-809f-9b9dc8490359
          stepCounter: 5d744d60-4a6c-4093-a49e-d18e9aea30f9
        config: {}
        dataType: STRING
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: ENV_SOURCE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "'{{parameters.env_source_code_EPIC_US}}'"
        systemColumnType: None
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: d8416162-4e6b-469d-950d-66d252aae7ff
          stepCounter: 5d744d60-4a6c-4093-a49e-d18e9aea30f9
        config: {}
        dataType: STRING
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: DATA_SOURCE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "'Policy'"
        systemColumnType: None
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9ab9dd9b-08cd-46d9-8187-f0c749df4bf4
          stepCounter: 5d744d60-4a6c-4093-a49e-d18e9aea30f9
        config: {}
        dataType: VARCHAR(50)
        description: ""
        name: POLICY_ID
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fe2088cf-bcdb-4349-a58b-ad4a97a8c1fa
                stepCounter: b5ebe4ea-2a2b-4803-809f-ad3abd50eade
            transform: TRIM("S_DIM_POLICY"."AGENCY_SYSTEM_POLICY_ID")
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d230e66d-c35e-459b-9ab9-72d46c02e37b
          stepCounter: 5d744d60-4a6c-4093-a49e-d18e9aea30f9
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: POLICY_SOURCE_SID
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ee8a84d2-12b6-49bf-8a54-a82b38a3229a
                stepCounter: b5ebe4ea-2a2b-4803-809f-ad3abd50eade
            transform: TO_CHAR("S_DIM_POLICY"."POLICY_KEY")
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a42c5895-a6d1-41e4-b4ca-8b84f121291c
          stepCounter: 5d744d60-4a6c-4093-a49e-d18e9aea30f9
        config: {}
        dataType: VARCHAR(50)
        description: ""
        name: POLICY_NUM
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5a5763af-1a86-40d4-89d8-03b96c864216
                stepCounter: b5ebe4ea-2a2b-4803-809f-ad3abd50eade
            transform: TRIM("S_DIM_POLICY"."POLICY_NUMBER")
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: e392b09c-92ae-4bf4-8d1b-04a076792689
          stepCounter: 5d744d60-4a6c-4093-a49e-d18e9aea30f9
        config: {}
        dataType: STRING
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: PLAN_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "NULL"
        systemColumnType: None
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bf287367-c2fb-4ae4-b44b-2957949eb509
          stepCounter: 5d744d60-4a6c-4093-a49e-d18e9aea30f9
        config: {}
        dataType: TIMESTAMP_NTZ(9)
        description: ""
        name: EFFECTIVE_DATE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 19eefbc1-e8fc-4134-9d28-cdf484d46c45
                stepCounter: b5ebe4ea-2a2b-4803-809f-ad3abd50eade
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 729f9601-08b8-4cf6-9695-7e09465ac012
          stepCounter: 5d744d60-4a6c-4093-a49e-d18e9aea30f9
        config: {}
        dataType: TIMESTAMP_NTZ(9)
        description: ""
        name: EXPIRATION_DATE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b9ffc88d-ecd4-44f0-b29a-add07a8f6faf
                stepCounter: b5ebe4ea-2a2b-4803-809f-ad3abd50eade
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 39ede44d-40ba-4f67-888f-c78bd6860464
          stepCounter: 5d744d60-4a6c-4093-a49e-d18e9aea30f9
        config: {}
        dataType: TIMESTAMP_NTZ(9)
        description: ""
        name: INCEPTION_DATE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 775e8f9a-6d00-4cdd-bf1d-2aa22cfaaa17
                stepCounter: b5ebe4ea-2a2b-4803-809f-ad3abd50eade
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 082f1301-7638-4aa6-acac-ad3d9df4728a
          stepCounter: 5d744d60-4a6c-4093-a49e-d18e9aea30f9
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: BOUND_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "NULL"
        systemColumnType: None
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 55124ca2-3ec2-4544-ac4a-e7ca1fc43383
          stepCounter: 5d744d60-4a6c-4093-a49e-d18e9aea30f9
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: MAIL_OUT_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "NULL"
        systemColumnType: None
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 9937549b-686c-49c0-9b55-9ec59b76c631
          stepCounter: 5d744d60-4a6c-4093-a49e-d18e9aea30f9
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: CANCEL_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "NULL"
        systemColumnType: None
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 911c48ac-8a2f-4537-8be7-2a7743454ad9
          stepCounter: 5d744d60-4a6c-4093-a49e-d18e9aea30f9
        config: {}
        dataType: VARCHAR(255)
        description: ""
        name: CANCELLATION_REASON_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d15969a4-8614-4e02-82d8-b19616d5458b
                stepCounter: b5ebe4ea-2a2b-4803-809f-ad3abd50eade
            transform: LEFT(TRIM("S_DIM_POLICY"."CANCELLATION_REASON"), 10)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d9b32ed6-4edf-4c36-b503-2910d1bc773a
          stepCounter: 5d744d60-4a6c-4093-a49e-d18e9aea30f9
        config: {}
        dataType: DATE
        description: ""
        name: REINSTATED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "NULL"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0ce4e236-3e4b-4e4a-bbcd-c53b8e863a27
          stepCounter: 5d744d60-4a6c-4093-a49e-d18e9aea30f9
        config: {}
        dataType: VARCHAR(50)
        description: ""
        name: POLICY_STATUS_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a73d93a7-0fa1-4116-a084-f3929d16d271
                stepCounter: b5ebe4ea-2a2b-4803-809f-ad3abd50eade
            transform: TRIM("S_DIM_POLICY"."POLICY_STATUS")
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3793b748-f98d-4a74-9d54-9e8c51bec5e5
          stepCounter: 5d744d60-4a6c-4093-a49e-d18e9aea30f9
        config: {}
        dataType: VARCHAR(50)
        description: ""
        name: POLICY_STATUS_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a73d93a7-0fa1-4116-a084-f3929d16d271
                stepCounter: b5ebe4ea-2a2b-4803-809f-ad3abd50eade
            transform: TRIM("S_DIM_POLICY"."POLICY_STATUS")
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 732aa354-5b09-40f9-80f4-efc7014a1b4f
          stepCounter: 5d744d60-4a6c-4093-a49e-d18e9aea30f9
        config: {}
        dataType: VARCHAR(50)
        description: ""
        name: ENDORSEMENT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a73d93a7-0fa1-4116-a084-f3929d16d271
                stepCounter: b5ebe4ea-2a2b-4803-809f-ad3abd50eade
            transform: "NULL"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 45df4a35-fede-467f-a9e5-372229d468c4
          stepCounter: 5d744d60-4a6c-4093-a49e-d18e9aea30f9
        config: {}
        dataType: VARCHAR(50)
        description: ""
        name: SIC_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a73d93a7-0fa1-4116-a084-f3929d16d271
                stepCounter: b5ebe4ea-2a2b-4803-809f-ad3abd50eade
            transform: "NULL"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 96ee771b-72d8-40ed-b931-87f7534f8b2d
          stepCounter: 5d744d60-4a6c-4093-a49e-d18e9aea30f9
        config: {}
        dataType: VARCHAR(254)
        description: ""
        name: BILL_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 81b0e86e-c616-4a50-89d7-0212a466bad9
                stepCounter: b5ebe4ea-2a2b-4803-809f-ad3abd50eade
            transform: TRIM("S_DIM_POLICY"."BILL_TYPE")
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 839baf9a-b195-447f-bcee-906c4dc37740
          stepCounter: 5d744d60-4a6c-4093-a49e-d18e9aea30f9
        config: {}
        dataType: DATE
        description: ""
        name: INVOICE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "NULL"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 845580cf-3e72-434e-9e7f-1afc8a0f5bce
          stepCounter: 5d744d60-4a6c-4093-a49e-d18e9aea30f9
        config: {}
        dataType: TIMESTAMP_NTZ(9)
        description: ""
        name: CONTRACTED_EXPIRATION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 003f8672-900d-48ab-8323-08cf9267d3ec
                stepCounter: b5ebe4ea-2a2b-4803-809f-ad3abd50eade
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 53cc51b3-5e21-4b34-a649-1e723a6a45e1
          stepCounter: 5d744d60-4a6c-4093-a49e-d18e9aea30f9
        config: {}
        dataType: VARCHAR(255)
        description: ""
        name: CANCELLATION_REASON_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d15969a4-8614-4e02-82d8-b19616d5458b
                stepCounter: b5ebe4ea-2a2b-4803-809f-ad3abd50eade
            transform: TRIM("S_DIM_POLICY"."CANCELLATION_REASON")
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b012dc94-94a1-4552-92ea-22669e90f35b
          stepCounter: 5d744d60-4a6c-4093-a49e-d18e9aea30f9
        config: {}
        dataType: VARCHAR(100)
        description: ""
        name: CANCELLATION_REASON_OTHER_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a39cdf8b-0e5a-4f66-82e9-0a2d89704c43
                stepCounter: b5ebe4ea-2a2b-4803-809f-ad3abd50eade
            transform: TRIM("S_DIM_POLICY"."CANCELLATION_REASON_OTHER")
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9b73c23e-157d-4138-957c-40598f61b3e1
          stepCounter: 5d744d60-4a6c-4093-a49e-d18e9aea30f9
        config: {}
        dataType: NUMBER(19,4)
        description: ""
        name: ANNUALIZED_ENDORSEMENT_PREMIUM_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 456e8d31-bb61-4fa1-a234-c49e189b7fbb
                stepCounter: b5ebe4ea-2a2b-4803-809f-ad3abd50eade
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 22744191-04b0-422b-b1fc-725b8e74d877
          stepCounter: 5d744d60-4a6c-4093-a49e-d18e9aea30f9
        config: {}
        dataType: NUMBER(19,4)
        description: ""
        name: WRITTEN_PREMIUM_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a1035d11-0fff-4318-b034-c6003ee39699
                stepCounter: b5ebe4ea-2a2b-4803-809f-ad3abd50eade
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b6851ddc-97a0-47a2-95cf-ed379922754b
          stepCounter: 5d744d60-4a6c-4093-a49e-d18e9aea30f9
        config: {}
        dataType: NUMBER(19,4)
        description: ""
        name: ANNUALIZED_PREMIUM_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6984c2e6-651d-4121-9364-a0368e5ca540
                stepCounter: b5ebe4ea-2a2b-4803-809f-ad3abd50eade
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7d8474e3-ad4a-4de8-ad87-d8b270c8e25f
          stepCounter: 5d744d60-4a6c-4093-a49e-d18e9aea30f9
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: PRODUCER_SOURCE_SID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c5c070c9-c2c1-4c3d-a313-aa24d64a6d4b
                stepCounter: b5ebe4ea-2a2b-4803-809f-ad3abd50eade
            transform: IFNULL(TO_CHAR("S_DIM_POLICY"."PRODUCER1_EMPLOYEE_KEY"),'0')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2488a813-640b-4047-86ae-65bbbacb5956
          stepCounter: 5d744d60-4a6c-4093-a49e-d18e9aea30f9
        config: {}
        dataType: VARCHAR(100)
        description: ""
        name: PRODUCER_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2269228f-9bfc-4a97-9583-6ad09fc45736
                stepCounter: 1ec8abdb-0344-46af-b12c-9f43f75cd1eb
            transform: IFNULL("S_DIM_EMPLOYEE1"."EMPLOYEE_NAME",'UNKNOWN')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8844a772-c4a9-4b30-91d5-08eac8063428
          stepCounter: 5d744d60-4a6c-4093-a49e-d18e9aea30f9
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: ACCOUNT_MANAGER_SOURCE_SID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3ba54c63-bc70-4da8-ba37-0ee40443d3f5
                stepCounter: b5ebe4ea-2a2b-4803-809f-ad3abd50eade
            transform: IFNULL(TO_CHAR("S_DIM_POLICY"."CSR1_EMPLOYEE_KEY"),'0')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a9d96c07-b723-487b-947f-e0fe124b52b6
          stepCounter: 5d744d60-4a6c-4093-a49e-d18e9aea30f9
        config: {}
        dataType: VARCHAR(100)
        description: ""
        name: ACCOUNT_MANAGER_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2269228f-9bfc-4a97-9583-6ad09fc45736
                stepCounter: 1ec8abdb-0344-46af-b12c-9f43f75cd1eb
            transform: IFNULL("S_DIM_EMPLOYEE2"."EMPLOYEE_NAME",'UNKNOWN')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 794a4ec9-0b27-47d9-86dc-6970d2758f50
          stepCounter: 5d744d60-4a6c-4093-a49e-d18e9aea30f9
        config: {}
        dataType: BOOLEAN
        description: ""
        name: ACTIVE_IND
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d1336815-e43e-489a-92a9-43afd5bd83a7
                stepCounter: b5ebe4ea-2a2b-4803-809f-ad3abd50eade
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d3b41b01-5d1c-4730-af33-571c51792a80
          stepCounter: 5d744d60-4a6c-4093-a49e-d18e9aea30f9
        config: {}
        dataType: VARCHAR(8000)
        description: ""
        name: POLICY_LEVEL_SOURCE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ed726097-1ccb-4381-882f-e91416fcf9ab
                stepCounter: 5e6c23b9-cd50-44b6-994f-bdc8c8de9a72
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: c2ba7cea-d644-4b04-a155-78291a97f26b
          stepCounter: 5d744d60-4a6c-4093-a49e-d18e9aea30f9
        config: {}
        dataType: NUMBER
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: AJG_POLICY_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "NULL"
        systemColumnType: None
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 4f7e7138-b5c0-4b0a-b69b-0eb62f253b34
          stepCounter: 5d744d60-4a6c-4093-a49e-d18e9aea30f9
        config: {}
        dataType: BOOLEAN
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: RENEWAL_IND
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "NULL"
        systemColumnType: None
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c63536a7-a107-4878-a897-0127f0ae6168
          stepCounter: 5d744d60-4a6c-4093-a49e-d18e9aea30f9
        config: {}
        dataType: VARCHAR(50)
        description: ""
        name: ORIGINAL_POLICY_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1b566aca-7d75-4429-b01d-17c235f2a9b4
                stepCounter: b5ebe4ea-2a2b-4803-809f-ad3abd50eade
            transform: TRIM("S_DIM_POLICY"."AGENCY_SYSTEM_ORIGINAL_POLICY_ID")
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 110ede7d-9e31-457d-b964-c943163d24e8
          stepCounter: 5d744d60-4a6c-4093-a49e-d18e9aea30f9
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: ORIGINAL_EFFECTIVE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "NULL"
        systemColumnType: None
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: b4f54c16-3637-4a00-92f6-8c2b3b131fc9
          stepCounter: 5d744d60-4a6c-4093-a49e-d18e9aea30f9
        config: {}
        dataType: STRING
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: TAX_STATE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "NULL"
        systemColumnType: None
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: ae565fa5-00a3-43c0-8888-a608835c17b0
          stepCounter: 5d744d60-4a6c-4093-a49e-d18e9aea30f9
        config: {}
        dataType: STRING
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: OPERATIONS_OF_INSURANCE_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "NULL"
        systemColumnType: None
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d8235e21-4d15-449f-9723-90c8b41a12e5
          stepCounter: 5d744d60-4a6c-4093-a49e-d18e9aea30f9
        config: {}
        dataType: VARCHAR(250)
        description: ""
        name: PROGRAM_ELIGIBILITY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 49fed9f6-ef84-44f7-9278-08b63c4b5ac8
                stepCounter: 4b202939-f904-46a5-aefd-c55dd26328b6
            transform: IFNULL("S_POLICY_PROGRAM_INPUT"."PROGRAM_ELIGIBILITY_CODE", '1')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4b8bfaba-15d5-422f-a279-9426bec86d7e
          stepCounter: 5d744d60-4a6c-4093-a49e-d18e9aea30f9
        config: {}
        dataType: VARCHAR(250)
        description: ""
        name: PROGRAM_ELIGIBILITY_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3511a3a6-c93a-4d96-8f89-ed1d98d278e7
                stepCounter: 4b202939-f904-46a5-aefd-c55dd26328b6
            transform: IFNULL("S_POLICY_PROGRAM_INPUT"."PROGRAM_ELIGIBILITY_NAME", 'Eligible')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5ac5ddde-0a4c-4d56-8f10-2728eb34cc84
          stepCounter: 5d744d60-4a6c-4093-a49e-d18e9aea30f9
        config: {}
        dataType: VARCHAR(500)
        description: ""
        name: PROGRAM_DESC_01
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 44d6ba02-6850-4298-a4b9-f200d6437608
                stepCounter: 4b202939-f904-46a5-aefd-c55dd26328b6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ffd0e88d-df82-4741-a4e9-99c64285e944
          stepCounter: 5d744d60-4a6c-4093-a49e-d18e9aea30f9
        config: {}
        dataType: VARCHAR(500)
        description: ""
        name: PROGRAM_DESC_02
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0f8157b8-3020-4622-a001-8b6d7ed380a1
                stepCounter: 4b202939-f904-46a5-aefd-c55dd26328b6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 74c1c112-f20a-403e-8ace-b0b991daae6d
          stepCounter: 5d744d60-4a6c-4093-a49e-d18e9aea30f9
        config: {}
        dataType: STRING
        description: ""
        name: PRODUCER_CONTACT_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "NULL"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 84255254-71b3-4561-8f2c-f21289781446
          stepCounter: 5d744d60-4a6c-4093-a49e-d18e9aea30f9
        config: {}
        dataType: VARCHAR(50)
        description: ""
        name: POLICY_SOURCE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 18fed1ad-18e6-420a-980b-64aeb9217640
                stepCounter: b5ebe4ea-2a2b-4803-809f-ad3abd50eade
            transform: TRIM("S_DIM_POLICY"."POLICY_LEVEL_SOURCE_CODE")
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 275d22a8-29f0-4216-b859-84085bffdaf7
          stepCounter: 5d744d60-4a6c-4093-a49e-d18e9aea30f9
        config: {}
        dataType: STRING
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: POLICY_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "NULL"
        systemColumnType: None
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 803f9fad-5f79-4deb-bafc-49298c0ba79e
          stepCounter: 5d744d60-4a6c-4093-a49e-d18e9aea30f9
        config: {}
        dataType: STRING
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: POLICY_TYPE_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "NULL"
        systemColumnType: None
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 6fc5787c-0580-4fc2-ad59-234f8af5411f
          stepCounter: 5d744d60-4a6c-4093-a49e-d18e9aea30f9
        config: {}
        dataType: STRING
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: CARRIER_SOURCE_SID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "NULL"
        systemColumnType: None
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 2fee823b-b811-4e1d-9d8e-8231251a5993
          stepCounter: 5d744d60-4a6c-4093-a49e-d18e9aea30f9
        config: {}
        dataType: STRING
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: CARRIER_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "NULL"
        systemColumnType: None
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 0d03137f-97ae-494f-9ca3-69e6f536bbad
          stepCounter: 5d744d60-4a6c-4093-a49e-d18e9aea30f9
        config: {}
        dataType: STRING
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: EXCESS_PRIMARY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "NULL"
        systemColumnType: None
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 1b614fba-7e9a-47f5-affb-91f72c94217e
          stepCounter: 5d744d60-4a6c-4093-a49e-d18e9aea30f9
        config: {}
        dataType: STRING
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: SM_EXCLUSION_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "NULL"
        systemColumnType: None
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 05aa6687-61a9-4dfb-b79a-0dd1e7151534
          stepCounter: 5d744d60-4a6c-4093-a49e-d18e9aea30f9
        config: {}
        dataType: BOOLEAN
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: MULTI_YEAR_IND
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: CASE WHEN DATEDIFF(d, "S_DIM_POLICY"."EFFECTIVE_DATE", "S_DIM_POLICY"."EXPIRATION_DATE") > 400 THEN TRUE ELSE FALSE END
        systemColumnType: None
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: a3def0f5-8d00-4927-8783-4cd85a35085d
          stepCounter: 5d744d60-4a6c-4093-a49e-d18e9aea30f9
        config: {}
        dataType: BOOLEAN
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: MASTER_YEAR_IND
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "NULL"
        systemColumnType: None
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 2f640e08-b57a-4c7f-9de8-b3bfd6bfc8f6
          stepCounter: 5d744d60-4a6c-4093-a49e-d18e9aea30f9
        config: {}
        dataType: NUMBER
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: MASTER_POLICY_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "NULL"
        systemColumnType: None
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: d39a9c33-2aee-4245-aa49-d988f230263e
          stepCounter: 5d744d60-4a6c-4093-a49e-d18e9aea30f9
        config: {}
        dataType: BOOLEAN
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: CONTINUOUS_POLICY_IND
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "NULL"
        systemColumnType: None
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: db577f50-4afd-4e7c-abce-f085c4ebd79c
          stepCounter: 5d744d60-4a6c-4093-a49e-d18e9aea30f9
        config: {}
        dataType: NUMBER
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: COMMISSION_RATE_PCT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "NULL"
        systemColumnType: None
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 733dab26-8aea-4025-a467-cf667e24040c
          stepCounter: 5d744d60-4a6c-4093-a49e-d18e9aea30f9
        config: {}
        dataType: NUMBER
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: MEMBER_ENROLLMENT_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "NULL"
        systemColumnType: None
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: SOURCE_CUSTOM
            nodeName: S_DIM_EMPLOYEE
          - locationName: SOURCE_CUSTOM
            nodeName: S_DIM_POLICY
          - locationName: SOURCE_CUSTOM
            nodeName: S_POLICY_PROGRAM_INPUT
          - locationName: TARGET
            nodeName: TEMP_POLICY_PRODUCT_EPIC_US
        join:
          joinCondition: |-
            FROM {{ ref('SOURCE_CUSTOM', 'S_DIM_POLICY') }} "S_DIM_POLICY"
            LEFT OUTER JOIN {{ ref('SOURCE_CUSTOM', 'S_POLICY_PROGRAM_INPUT') }} "S_POLICY_PROGRAM_INPUT"
            ON TRIM("S_DIM_POLICY"."AGENCY_SYSTEM_ORIGINAL_POLICY_ID") = "S_POLICY_PROGRAM_INPUT"."POLICY_ID"
            LEFT OUTER JOIN {{ ref('SOURCE_CUSTOM', 'S_DIM_EMPLOYEE') }} "S_DIM_EMPLOYEE1"
            ON "S_DIM_POLICY"."PRODUCER1_EMPLOYEE_KEY" = "S_DIM_EMPLOYEE1"."EMPLOYEE_KEY"
            LEFT OUTER JOIN {{ ref('SOURCE_CUSTOM', 'S_DIM_EMPLOYEE') }} "S_DIM_EMPLOYEE2"
            ON "S_DIM_POLICY"."PRODUCER2_EMPLOYEE_KEY" = "S_DIM_EMPLOYEE2"."EMPLOYEE_KEY"
            INNER JOIN {{ ref('TARGET', 'TEMP_POLICY_PRODUCT_EPIC_US') }} "TEMP_POLICY_PRODUCT_EPIC_US"
            ON "S_DIM_POLICY"."POLICY_KEY" = "TEMP_POLICY_PRODUCT_EPIC_US"."POLICY_KEY"

            WHERE "S_DIM_POLICY"."OFFICE_AGENCY_SYSTEM_KEY" = {{parameters.FDW_oas_id_EPIC_US}}
            AND IFNULL(TRIM("S_DIM_POLICY"."AGENCY_SYSTEM_POLICY_ID"), '') <> ''
            QUALIFY ROW_NUMBER() OVER (
                PARTITION BY TRIM("S_DIM_POLICY"."AGENCY_SYSTEM_POLICY_ID"), "S_DIM_POLICY"."OFFICE_AGENCY_SYSTEM_KEY"
                ORDER BY "S_DIM_POLICY"."EXTRACT_KEY" DESC, "S_DIM_POLICY"."POLICY_KEY" DESC ) = 1
        name: TEMP_EDW_D_POLICY_EPIC_US
        noLinkRefs: []
  name: TEMP_EDW_D_POLICY_EPIC_US
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
