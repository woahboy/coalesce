fileVersion: 1
id: cce5d5fa-b631-4f8a-9bff-69bb9894c668
name: STG_DAILY_WEATHER
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: SOURCE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7c8f73e3-95f5-4d5e-9c35-6f91c42fd73d
          stepCounter: cce5d5fa-b631-4f8a-9bff-69bb9894c668
        config: {}
        dataType: VARIANT
        description: ""
        hashColumns: []
        hashDetails: null
        name: V
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d3062aa3-8a7d-46ce-bf1e-19bdfef98919
                stepCounter: bd8993e1-bb84-4f67-a78a-2357ed513789
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1be05ab1-0cb4-44ad-8baa-e242c4213553
          stepCounter: cce5d5fa-b631-4f8a-9bff-69bb9894c668
        config: {}
        dataType: TIMESTAMP_NTZ(9)
        description: ""
        hashColumns: []
        hashDetails: null
        name: T
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f3c11eef-c11b-46ec-ac90-a3c16ae017ab
                stepCounter: bd8993e1-bb84-4f67-a78a-2357ed513789
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 238062df-a505-4892-8e53-1f5a0e65893b
          stepCounter: cce5d5fa-b631-4f8a-9bff-69bb9894c668
        config: {}
        dataType: DOUBLE
        description: ""
        name: city_coord_lat
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d3062aa3-8a7d-46ce-bf1e-19bdfef98919
                stepCounter: bd8993e1-bb84-4f67-a78a-2357ed513789
            transform: "\"DAILY_WEATHER\".\"V\":\"city\".\"coord\".\"lat\"::DOUBLE"
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 437676b8-62d2-4793-b091-199881993378
          stepCounter: cce5d5fa-b631-4f8a-9bff-69bb9894c668
        config: {}
        dataType: DOUBLE
        description: ""
        name: city_coord_lon
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d3062aa3-8a7d-46ce-bf1e-19bdfef98919
                stepCounter: bd8993e1-bb84-4f67-a78a-2357ed513789
            transform: "\"DAILY_WEATHER\".\"V\":\"city\".\"coord\".\"lon\"::DOUBLE"
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 5fbaa66d-3a74-4d63-80b0-a0f613ec08f7
          stepCounter: cce5d5fa-b631-4f8a-9bff-69bb9894c668
        config: {}
        dataType: STRING
        description: ""
        name: city_country
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d3062aa3-8a7d-46ce-bf1e-19bdfef98919
                stepCounter: bd8993e1-bb84-4f67-a78a-2357ed513789
            transform: "\"DAILY_WEATHER\".\"V\":\"city\".\"country\"::STRING"
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: a8cfe0f5-cc53-491d-b07b-3add334c6031
          stepCounter: cce5d5fa-b631-4f8a-9bff-69bb9894c668
        config: {}
        dataType: DOUBLE
        description: ""
        name: city_id
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d3062aa3-8a7d-46ce-bf1e-19bdfef98919
                stepCounter: bd8993e1-bb84-4f67-a78a-2357ed513789
            transform: "\"DAILY_WEATHER\".\"V\":\"city\".\"id\"::DOUBLE"
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 49c6baf3-6ad4-4fba-97a1-593c302de08a
          stepCounter: cce5d5fa-b631-4f8a-9bff-69bb9894c668
        config: {}
        dataType: STRING
        description: ""
        name: city_name
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d3062aa3-8a7d-46ce-bf1e-19bdfef98919
                stepCounter: bd8993e1-bb84-4f67-a78a-2357ed513789
            transform: "\"DAILY_WEATHER\".\"V\":\"city\".\"name\"::STRING"
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: aa738a8e-bccf-4a56-be00-6665f9ad9f5f
          stepCounter: cce5d5fa-b631-4f8a-9bff-69bb9894c668
        config: {}
        dataType: DOUBLE
        description: ""
        name: data_clouds
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d3062aa3-8a7d-46ce-bf1e-19bdfef98919
                stepCounter: bd8993e1-bb84-4f67-a78a-2357ed513789
            transform: "\"V_data\".value:\"clouds\"::DOUBLE"
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 1bad6cc5-18b8-4d62-b1b4-afa6e67f70e4
          stepCounter: cce5d5fa-b631-4f8a-9bff-69bb9894c668
        config: {}
        dataType: DOUBLE
        description: ""
        name: data_deg
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d3062aa3-8a7d-46ce-bf1e-19bdfef98919
                stepCounter: bd8993e1-bb84-4f67-a78a-2357ed513789
            transform: "\"V_data\".value:\"deg\"::DOUBLE"
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 1d93a101-23ce-482c-80aa-c81c097f636c
          stepCounter: cce5d5fa-b631-4f8a-9bff-69bb9894c668
        config: {}
        dataType: DOUBLE
        description: ""
        name: data_dt
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d3062aa3-8a7d-46ce-bf1e-19bdfef98919
                stepCounter: bd8993e1-bb84-4f67-a78a-2357ed513789
            transform: "\"V_data\".value:\"dt\"::DOUBLE"
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 652f99dd-23f0-42d7-94cd-6a8b1f7ebe2a
          stepCounter: cce5d5fa-b631-4f8a-9bff-69bb9894c668
        config: {}
        dataType: DOUBLE
        description: ""
        name: data_humidity
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d3062aa3-8a7d-46ce-bf1e-19bdfef98919
                stepCounter: bd8993e1-bb84-4f67-a78a-2357ed513789
            transform: "\"V_data\".value:\"humidity\"::DOUBLE"
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 52dc56ec-6f42-4524-85df-ecd8bb796610
          stepCounter: cce5d5fa-b631-4f8a-9bff-69bb9894c668
        config: {}
        dataType: DOUBLE
        description: ""
        name: data_pressure
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d3062aa3-8a7d-46ce-bf1e-19bdfef98919
                stepCounter: bd8993e1-bb84-4f67-a78a-2357ed513789
            transform: "\"V_data\".value:\"pressure\"::DOUBLE"
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 75c2272e-c80c-4e88-a710-b43e862991f8
          stepCounter: cce5d5fa-b631-4f8a-9bff-69bb9894c668
        config: {}
        dataType: DOUBLE
        description: ""
        name: data_rain
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d3062aa3-8a7d-46ce-bf1e-19bdfef98919
                stepCounter: bd8993e1-bb84-4f67-a78a-2357ed513789
            transform: "\"V_data\".value:\"rain\"::DOUBLE"
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 6ee78a0b-ee74-4b61-8e83-bfab860c4d76
          stepCounter: cce5d5fa-b631-4f8a-9bff-69bb9894c668
        config: {}
        dataType: DOUBLE
        description: ""
        name: data_speed
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d3062aa3-8a7d-46ce-bf1e-19bdfef98919
                stepCounter: bd8993e1-bb84-4f67-a78a-2357ed513789
            transform: "\"V_data\".value:\"speed\"::DOUBLE"
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 3f547da4-bf5e-48e3-b513-91a789b55e88
          stepCounter: cce5d5fa-b631-4f8a-9bff-69bb9894c668
        config: {}
        dataType: DOUBLE
        description: ""
        name: data_temp_day
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d3062aa3-8a7d-46ce-bf1e-19bdfef98919
                stepCounter: bd8993e1-bb84-4f67-a78a-2357ed513789
            transform: "\"V_data\".value:\"temp\".\"day\"::DOUBLE"
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 0e0627b7-e3f7-4015-8169-336f1fbbe2b8
          stepCounter: cce5d5fa-b631-4f8a-9bff-69bb9894c668
        config: {}
        dataType: DOUBLE
        description: ""
        name: data_temp_eve
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d3062aa3-8a7d-46ce-bf1e-19bdfef98919
                stepCounter: bd8993e1-bb84-4f67-a78a-2357ed513789
            transform: "\"V_data\".value:\"temp\".\"eve\"::DOUBLE"
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 9e29f4d2-a9b9-4ff4-88c2-a6307a14c7cb
          stepCounter: cce5d5fa-b631-4f8a-9bff-69bb9894c668
        config: {}
        dataType: DOUBLE
        description: ""
        name: data_temp_max
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d3062aa3-8a7d-46ce-bf1e-19bdfef98919
                stepCounter: bd8993e1-bb84-4f67-a78a-2357ed513789
            transform: "\"V_data\".value:\"temp\".\"max\"::DOUBLE"
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: ab1e66db-722f-42a4-bfb0-e6533c53c6bd
          stepCounter: cce5d5fa-b631-4f8a-9bff-69bb9894c668
        config: {}
        dataType: DOUBLE
        description: ""
        name: data_temp_min
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d3062aa3-8a7d-46ce-bf1e-19bdfef98919
                stepCounter: bd8993e1-bb84-4f67-a78a-2357ed513789
            transform: "\"V_data\".value:\"temp\".\"min\"::DOUBLE"
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: bdf32c93-6e78-4a57-b5b7-d90af0e560d7
          stepCounter: cce5d5fa-b631-4f8a-9bff-69bb9894c668
        config: {}
        dataType: DOUBLE
        description: ""
        name: data_temp_morn
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d3062aa3-8a7d-46ce-bf1e-19bdfef98919
                stepCounter: bd8993e1-bb84-4f67-a78a-2357ed513789
            transform: "\"V_data\".value:\"temp\".\"morn\"::DOUBLE"
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: e9cc07fb-1410-4805-a897-cdb4d4281325
          stepCounter: cce5d5fa-b631-4f8a-9bff-69bb9894c668
        config: {}
        dataType: DOUBLE
        description: ""
        name: data_temp_night
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d3062aa3-8a7d-46ce-bf1e-19bdfef98919
                stepCounter: bd8993e1-bb84-4f67-a78a-2357ed513789
            transform: "\"V_data\".value:\"temp\".\"night\"::DOUBLE"
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: c884e227-3553-4d8a-9b2d-321db5d81d39
          stepCounter: cce5d5fa-b631-4f8a-9bff-69bb9894c668
        config: {}
        dataType: DOUBLE
        description: ""
        name: data_uvi
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d3062aa3-8a7d-46ce-bf1e-19bdfef98919
                stepCounter: bd8993e1-bb84-4f67-a78a-2357ed513789
            transform: "\"V_data\".value:\"uvi\"::DOUBLE"
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: fc2c1e05-07c0-4711-8295-36f32c60faa2
          stepCounter: cce5d5fa-b631-4f8a-9bff-69bb9894c668
        config: {}
        dataType: STRING
        description: ""
        name: data_weather_description
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d3062aa3-8a7d-46ce-bf1e-19bdfef98919
                stepCounter: bd8993e1-bb84-4f67-a78a-2357ed513789
            transform: "\"V_data_weather\".value:\"description\"::STRING"
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 6177dda0-4fef-486a-8d16-457835baf1b9
          stepCounter: cce5d5fa-b631-4f8a-9bff-69bb9894c668
        config: {}
        dataType: STRING
        description: ""
        name: data_weather_icon
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d3062aa3-8a7d-46ce-bf1e-19bdfef98919
                stepCounter: bd8993e1-bb84-4f67-a78a-2357ed513789
            transform: "\"V_data_weather\".value:\"icon\"::STRING"
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: c2b746a9-eff3-43a8-aa70-51b1b48302bc
          stepCounter: cce5d5fa-b631-4f8a-9bff-69bb9894c668
        config: {}
        dataType: DOUBLE
        description: ""
        name: data_weather_id
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d3062aa3-8a7d-46ce-bf1e-19bdfef98919
                stepCounter: bd8993e1-bb84-4f67-a78a-2357ed513789
            transform: "\"V_data_weather\".value:\"id\"::DOUBLE"
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: e051df03-f27d-4a6d-a616-6d4ee72f1818
          stepCounter: cce5d5fa-b631-4f8a-9bff-69bb9894c668
        config: {}
        dataType: STRING
        description: ""
        name: data_weather_main
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d3062aa3-8a7d-46ce-bf1e-19bdfef98919
                stepCounter: bd8993e1-bb84-4f67-a78a-2357ed513789
            transform: "\"V_data_weather\".value:\"main\"::STRING"
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 96fccf0d-d232-4f61-b164-30f326b32889
          stepCounter: cce5d5fa-b631-4f8a-9bff-69bb9894c668
        config: {}
        dataType: DOUBLE
        description: ""
        name: time
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d3062aa3-8a7d-46ce-bf1e-19bdfef98919
                stepCounter: bd8993e1-bb84-4f67-a78a-2357ed513789
            transform: "\"DAILY_WEATHER\".\"V\":\"time\"::DOUBLE"
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: SOURCE
            nodeName: DAILY_WEATHER
        join:
          joinCondition: |-
            FROM {{ ref('SOURCE', 'DAILY_WEATHER') }} "DAILY_WEATHER", 
            lateral flatten(input => "V":"data", OUTER => TRUE) "V_data", 
            lateral flatten(input => "V_data".value:"weather", OUTER => TRUE) "V_data_weather"
        name: STG_DAILY_WEATHER
        noLinkRefs: []
  name: STG_DAILY_WEATHER
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
type: Node
