fileVersion: 1
id: b4063cea-c986-488f-8e6f-33971eb897f6
name: STG_CUSTOMER
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: SOURCE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests:
          hasNull: true
          isDistinct: true
        columnReference:
          columnCounter: 356a7c75-f5b0-4842-94b0-dd5fdbb63d78
          stepCounter: b4063cea-c986-488f-8e6f-33971eb897f6
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: C_CUSTKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9c1a94ea-918c-4110-981b-b2864f4515e0
                stepCounter: 2fb63a0e-5f8d-4a2b-949c-635f8f87bf86
            transform: ""
      - appliedColumnTests:
          hasNull: false
          isDistinct: false
        columnReference:
          columnCounter: 6bc492ed-1784-41ab-abf0-b319addc8f45
          stepCounter: b4063cea-c986-488f-8e6f-33971eb897f6
        config: {}
        dataType: VARCHAR(25)
        description: ""
        name: C_NAME
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 40ca0c8a-0daf-47bb-9668-7d019430300b
                stepCounter: 1ad68952-96e1-45d7-9c75-9a9724afdca7
            transform: ""
      - appliedColumnTests:
          hasNull: false
          isDistinct: false
        columnReference:
          columnCounter: 5fd1b84e-e56d-4645-8009-de27ce0e6e1b
          stepCounter: b4063cea-c986-488f-8e6f-33971eb897f6
        config: {}
        dataType: VARCHAR(40)
        description: ""
        name: C_ADDRESS
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6879965f-1f40-455b-ad07-f7dc898f590c
                stepCounter: 1ad68952-96e1-45d7-9c75-9a9724afdca7
            transform: ""
      - appliedColumnTests:
          hasNull: false
          isDistinct: false
        columnReference:
          columnCounter: 9de3c203-4808-4183-be59-56b26ea8c9f2
          stepCounter: b4063cea-c986-488f-8e6f-33971eb897f6
        config: {}
        dataType: VARCHAR(15)
        description: ""
        name: C_PHONE_NUMBER
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8ba17f01-bd2f-49d7-a63a-1fc11f96e55a
                stepCounter: da03c99e-ac20-4572-8b35-f7a74b843000
            transform: ""
      - appliedColumnTests:
          hasNull: false
          isDistinct: false
        columnReference:
          columnCounter: c83ccedb-a8f7-4bc3-a6c2-be9424e6d284
          stepCounter: b4063cea-c986-488f-8e6f-33971eb897f6
        config: {}
        dataType: NUMBER(12,2)
        description: ""
        name: C_ACCTBAL
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f0858455-5baa-4f44-a842-243ae7edb6e3
                stepCounter: da03c99e-ac20-4572-8b35-f7a74b843000
            transform: ""
      - appliedColumnTests:
          hasNull: false
          isDistinct: false
        columnReference:
          columnCounter: 23777b33-6658-4a12-a480-4f3590996079
          stepCounter: b4063cea-c986-488f-8e6f-33971eb897f6
        config: {}
        dataType: VARCHAR(10)
        description: ""
        name: C_MKTSEGMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: af855871-9b24-42ad-a189-588f255342b3
                stepCounter: da03c99e-ac20-4572-8b35-f7a74b843000
            transform: ""
      - appliedColumnTests:
          hasNull: false
          isDistinct: false
        columnReference:
          columnCounter: d6e18299-136d-464f-8be2-675811f6e1cd
          stepCounter: b4063cea-c986-488f-8e6f-33971eb897f6
        config: {}
        dataType: VARCHAR(10)
        description: This customer value is defined by market segment and account balance
        name: C_VALUE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: af855871-9b24-42ad-a189-588f255342b3
                stepCounter: da03c99e-ac20-4572-8b35-f7a74b843000
            transform: CASE WHEN "SATV1_CUSTOMER_DETAIL"."C_ACCTBAL" > 5000 AND "SATV1_CUSTOMER_DETAIL"."C_MKTSEGMENT" IN ('BUILDING', 'HOUSEHOLD') THEN 'High' ELSE 'Low' END
      - appliedColumnTests:
          hasNull: false
          isDistinct: false
        columnReference:
          columnCounter: 58ceeaa3-24a1-4aa3-9731-370046d6ce51
          stepCounter: b4063cea-c986-488f-8e6f-33971eb897f6
        config: {}
        dataType: VARCHAR(117)
        description: ""
        name: C_COMMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fa337ac7-ea74-46c2-b1c9-652288a05a3b
                stepCounter: da03c99e-ac20-4572-8b35-f7a74b843000
            transform: ""
    cteString: ""
    enabledColumnTestIDs:
      - hasNull
      - isDistinct
    sourceMapping:
      - aliases:
          HUB_CUSTOMER: 2fb63a0e-5f8d-4a2b-949c-635f8f87bf86
          SATV1_CUSTOMER_ADDRESS: 1ad68952-96e1-45d7-9c75-9a9724afdca7
          SATV1_CUSTOMER_DETAIL: da03c99e-ac20-4572-8b35-f7a74b843000
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: SOURCE
            nodeName: HUB_CUSTOMER
          - locationName: SOURCE
            nodeName: SATV1_CUSTOMER_ADDRESS
          - locationName: SOURCE
            nodeName: SATV1_CUSTOMER_DETAIL
        join:
          joinCondition: |-
            FROM {{ ref('SOURCE', 'HUB_CUSTOMER') }} "HUB_CUSTOMER"
            INNER JOIN {{ ref('SOURCE', 'SATV1_CUSTOMER_ADDRESS') }} "SATV1_CUSTOMER_ADDRESS"
            ON "HUB_CUSTOMER"."HUB_CUSTOMER_HK" = "SATV1_CUSTOMER_ADDRESS"."HUB_CUSTOMER_HK"
            INNER JOIN {{ ref('SOURCE', 'SATV1_CUSTOMER_DETAIL') }} "SATV1_CUSTOMER_DETAIL"
            ON "HUB_CUSTOMER"."HUB_CUSTOMER_HK" = "SATV1_CUSTOMER_DETAIL"."HUB_CUSTOMER_HK"
        name: STG_CUSTOMER
        noLinkRefs: []
  name: STG_CUSTOMER
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
