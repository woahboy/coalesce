steps:
  STG_CUSTOMER-51cdd088-86ca-4b07-9b40-2dae65a1198c:
    operation:
      config:
        insertStrategy: INSERT
        postSQL: ""
        preSQL: ""
        testsEnabled: true
        truncateBefore: true
      database: ""
      deployEnabled: true
      description: ""
      isMultisource: false
      locationName: SOURCE
      materializationType: table
      metadata:
        appliedNodeTests: []
        columns:
          - columnReference:
              columnCounter: d6d753dd-539d-4071-a88a-25adc41229f9
              stepCounter: 51cdd088-86ca-4b07-9b40-2dae65a1198c
            dataType: NUMBER(38,0)
            description: ""
            name: C_CUSTKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: f7a1611c-1c93-40db-b80b-39851d9b0d2b
                    stepCounter: 38b7fa9d-b4ee-4931-a8bd-8bf456caaf2b
                transform: ""
          - columnReference:
              columnCounter: a727c848-3376-4025-9b71-94b041e65ddc
              stepCounter: 51cdd088-86ca-4b07-9b40-2dae65a1198c
            dataType: VARCHAR(25)
            description: ""
            name: C_NAME
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: a8db952e-c502-489f-88d2-a5a9ef8e0721
                    stepCounter: 3b781a25-8546-4518-91a1-e1b9596dbc20
                transform: ""
          - columnReference:
              columnCounter: 7edd3584-7a59-4114-b526-aeb657747d52
              stepCounter: 51cdd088-86ca-4b07-9b40-2dae65a1198c
            dataType: VARCHAR(40)
            description: ""
            name: C_ADDRESS
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: cb76c331-7ae7-4d1f-a8b1-433450330093
                    stepCounter: 3b781a25-8546-4518-91a1-e1b9596dbc20
                transform: ""
          - columnReference:
              columnCounter: ccaf8756-918c-43b1-baa9-008829a361ee
              stepCounter: 51cdd088-86ca-4b07-9b40-2dae65a1198c
            dataType: VARCHAR(15)
            description: ""
            name: C_PHONE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 4999de7c-3717-4b1e-a013-26e70e1ef36b
                    stepCounter: 3b781a25-8546-4518-91a1-e1b9596dbc20
                transform: ""
          - columnReference:
              columnCounter: d7dea814-1e1b-4932-8efc-428696061075
              stepCounter: 51cdd088-86ca-4b07-9b40-2dae65a1198c
            dataType: NUMBER(12,2)
            description: ""
            name: C_ACCTBAL
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 76bc75e7-3e6d-42b2-8755-1e3058b193eb
                    stepCounter: 12c73470-a1ae-40c3-8af5-a5166d4911b9
                transform: ""
          - columnReference:
              columnCounter: d4d935da-19c5-45c2-aa69-37d5b6724ae9
              stepCounter: 51cdd088-86ca-4b07-9b40-2dae65a1198c
            dataType: VARCHAR(10)
            description: ""
            name: C_MKTSEGMENT
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2ee2b65b-b043-4d55-ac42-169ef772c1ec
                    stepCounter: 12c73470-a1ae-40c3-8af5-a5166d4911b9
                transform: ""
          - columnReference:
              columnCounter: 638fae80-e22c-4f24-aa24-81ea8d09eef3
              stepCounter: 51cdd088-86ca-4b07-9b40-2dae65a1198c
            dataType: VARCHAR(10)
            description: ""
            name: C_VALUE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2ee2b65b-b043-4d55-ac42-169ef772c1ec
                    stepCounter: 12c73470-a1ae-40c3-8af5-a5166d4911b9
                transform: CASE WHEN "SATV1_CUSTOMER_DETAIL"."C_ACCTBAL" > 5000 AND "SATV1_CUSTOMER_DETAIL"."C_MKTSEGMENT" IN ('BUILDING', 'HOUSEHOLD') THEN 'High' ELSE 'Low' END
          - columnReference:
              columnCounter: 0680ab3c-8678-419c-9936-d611bb6e3d11
              stepCounter: 51cdd088-86ca-4b07-9b40-2dae65a1198c
            dataType: VARCHAR(117)
            description: ""
            name: C_COMMENT
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: c2d336e9-1d6d-41c4-919e-9e49e91b92bd
                    stepCounter: 12c73470-a1ae-40c3-8af5-a5166d4911b9
                transform: ""
        cteString: ""
        enabledColumnTestIDs: []
        sourceMapping:
          - aliases:
              HUB_CUSTOMER: 38b7fa9d-b4ee-4931-a8bd-8bf456caaf2b
              SATV1_CUSTOMER_ADDRESS: 3b781a25-8546-4518-91a1-e1b9596dbc20
              SATV1_CUSTOMER_DETAIL: 12c73470-a1ae-40c3-8af5-a5166d4911b9
            customSQL:
              customSQL: ""
            dependencies:
              - locationName: SOURCE
                nodeName: HUB_CUSTOMER
              - locationName: SOURCE
                nodeName: SATV1_CUSTOMER_ADDRESS
              - locationName: SOURCE
                nodeName: SATV1_CUSTOMER_DETAIL
            join:
              joinCondition: |-
                FROM {{ ref('SOURCE', 'HUB_CUSTOMER') }} "HUB_CUSTOMER"
                INNER JOIN {{ ref('SOURCE', 'SATV1_CUSTOMER_ADDRESS') }} "SATV1_CUSTOMER_ADDRESS"
                ON "HUB_CUSTOMER"."HUB_CUSTOMER_HK" = "SATV1_CUSTOMER_ADDRESS"."HUB_CUSTOMER_HK"
                INNER JOIN {{ ref('SOURCE', 'SATV1_CUSTOMER_DETAIL') }} "SATV1_CUSTOMER_DETAIL"
                ON "HUB_CUSTOMER"."HUB_CUSTOMER_HK" = "SATV1_CUSTOMER_DETAIL"."HUB_CUSTOMER_HK"
            name: STG_CUSTOMER
            noLinkRefs: []
      name: STG_CUSTOMER
      overrideSQL: false
      schema: ""
      sqlType: Stage
      type: sql
    stepCounter: 51cdd088-86ca-4b07-9b40-2dae65a1198c
