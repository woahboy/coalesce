fileVersion: 1
id: cf8e3b06-d7a3-4069-9088-e091684ec5ab
name: STG_TRUCK
operation:
  config:
    insertStrategy: UNION
    postSQL: null
    preSQL: null
    selectDistinct: false
    testsEnabled: false
    truncateBefore: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 59b6233e-dab9-4809-b01a-40124cfa0328
          stepCounter: cf8e3b06-d7a3-4069-9088-e091684ec5ab
        config: {}
        dataType: NUMBER(38,0)
        defaultValue: ""
        description: ""
        name: TRUCK_ID
        nullable: true
        primaryKey: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e122563c-a501-4b35-99fd-741f8070dbcb
                stepCounter: 8e0a289b-7f01-4a8c-8a8d-13c12d620b57
            transform: ""
        transform: ""
        uniqueKey: false
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: ea76cd3b-afcf-4282-bbd1-d13ed816f2df
          stepCounter: cf8e3b06-d7a3-4069-9088-e091684ec5ab
        config: {}
        dataType: NUMBER(38,0)
        defaultValue: ""
        description: ""
        name: MENU_TYPE_ID
        nullable: true
        primaryKey: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 27d17312-5dc3-4c36-aed6-a33ef674c94d
                stepCounter: 8e0a289b-7f01-4a8c-8a8d-13c12d620b57
            transform: ""
        transform: ""
        uniqueKey: false
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: f64cafc2-4cbe-41e7-9143-24ba85144d10
          stepCounter: cf8e3b06-d7a3-4069-9088-e091684ec5ab
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: PRIMARY_CITY
        nullable: true
        primaryKey: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5235176c-8ce0-4f1d-a382-065cd2a99e12
                stepCounter: 8e0a289b-7f01-4a8c-8a8d-13c12d620b57
            transform: ""
        transform: ""
        uniqueKey: false
      - acceptedValues:
          strictMatch: false
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: e469799e-e258-4b12-abf1-fd4e342a064e
          stepCounter: cf8e3b06-d7a3-4069-9088-e091684ec5ab
        config: {}
        dataType: VARCHAR(16777216)
        description: ""
        name: REGION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a5ba1639-d26a-46cd-9a9b-7aef6a2916ca
                stepCounter: 8e0a289b-7f01-4a8c-8a8d-13c12d620b57
            transform: ""
      - acceptedValues:
          strictMatch: false
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 38dde16e-3c9b-486e-a92b-4f61a8bd0a44
          stepCounter: cf8e3b06-d7a3-4069-9088-e091684ec5ab
        config: {}
        dataType: VARCHAR(16777216)
        description: ""
        name: ISO_REGION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d5ffd03b-3e34-4d4a-8f70-aedddbcdf4e8
                stepCounter: 8e0a289b-7f01-4a8c-8a8d-13c12d620b57
            transform: ""
      - acceptedValues:
          strictMatch: false
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: bc2a1ef4-d2a6-4b80-860d-72b8c2500836
          stepCounter: cf8e3b06-d7a3-4069-9088-e091684ec5ab
        config: {}
        dataType: VARCHAR(16777216)
        description: ""
        name: COUNTRY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8965da95-642e-4aa4-8b54-f60ae3bb3843
                stepCounter: 8e0a289b-7f01-4a8c-8a8d-13c12d620b57
            transform: ""
      - acceptedValues:
          strictMatch: false
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 2af53b38-b2b1-4bc3-a27c-9fc198bd3f91
          stepCounter: cf8e3b06-d7a3-4069-9088-e091684ec5ab
        config: {}
        dataType: VARCHAR(16777216)
        description: ""
        name: ISO_COUNTRY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ce082edb-5ad4-4898-aaf1-a422b5210257
                stepCounter: 8e0a289b-7f01-4a8c-8a8d-13c12d620b57
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 26293246-b275-473f-8b85-f6ec1e84645b
          stepCounter: cf8e3b06-d7a3-4069-9088-e091684ec5ab
        config: {}
        dataType: NUMBER(38,0)
        defaultValue: ""
        description: ""
        name: YEAR
        nullable: true
        primaryKey: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c180ee4e-aaf9-46b9-9985-4558fe956cd0
                stepCounter: 8e0a289b-7f01-4a8c-8a8d-13c12d620b57
            transform: ""
        transform: ""
        uniqueKey: false
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: d54bfa40-aaf7-40d3-a23c-f7863a73ea76
          stepCounter: cf8e3b06-d7a3-4069-9088-e091684ec5ab
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: MAKE
        nullable: true
        primaryKey: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5a8e005b-503f-4f22-8ddf-801d3a7f5e66
                stepCounter: 8e0a289b-7f01-4a8c-8a8d-13c12d620b57
            transform: UPPER("TRUCK"."MAKE")
        transform: ""
        uniqueKey: false
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: cda2ba00-64df-4d03-b7ed-8487b5ce3343
          stepCounter: cf8e3b06-d7a3-4069-9088-e091684ec5ab
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: MODEL
        nullable: true
        primaryKey: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eaa5aeb5-a54f-459e-bfbe-609aacb31d34
                stepCounter: 8e0a289b-7f01-4a8c-8a8d-13c12d620b57
            transform: UPPER("TRUCK"."MODEL")
        transform: ""
        uniqueKey: false
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: f394a87f-4f13-475a-a9ad-a39362c53aa7
          stepCounter: cf8e3b06-d7a3-4069-9088-e091684ec5ab
        config: {}
        dataType: NUMBER(38,0)
        defaultValue: ""
        description: ""
        name: EV_FLAG
        nullable: true
        primaryKey: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0f37ad70-024f-4d5e-87f7-2e3c35f777e9
                stepCounter: 8e0a289b-7f01-4a8c-8a8d-13c12d620b57
            transform: ""
        transform: ""
        uniqueKey: false
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 1558f7fc-df6e-4545-a2cb-5a9b5ccddc1c
          stepCounter: cf8e3b06-d7a3-4069-9088-e091684ec5ab
        config: {}
        dataType: NUMBER(38,0)
        defaultValue: ""
        description: ""
        name: FRANCHISE_ID
        nullable: true
        primaryKey: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3bd6c46f-6aef-48a2-a494-07530ab8b594
                stepCounter: 8e0a289b-7f01-4a8c-8a8d-13c12d620b57
            transform: ""
        transform: ""
        uniqueKey: false
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: ad7586a4-d66a-4bf0-955c-d278878fa79e
          stepCounter: cf8e3b06-d7a3-4069-9088-e091684ec5ab
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: TRUCK_OPENING_DATE
        nullable: true
        primaryKey: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 23f15cb5-8d06-4c7a-8b0f-2b1acb051bfd
                stepCounter: 8e0a289b-7f01-4a8c-8a8d-13c12d620b57
            transform: ""
        transform: ""
        uniqueKey: false
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          TRUCK: 8e0a289b-7f01-4a8c-8a8d-13c12d620b57
        customSQL:
          customSQL: |-
            {{ stage('Override Create SQL') }}
            CREATE OR REPLACE VIEW {{ ref('TARGET', 'V_TRUCK') }} AS (
              SELECT "TRUCK_ID",
              "MENU_TYPE_ID",
              "PRIMARY_CITY",
              "YEAR",
              UPPER("MAKE") AS "MAKE",
              UPPER("MODEL") AS "MODEL",
              "EV_FLAG",
              "FRANCHISE_ID",
              "TRUCK_OPENING_DATE"
            FROM "FROSTBYTE_TASTY_BYTES"."RAW_POS"."TRUCK" "TRUCK"
            WHERE "TRUCK_ID" IS NOT NULL AND "TRUCK_OPENING_DATE"::DATE < '2024-01-01'
            )
        dependencies:
          - locationName: SOURCE_TASTYBYTES
            nodeName: TRUCK
        join:
          joinCondition: |-
            FROM {{ ref('SOURCE_TASTYBYTES', 'TRUCK') }} "TRUCK"
            WHERE "TRUCK_ID" IS NOT NULL AND "TRUCK_OPENING_DATE"::DATE < '2024-01-01'
        name: STG_TRUCK
        noLinkRefs: []
  name: STG_TRUCK
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
