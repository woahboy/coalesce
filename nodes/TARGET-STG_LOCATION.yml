fileVersion: 1
id: c2258214-e7a2-493a-b21a-ab9f312f171c
name: STG_LOCATION
operation:
  config:
    insertStrategy: UNION
    postSQL: null
    preSQL: null
    selectDistinct: false
    testsEnabled: false
    truncateBefore: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2aa962cd-eb40-4fdb-a21d-34527bd324bf
          stepCounter: c2258214-e7a2-493a-b21a-ab9f312f171c
        config: {}
        dataType: NUMBER(19,0)
        description: ""
        name: LOCATION_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 32b6cb8d-9d20-42d3-93e0-e4f40531e412
                stepCounter: 11837f3c-bb92-4e47-94bb-bf7629ff71dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b664eace-5dba-4c87-b419-2308951604ac
          stepCounter: c2258214-e7a2-493a-b21a-ab9f312f171c
        config: {}
        dataType: VARCHAR(16777216)
        description: ""
        name: PLACEKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dbba0ee9-5774-4c2e-a5eb-69a9b35a2025
                stepCounter: 11837f3c-bb92-4e47-94bb-bf7629ff71dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: acc547ff-3550-4c4a-be67-0214811c7e99
          stepCounter: c2258214-e7a2-493a-b21a-ab9f312f171c
        config: {}
        dataType: VARCHAR(16777216)
        description: ""
        name: LOCATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 47f36f03-aebe-465c-927f-43c997e1e29b
                stepCounter: 11837f3c-bb92-4e47-94bb-bf7629ff71dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 01ed17bd-5e60-46e5-a8c6-cad306b57d44
          stepCounter: c2258214-e7a2-493a-b21a-ab9f312f171c
        config: {}
        dataType: VARCHAR(16777216)
        description: ""
        name: CITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 20a707ba-4949-4071-8fb8-ff12d0d257bc
                stepCounter: 11837f3c-bb92-4e47-94bb-bf7629ff71dd
            transform: UPPER("LOCATION"."CITY")
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aa26ea72-3914-42fb-8ca5-7fe8b599036a
          stepCounter: c2258214-e7a2-493a-b21a-ab9f312f171c
        config: {}
        dataType: VARCHAR(16777216)
        description: ""
        name: REGION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 16bc6f64-dd41-433e-8b6c-19ca471cf823
                stepCounter: 11837f3c-bb92-4e47-94bb-bf7629ff71dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9c865d29-cf8b-4a90-bbcd-960ca8e23735
          stepCounter: c2258214-e7a2-493a-b21a-ab9f312f171c
        config: {}
        dataType: VARCHAR(16777216)
        description: ""
        name: ISO_COUNTRY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 74725e63-49f4-4970-8a4f-d558583349d6
                stepCounter: 11837f3c-bb92-4e47-94bb-bf7629ff71dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5c8ecd1c-9880-4e3a-ae38-559dc99c111c
          stepCounter: c2258214-e7a2-493a-b21a-ab9f312f171c
        config: {}
        dataType: VARCHAR(16777216)
        description: ""
        name: COUNTRY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6507322b-cd1c-4b42-8292-98805e78c124
                stepCounter: 11837f3c-bb92-4e47-94bb-bf7629ff71dd
            transform: ""
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          LOCATION: 11837f3c-bb92-4e47-94bb-bf7629ff71dd
        customSQL:
          customSQL: |-
            {{ stage('Override Create SQL') }}
            CREATE OR REPLACE VIEW {{ ref('TARGET', 'V_LOCATION') }} AS (
              SELECT "LOCATION_ID",
              "PLACEKEY",
              "LOCATION",
              UPPER("CITY") AS "CITY",
              "REGION",
              "ISO_COUNTRY_CODE",
              "COUNTRY"
            FROM "FROSTBYTE_TASTY_BYTES"."RAW_POS"."LOCATION" "LOCATION"
            WHERE "LOCATION_ID" IS NOT NULL
            AND "LOCATION_ID" != 0
            )
        dependencies:
          - locationName: SOURCE_TASTYBYTES
            nodeName: LOCATION
        join:
          joinCondition: |-
            FROM {{ ref('SOURCE_TASTYBYTES', 'LOCATION') }} "LOCATION"
            WHERE "LOCATION_ID" is not null and "LOCATION_ID" != 0
        name: STG_LOCATION
        noLinkRefs: []
  name: STG_LOCATION
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
