steps:
  STG_CUSTOMER-6406fa7e-91c8-472d-8ed3-b7bee5dcef88:
    operation:
      config:
        insertStrategy: INSERT
        postSQL: ""
        preSQL: ""
        testsEnabled: true
        truncateBefore: true
      database: ""
      deployEnabled: true
      description: Customer data as defined by TPC-H
      isDataVault: false
      isMultisource: false
      locationName: TARGET
      materializationType: table
      metadata:
        appliedNodeTests:
          - continueOnFailure: true
            description: ""
            name: Test
            runOrder: After
            templateString: ""
        columns:
          - columnReference:
              columnCounter: 90935d5f-8003-436b-9e2d-c90dd7cf81c8
              stepCounter: 6406fa7e-91c8-472d-8ed3-b7bee5dcef88
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: CUSTOMER_CUSTKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 062a61c7-2081-4bfd-9b0a-35af1e5484b7
                    stepCounter: b24d2dd9-7356-4baf-9659-af2c8da94048
                transform: ""
          - columnReference:
              columnCounter: d76553e7-392e-4dd1-85a0-c19d10064844
              stepCounter: 6406fa7e-91c8-472d-8ed3-b7bee5dcef88
            dataType: STRING
            description: ""
            hashColumns: []
            hashDetails: null
            name: CUSTOMER_NAME
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: b057ee6e-506a-477e-84d9-abf877d953c2
                    stepCounter: b24d2dd9-7356-4baf-9659-af2c8da94048
                transform: ""
          - columnReference:
              columnCounter: 3f8bebd1-48ca-44ea-b7a9-7068c62d8772
              stepCounter: 6406fa7e-91c8-472d-8ed3-b7bee5dcef88
            dataType: INT
            description: ""
            hashColumns: []
            hashDetails: null
            name: CUSTOMER_NUMBER
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: b057ee6e-506a-477e-84d9-abf877d953c2
                    stepCounter: b24d2dd9-7356-4baf-9659-af2c8da94048
                transform: CAST(SPLIT_PART("CUSTOMER"."C_NAME", '#', 2) AS INT)
          - columnReference:
              columnCounter: 2222cb87-199d-43da-9632-4fc1587916d2
              stepCounter: 6406fa7e-91c8-472d-8ed3-b7bee5dcef88
            dataType: STRING
            description: ""
            hashColumns: []
            hashDetails: null
            name: C_ADDRESS
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 5a4c645c-9328-4828-b582-80db44e2f60c
                    stepCounter: b24d2dd9-7356-4baf-9659-af2c8da94048
                transform: ""
          - columnReference:
              columnCounter: 485bad80-1245-42dd-b476-61eeaebba90f
              stepCounter: 6406fa7e-91c8-472d-8ed3-b7bee5dcef88
            dataType: STRING
            description: ""
            hashColumns: []
            hashDetails: null
            name: C_PHONE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 28f1f43d-10e0-402a-83d3-81e8d7e2dbce
                    stepCounter: b24d2dd9-7356-4baf-9659-af2c8da94048
                transform: ""
          - columnReference:
              columnCounter: 423f079e-a999-4c1a-9381-dc8d33a872f2
              stepCounter: 6406fa7e-91c8-472d-8ed3-b7bee5dcef88
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: C_ACCTBAL
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 881a377e-ca89-4a15-a077-be9b0250e1fe
                    stepCounter: b24d2dd9-7356-4baf-9659-af2c8da94048
                transform: ""
          - columnReference:
              columnCounter: a8e52dc0-9011-4183-8043-2acb80e46ebd
              stepCounter: 6406fa7e-91c8-472d-8ed3-b7bee5dcef88
            dataType: STRING
            description: ""
            hashColumns: []
            hashDetails: null
            name: C_MKTSEGMENT
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 4a00c5c6-da27-47aa-9825-573847de0417
                    stepCounter: b24d2dd9-7356-4baf-9659-af2c8da94048
                transform: ""
          - columnReference:
              columnCounter: 535bec71-fe44-47f1-89a1-e2b3cd27cec2
              stepCounter: 6406fa7e-91c8-472d-8ed3-b7bee5dcef88
            dataType: STRING
            description: ""
            hashColumns: []
            hashDetails: null
            name: C_VALUE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 4a00c5c6-da27-47aa-9825-573847de0417
                    stepCounter: b24d2dd9-7356-4baf-9659-af2c8da94048
                transform: CASE WHEN "CUSTOMER"."C_ACCTBAL" > 5000 AND "CUSTOMER"."C_MKTSEGMENT" IN ('BUILDING', 'HOUSEHOLD') THEN 'HIGH' ELSE 'LOW' END
          - columnReference:
              columnCounter: c73263bb-22ed-438f-afca-fb08249b252d
              stepCounter: 6406fa7e-91c8-472d-8ed3-b7bee5dcef88
            dataType: STRING
            description: ""
            hashColumns: []
            hashDetails: null
            name: C_COMMENT
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 5c31eb10-618d-4281-9741-2237e91f3ebc
                    stepCounter: b24d2dd9-7356-4baf-9659-af2c8da94048
                transform: ""
          - columnReference:
              columnCounter: 82ff3065-fd9e-4aba-a8ca-4e8da96f440d
              stepCounter: 6406fa7e-91c8-472d-8ed3-b7bee5dcef88
            dataType: STRING
            description: ""
            name: N_NAME
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: e58ac929-abde-40fe-8089-cb50dbdef5c7
                    stepCounter: 3a7105f6-447e-4ade-b92d-4e93dba581b9
                transform: ""
          - columnReference:
              columnCounter: 45e1da01-f701-4edd-842e-4d15dff865a2
              stepCounter: 6406fa7e-91c8-472d-8ed3-b7bee5dcef88
            dataType: STRING
            description: ""
            name: N_COMMENT
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: cecc996a-113e-4ad2-b948-5b13013ede88
                    stepCounter: 3a7105f6-447e-4ade-b92d-4e93dba581b9
                transform: ""
        cteString: ""
        enabledColumnTestIDs: []
        sourceMapping:
          - aliases:
              CUSTOMER: b24d2dd9-7356-4baf-9659-af2c8da94048
              NATION: 3a7105f6-447e-4ade-b92d-4e93dba581b9
            customSQL:
              customSQL: ""
            dependencies:
              - locationName: SOURCE-1
                nodeName: CUSTOMER
              - locationName: SOURCE-1
                nodeName: NATION
            join:
              joinCondition: |-
                FROM {{ ref('SOURCE-1', 'CUSTOMER') }} "CUSTOMER"
                INNER JOIN {{ ref('SOURCE-1', 'NATION') }} "NATION"
                ON "CUSTOMER"."C_NATIONKEY" = "NATION"."N_NATIONKEY"
            name: STG_CUSTOMER
            noLinkRefs: []
      name: STG_CUSTOMER
      overrideSQL: false
      schema: ""
      sqlType: Stage
      type: sql
    stepCounter: 6406fa7e-91c8-472d-8ed3-b7bee5dcef88
