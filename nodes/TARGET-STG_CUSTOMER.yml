fileVersion: 1
id: d2caafe0-d5a2-46e5-a3f7-6fa883ae0e19
name: STG_CUSTOMER
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: Customer data as defined by TPC-H
  isMultisource: false
  locationName: TARGET
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f9714396-c79d-440f-abc6-faafbfdc6aa1
          stepCounter: d2caafe0-d5a2-46e5-a3f7-6fa883ae0e19
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: C_CUSTKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 462e6b3f-c21e-4bdf-8821-633c9a037883
                stepCounter: 197f4f11-f2f5-4df1-a5b7-b72fa742dc13
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 600fe719-4e26-448e-8c42-4d276e7d5439
          stepCounter: d2caafe0-d5a2-46e5-a3f7-6fa883ae0e19
        config: {}
        dataType: VARCHAR(25)
        description: ""
        name: C_NAME
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2964661c-06f7-4a6b-b5c2-c3154b9e77bf
                stepCounter: 197f4f11-f2f5-4df1-a5b7-b72fa742dc13
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6e58e4c6-1aed-43be-9384-0a18ac5b3503
          stepCounter: d2caafe0-d5a2-46e5-a3f7-6fa883ae0e19
        config: {}
        dataType: VARCHAR(40)
        description: ""
        name: C_ADDRESS
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5f20fc77-db5b-447b-9ff8-23995ec07198
                stepCounter: 197f4f11-f2f5-4df1-a5b7-b72fa742dc13
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ebe0e22b-2533-44be-8554-5b30b8583fbc
          stepCounter: d2caafe0-d5a2-46e5-a3f7-6fa883ae0e19
        config: {}
        dataType: VARCHAR(15)
        description: ""
        name: CUSTOMER_PHONE_NUMBER
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7e04bb8b-46ea-44f9-8631-c878175e5f6f
                stepCounter: 197f4f11-f2f5-4df1-a5b7-b72fa742dc13
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fc4744f7-6fa4-490c-81c7-7f0831f40369
          stepCounter: d2caafe0-d5a2-46e5-a3f7-6fa883ae0e19
        config: {}
        dataType: NUMBER(12,2)
        description: ""
        name: C_ACCTBAL
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 76891c4d-53d3-41d8-84a9-3f90c99d4799
                stepCounter: 197f4f11-f2f5-4df1-a5b7-b72fa742dc13
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e330276a-db6a-4081-b1fe-c37a9bffbd33
          stepCounter: d2caafe0-d5a2-46e5-a3f7-6fa883ae0e19
        config: {}
        dataType: VARCHAR(10)
        description: ""
        name: C_MKTSEGMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 60658813-4135-4647-82ce-ba3b95d46375
                stepCounter: 197f4f11-f2f5-4df1-a5b7-b72fa742dc13
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fa7c8162-8c6d-4230-a32f-495fc30fc82d
          stepCounter: d2caafe0-d5a2-46e5-a3f7-6fa883ae0e19
        config: {}
        dataType: VARCHAR(10)
        description: ""
        name: C_VALUE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 60658813-4135-4647-82ce-ba3b95d46375
                stepCounter: 197f4f11-f2f5-4df1-a5b7-b72fa742dc13
            transform: CASE WHEN "CUSTOMER"."C_ACCTBAL" > 5000 AND "CUSTOMER"."C_MKTSEGMENT" IN ('BUILDING', 'HOUSEHOLD') THEN 'High' ELSE 'Low' END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 45238f39-e9a1-4497-92b2-b2a3e4e62cd2
          stepCounter: d2caafe0-d5a2-46e5-a3f7-6fa883ae0e19
        config: {}
        dataType: VARCHAR(117)
        description: ""
        name: C_COMMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f824df78-ea6a-4ade-8672-a75ee6ba65a1
                stepCounter: 197f4f11-f2f5-4df1-a5b7-b72fa742dc13
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ece1cf92-d716-4ebd-963d-60e1f996f8e5
          stepCounter: d2caafe0-d5a2-46e5-a3f7-6fa883ae0e19
        config: {}
        dataType: VARCHAR(25)
        description: ""
        name: N_NAME
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7d6d1713-0e84-4e59-b21b-1d586105099f
                stepCounter: 53bd91f6-d023-46dc-b83e-944a5388ce77
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 28956782-c8f2-4b78-be71-ca0af72bfecf
          stepCounter: d2caafe0-d5a2-46e5-a3f7-6fa883ae0e19
        config: {}
        dataType: VARCHAR(152)
        description: ""
        name: N_COMMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6dde95c6-5edb-4830-844d-91f0b1630d70
                stepCounter: 53bd91f6-d023-46dc-b83e-944a5388ce77
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 78e24b9a-9237-4a39-8540-4c488593d25e
          stepCounter: d2caafe0-d5a2-46e5-a3f7-6fa883ae0e19
        config: {}
        dataType: VARCHAR(25)
        description: ""
        name: R_NAME
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5d470184-96ce-4393-9beb-a1b9c30330a1
                stepCounter: 864a39b8-ce4f-4be0-b64b-d0c19cb9aae6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0171a91f-37c8-45c5-84df-ff3ad79d63e6
          stepCounter: d2caafe0-d5a2-46e5-a3f7-6fa883ae0e19
        config: {}
        dataType: VARCHAR(152)
        description: ""
        name: R_COMMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ff0d0180-5683-4f2f-8721-51977f4705cb
                stepCounter: 864a39b8-ce4f-4be0-b64b-d0c19cb9aae6
            transform: ""
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          CUSTOMER: 197f4f11-f2f5-4df1-a5b7-b72fa742dc13
          NATION: 53bd91f6-d023-46dc-b83e-944a5388ce77
          REGION: 864a39b8-ce4f-4be0-b64b-d0c19cb9aae6
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: SOURCE_TPCH
            nodeName: CUSTOMER
          - locationName: SOURCE_TPCH
            nodeName: NATION
          - locationName: SOURCE_TPCH
            nodeName: REGION
        join:
          joinCondition: |-
            FROM {{ ref('SOURCE_TPCH', 'CUSTOMER') }} "CUSTOMER"
            INNER JOIN {{ ref('SOURCE_TPCH', 'NATION') }} "NATION"
            ON "CUSTOMER"."C_NATIONKEY" = "NATION"."N_NATIONKEY"
            INNER JOIN {{ ref('SOURCE_TPCH', 'REGION') }} "REGION"
            ON "NATION"."N_REGIONKEY" = "REGION"."R_REGIONKEY"
        name: STG_CUSTOMER
        noLinkRefs: []
  name: STG_CUSTOMER
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
