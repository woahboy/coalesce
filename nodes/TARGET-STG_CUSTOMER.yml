fileVersion: 1
id: aa31daf1-aa59-47d4-9f16-a499ad681852
name: STG_CUSTOMER
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: Staging node for customer data, joined with nation and region data
  isMultisource: false
  locationName: TARGET
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 94966c5a-3b90-4ea1-9d48-318a3436400c
          stepCounter: aa31daf1-aa59-47d4-9f16-a499ad681852
        config: {}
        dataType: NUMBER
        description: ""
        name: C_CUSTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 94966c5a-3b90-4ea1-9d48-318a3436400c
                stepCounter: aa31daf1-aa59-47d4-9f16-a499ad681852
            transform: CUSTOMER.C_CUSTKEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ee5a68e0-879c-4cd2-894f-828a323ab1ba
          stepCounter: aa31daf1-aa59-47d4-9f16-a499ad681852
        config: {}
        dataType: VARCHAR
        description: ""
        name: C_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ee5a68e0-879c-4cd2-894f-828a323ab1ba
                stepCounter: aa31daf1-aa59-47d4-9f16-a499ad681852
            transform: CUSTOMER.C_NAME
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7fdb1faa-56e7-4f95-89c7-2d56c0761b97
          stepCounter: aa31daf1-aa59-47d4-9f16-a499ad681852
        config: {}
        dataType: VARCHAR
        description: ""
        name: C_ADDRESS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7fdb1faa-56e7-4f95-89c7-2d56c0761b97
                stepCounter: aa31daf1-aa59-47d4-9f16-a499ad681852
            transform: CUSTOMER.C_ADDRESS
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c77ff1a3-1356-4ca3-b286-bfd620ccac40
          stepCounter: aa31daf1-aa59-47d4-9f16-a499ad681852
        config: {}
        dataType: VARCHAR
        description: ""
        name: C_PHONE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c77ff1a3-1356-4ca3-b286-bfd620ccac40
                stepCounter: aa31daf1-aa59-47d4-9f16-a499ad681852
            transform: CUSTOMER.C_PHONE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c3eb370b-44a5-4d3f-8142-5e56e93572a9
          stepCounter: aa31daf1-aa59-47d4-9f16-a499ad681852
        config: {}
        dataType: NUMBER
        description: ""
        name: C_ACCTBAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c3eb370b-44a5-4d3f-8142-5e56e93572a9
                stepCounter: aa31daf1-aa59-47d4-9f16-a499ad681852
            transform: CUSTOMER.C_ACCTBAL
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0c8150d1-e267-4aaa-89f6-84d256904a6b
          stepCounter: aa31daf1-aa59-47d4-9f16-a499ad681852
        config: {}
        dataType: VARCHAR
        description: ""
        name: C_MKTSEGMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0c8150d1-e267-4aaa-89f6-84d256904a6b
                stepCounter: aa31daf1-aa59-47d4-9f16-a499ad681852
            transform: CUSTOMER.C_MKTSEGMENT
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 40693841-e003-4db8-aa7b-323d5a592bcf
          stepCounter: aa31daf1-aa59-47d4-9f16-a499ad681852
        config: {}
        dataType: VARCHAR
        description: ""
        name: C_VALUE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 40693841-e003-4db8-aa7b-323d5a592bcf
                stepCounter: aa31daf1-aa59-47d4-9f16-a499ad681852
            transform: CASE WHEN CUSTOMER.C_ACCTBAL > 5000 AND CUSTOMER.C_MKTSEGMENT IN ('BUILDING', 'HOUSEHOLD') THEN 'High' ELSE 'Low' END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 77ac08bb-2706-44bf-b323-41deeee87da8
          stepCounter: aa31daf1-aa59-47d4-9f16-a499ad681852
        config: {}
        dataType: VARCHAR
        description: ""
        name: C_COMMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 77ac08bb-2706-44bf-b323-41deeee87da8
                stepCounter: aa31daf1-aa59-47d4-9f16-a499ad681852
            transform: CUSTOMER.C_COMMENT
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5c72e578-9dcf-4ced-94cf-8e4b2bf21a13
          stepCounter: aa31daf1-aa59-47d4-9f16-a499ad681852
        config: {}
        dataType: VARCHAR
        description: ""
        name: N_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5c72e578-9dcf-4ced-94cf-8e4b2bf21a13
                stepCounter: aa31daf1-aa59-47d4-9f16-a499ad681852
            transform: NATION.N_NAME
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 97c83339-117e-458b-b7db-587548a1f8ca
          stepCounter: aa31daf1-aa59-47d4-9f16-a499ad681852
        config: {}
        dataType: VARCHAR
        description: ""
        name: N_COMMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 97c83339-117e-458b-b7db-587548a1f8ca
                stepCounter: aa31daf1-aa59-47d4-9f16-a499ad681852
            transform: NATION.N_COMMENT
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 43ecc2c3-555a-4906-9966-5404b1d7a224
          stepCounter: aa31daf1-aa59-47d4-9f16-a499ad681852
        config: {}
        dataType: VARCHAR
        description: ""
        name: R_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 43ecc2c3-555a-4906-9966-5404b1d7a224
                stepCounter: aa31daf1-aa59-47d4-9f16-a499ad681852
            transform: REGION.R_NAME
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dc553e0e-689a-4e2b-a945-87e15855cda3
          stepCounter: aa31daf1-aa59-47d4-9f16-a499ad681852
        config: {}
        dataType: VARCHAR
        description: ""
        name: R_COMMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dc553e0e-689a-4e2b-a945-87e15855cda3
                stepCounter: aa31daf1-aa59-47d4-9f16-a499ad681852
            transform: REGION.R_COMMENT
    cteString: ""
    description: ""
    destinationName: ""
    enabledColumnTestIDs: []
    materializationOption: ""
    sourceMapping:
      - aliases:
          CUSTOMER: 473200e1-c8ff-4f6b-8421-2aae1f54c3cd
          NATION: ecad5700-7f15-484a-8ee3-bf6122c1298e
          REGION: e62d8a25-65f1-4590-a0cd-25d28caa728f
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: SOURCE_TPCH
            nodeName: CUSTOMER
          - locationName: SOURCE_TPCH
            nodeName: NATION
          - locationName: SOURCE_TPCH
            nodeName: REGION
        join:
          joinCondition: FROM {{ ref('SOURCE_TPCH', 'CUSTOMER') }} CUSTOMER INNER JOIN {{ ref('SOURCE_TPCH', 'NATION') }} NATION ON CUSTOMER.C_NATIONKEY = NATION.N_NATIONKEY INNER JOIN {{ ref('SOURCE_TPCH', 'REGION') }} REGION ON NATION.N_REGIONKEY = REGION.R_REGIONKEY
        name: STG_CUSTOMER
        noLinkRefs: []
  name: STG_CUSTOMER
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
