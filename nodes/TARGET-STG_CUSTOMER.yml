fileVersion: 1
id: aaa4ca4e-2d59-40f1-ae84-51053fb80576
name: STG_CUSTOMER
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: Customer data as defined by TPC-H
  isMultisource: false
  locationName: TARGET
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3afde222-0f3d-435a-a6d6-c4bc823a82a0
          stepCounter: aaa4ca4e-2d59-40f1-ae84-51053fb80576
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: C_CUSTKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3868f781-a62a-4ae5-980d-62adb355d2aa
                stepCounter: 2131f72e-f017-4946-8bdd-816053eae0d7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ddc49427-96ad-4e16-8278-f0ba7b454a0a
          stepCounter: aaa4ca4e-2d59-40f1-ae84-51053fb80576
        config: {}
        dataType: VARCHAR(25)
        description: ""
        name: C_NAME
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 414006c2-c58f-4d24-abe4-d33b9a013fad
                stepCounter: 2131f72e-f017-4946-8bdd-816053eae0d7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 90cd4f41-3712-4de3-975d-a4ccc5bb8bc4
          stepCounter: aaa4ca4e-2d59-40f1-ae84-51053fb80576
        config: {}
        dataType: VARCHAR(40)
        description: ""
        name: C_ADDRESS
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 23fc6586-1f9f-4468-a6dd-5152d55db448
                stepCounter: 2131f72e-f017-4946-8bdd-816053eae0d7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6f120560-e7e3-42eb-9c0d-afacb8331c55
          stepCounter: aaa4ca4e-2d59-40f1-ae84-51053fb80576
        config: {}
        dataType: VARCHAR(15)
        description: ""
        name: CUSTOMER_PHONE_NUMBER
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9ad588cc-c330-4b2a-a36b-81d37cca5eee
                stepCounter: 2131f72e-f017-4946-8bdd-816053eae0d7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9d1acb2d-9688-4480-9e7c-72ab31856a28
          stepCounter: aaa4ca4e-2d59-40f1-ae84-51053fb80576
        config: {}
        dataType: NUMBER(12,2)
        description: ""
        name: C_ACCTBAL
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 36cd8e03-ad18-4ab6-a7fa-8680fbb65182
                stepCounter: 2131f72e-f017-4946-8bdd-816053eae0d7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ed4d0487-a686-4f66-9ce2-50bf0d7395bc
          stepCounter: aaa4ca4e-2d59-40f1-ae84-51053fb80576
        config: {}
        dataType: VARCHAR(10)
        description: ""
        name: C_MKTSEGMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c3675724-e64e-4985-a8dd-2d996bd6f363
                stepCounter: 2131f72e-f017-4946-8bdd-816053eae0d7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ed4ac720-7ac7-4e91-8fea-4ff247daf690
          stepCounter: aaa4ca4e-2d59-40f1-ae84-51053fb80576
        config: {}
        dataType: VARCHAR(10)
        description: ""
        name: C_VALUE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c3675724-e64e-4985-a8dd-2d996bd6f363
                stepCounter: 2131f72e-f017-4946-8bdd-816053eae0d7
            transform: CASE WHEN "CUSTOMER"."C_ACCTBAL" > 5000 AND "CUSTOMER"."C_MKTSEGMENT" IN ('BUILDING', 'HOUSEHOLD') THEN 'High' ELSE 'Low' END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 864bf51c-8068-46e4-b3b2-b40ecd91aeef
          stepCounter: aaa4ca4e-2d59-40f1-ae84-51053fb80576
        config: {}
        dataType: VARCHAR(117)
        description: ""
        name: C_COMMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f4f11e4d-4b51-478c-a36b-c2b21b4b9a06
                stepCounter: 2131f72e-f017-4946-8bdd-816053eae0d7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2457b979-9e74-4675-99d3-fe4c834854d0
          stepCounter: aaa4ca4e-2d59-40f1-ae84-51053fb80576
        config: {}
        dataType: VARCHAR(25)
        description: ""
        name: N_NAME
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c01b57e0-4f8f-4a76-a71a-adfaf124edcb
                stepCounter: ee629b54-391a-4ac6-8f03-4d5ef4375d14
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 03501e8e-63f6-46e7-8b2f-8fcc8f7bd487
          stepCounter: aaa4ca4e-2d59-40f1-ae84-51053fb80576
        config: {}
        dataType: VARCHAR(152)
        description: ""
        name: N_COMMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5794430f-5110-41f3-8b13-af98277ac0c2
                stepCounter: ee629b54-391a-4ac6-8f03-4d5ef4375d14
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1eb31155-733c-4852-8296-03a57654820c
          stepCounter: aaa4ca4e-2d59-40f1-ae84-51053fb80576
        config: {}
        dataType: VARCHAR(25)
        description: ""
        name: R_NAME
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 46e442de-61a3-4cfe-835d-f8d09527e8cc
                stepCounter: 3a876d0f-e648-4d69-a63c-51a77372b4f7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9564e975-0922-4ae8-ac94-5c80afb0eca7
          stepCounter: aaa4ca4e-2d59-40f1-ae84-51053fb80576
        config: {}
        dataType: VARCHAR(152)
        description: ""
        name: R_COMMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f63ba239-26d0-4d4c-8afa-7886b822326d
                stepCounter: 3a876d0f-e648-4d69-a63c-51a77372b4f7
            transform: ""
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          CUSTOMER: 2131f72e-f017-4946-8bdd-816053eae0d7
          NATION: ee629b54-391a-4ac6-8f03-4d5ef4375d14
          REGION: 3a876d0f-e648-4d69-a63c-51a77372b4f7
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: SOURCE_TPCH
            nodeName: CUSTOMER
          - locationName: SOURCE_TPCH
            nodeName: NATION
          - locationName: SOURCE_TPCH
            nodeName: REGION
        join:
          joinCondition: |-
            FROM {{ ref('SOURCE_TPCH', 'CUSTOMER') }} "CUSTOMER"
            INNER JOIN {{ ref('SOURCE_TPCH', 'NATION') }} "NATION"
            ON "CUSTOMER"."C_NATIONKEY" = "NATION"."N_NATIONKEY"
            INNER JOIN {{ ref('SOURCE_TPCH', 'REGION') }} "REGION"
            ON "NATION"."N_REGIONKEY" = "REGION"."R_REGIONKEY"
        name: STG_CUSTOMER
        noLinkRefs: []
  name: STG_CUSTOMER
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
