fileVersion: 1
id: 4c2c278f-2f92-4f25-8323-9e1d72a23f48
name: STG_CUSTOMER
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: Preparation stage for Customer Dimension
  isMultisource: false
  locationName: TARGET
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 462d506c-7e0a-4909-8af8-073f0ea8fcc6
          stepCounter: 4c2c278f-2f92-4f25-8323-9e1d72a23f48
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: C_CUSTKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c9d60fab-9288-4fc8-b4ab-384802b8d13e
                stepCounter: bf0365c2-d528-4774-80e8-3952e36d5254
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bf8b794a-82ff-494a-a205-f94d3dd58e52
          stepCounter: 4c2c278f-2f92-4f25-8323-9e1d72a23f48
        config: {}
        dataType: VARCHAR(25)
        description: ""
        name: C_NAME
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c2922ecc-5546-45c1-80c0-da6c704ddab5
                stepCounter: bf0365c2-d528-4774-80e8-3952e36d5254
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bec87816-71f9-41bf-a256-31e9f6a9085d
          stepCounter: 4c2c278f-2f92-4f25-8323-9e1d72a23f48
        config: {}
        dataType: VARCHAR(40)
        description: ""
        name: C_ADDRESS
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b4899c40-7be8-40fd-9807-2abfccadd325
                stepCounter: bf0365c2-d528-4774-80e8-3952e36d5254
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6708d2fe-08b9-4a92-86c7-63e250af68ef
          stepCounter: 4c2c278f-2f92-4f25-8323-9e1d72a23f48
        config: {}
        dataType: VARCHAR(15)
        description: ""
        name: CUSTOMER_PHONE_NUMBER
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9623cabe-0092-4adc-99cf-86590bf22ada
                stepCounter: bf0365c2-d528-4774-80e8-3952e36d5254
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 240328fa-c2e5-4e29-bc67-ce90fa99a793
          stepCounter: 4c2c278f-2f92-4f25-8323-9e1d72a23f48
        config: {}
        dataType: NUMBER(12,2)
        description: ""
        name: C_ACCTBAL
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e4c5abd7-3a20-408c-929a-4df7036d74fd
                stepCounter: bf0365c2-d528-4774-80e8-3952e36d5254
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 093acc07-238d-4be1-bce7-396af668a27a
          stepCounter: 4c2c278f-2f92-4f25-8323-9e1d72a23f48
        config: {}
        dataType: VARCHAR(10)
        description: ""
        name: C_MKTSEGMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9572bb15-5d43-47db-a20b-db2da6b979b6
                stepCounter: bf0365c2-d528-4774-80e8-3952e36d5254
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 63585483-d1ef-46b3-9fdf-7cd97443c0d3
          stepCounter: 4c2c278f-2f92-4f25-8323-9e1d72a23f48
        config: {}
        dataType: VARCHAR(10)
        description: ""
        name: C_VALUE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9572bb15-5d43-47db-a20b-db2da6b979b6
                stepCounter: bf0365c2-d528-4774-80e8-3952e36d5254
            transform: CASE WHEN "CUSTOMER"."C_ACCTBAL" > 5000 AND "CUSTOMER"."C_MKTSEGMENT" IN ('BUILDING', 'HOUSEHOLD') THEN 'High' ELSE 'Low' END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 972aee60-b4fe-4fd2-adea-3956d503065a
          stepCounter: 4c2c278f-2f92-4f25-8323-9e1d72a23f48
        config: {}
        dataType: VARCHAR(117)
        description: ""
        name: C_COMMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0a144d32-f390-4db3-a60f-5022ef3a3550
                stepCounter: bf0365c2-d528-4774-80e8-3952e36d5254
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3de1604a-dd5b-4ea5-8257-526ab35864eb
          stepCounter: 4c2c278f-2f92-4f25-8323-9e1d72a23f48
        config: {}
        dataType: VARCHAR(25)
        description: ""
        name: N_NAME
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f341b039-bf8c-4c4a-a486-5f7de7a9ad81
                stepCounter: b7aee6f1-92f2-4e63-aac5-48f498ad83f0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 879abad5-e388-4348-a8a4-36e46bd94c83
          stepCounter: 4c2c278f-2f92-4f25-8323-9e1d72a23f48
        config: {}
        dataType: VARCHAR(152)
        description: ""
        name: N_COMMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8b19bde7-2a26-469a-bdc2-1261317e3426
                stepCounter: b7aee6f1-92f2-4e63-aac5-48f498ad83f0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f86df8d2-1277-4a00-91cd-6d2958b64239
          stepCounter: 4c2c278f-2f92-4f25-8323-9e1d72a23f48
        config: {}
        dataType: VARCHAR(25)
        description: ""
        name: R_NAME
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5fd1e023-09e0-46ed-83e6-1a55d841d72d
                stepCounter: bef889ab-bb71-43af-8500-69fe118b0ae0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d8fe494c-ea3b-4486-ac17-ab84263d69c8
          stepCounter: 4c2c278f-2f92-4f25-8323-9e1d72a23f48
        config: {}
        dataType: VARCHAR(152)
        description: ""
        name: R_COMMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 25f2233d-5038-47d2-ab87-10ea44328074
                stepCounter: bef889ab-bb71-43af-8500-69fe118b0ae0
            transform: ""
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          CUSTOMER: bf0365c2-d528-4774-80e8-3952e36d5254
          NATION: b7aee6f1-92f2-4e63-aac5-48f498ad83f0
          REGION: bef889ab-bb71-43af-8500-69fe118b0ae0
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: SOURCE_TPCH
            nodeName: CUSTOMER
          - locationName: SOURCE_TPCH
            nodeName: NATION
          - locationName: SOURCE_TPCH
            nodeName: REGION
        join:
          joinCondition: |-
            FROM {{ ref('SOURCE_TPCH', 'CUSTOMER') }} "CUSTOMER"
            INNER JOIN {{ ref('SOURCE_TPCH', 'NATION') }} "NATION"
            ON "CUSTOMER"."C_NATIONKEY" = "NATION"."N_NATIONKEY"
            INNER JOIN {{ ref('SOURCE_TPCH', 'REGION') }} "REGION"
            ON "NATION"."N_REGIONKEY" = "REGION"."R_REGIONKEY"
        name: STG_CUSTOMER
        noLinkRefs: []
  name: STG_CUSTOMER
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
