fileVersion: 1
id: 1cd9e20d-a3ed-4190-865c-7601e7592954
name: STG_CUSTOMER
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: Staging node for customer data, joined with nation and region data
  isMultisource: false
  locationName: TARGET
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5d47138c-6458-44e2-9968-508344f990c9
          stepCounter: 1cd9e20d-a3ed-4190-865c-7601e7592954
        config: {}
        dataType: NUMBER
        description: ""
        name: C_CUSTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5d47138c-6458-44e2-9968-508344f990c9
                stepCounter: 1cd9e20d-a3ed-4190-865c-7601e7592954
            transform: CUSTOMER.C_CUSTKEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9d8512e9-1a87-46c6-a264-4db3e4e4f9a8
          stepCounter: 1cd9e20d-a3ed-4190-865c-7601e7592954
        config: {}
        dataType: VARCHAR
        description: ""
        name: C_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9d8512e9-1a87-46c6-a264-4db3e4e4f9a8
                stepCounter: 1cd9e20d-a3ed-4190-865c-7601e7592954
            transform: CUSTOMER.C_NAME
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8d43155d-423f-4aed-84fc-70113d815317
          stepCounter: 1cd9e20d-a3ed-4190-865c-7601e7592954
        config: {}
        dataType: VARCHAR
        description: ""
        name: C_ADDRESS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8d43155d-423f-4aed-84fc-70113d815317
                stepCounter: 1cd9e20d-a3ed-4190-865c-7601e7592954
            transform: CUSTOMER.C_ADDRESS
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 84965c7f-a82a-4e50-a186-e853991b4bca
          stepCounter: 1cd9e20d-a3ed-4190-865c-7601e7592954
        config: {}
        dataType: VARCHAR
        description: ""
        name: C_PHONE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 84965c7f-a82a-4e50-a186-e853991b4bca
                stepCounter: 1cd9e20d-a3ed-4190-865c-7601e7592954
            transform: CUSTOMER.C_PHONE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 05564655-5117-4366-8b08-5b1e20f79152
          stepCounter: 1cd9e20d-a3ed-4190-865c-7601e7592954
        config: {}
        dataType: NUMBER
        description: ""
        name: C_ACCTBAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 05564655-5117-4366-8b08-5b1e20f79152
                stepCounter: 1cd9e20d-a3ed-4190-865c-7601e7592954
            transform: CUSTOMER.C_ACCTBAL
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f0da0e17-43fa-4e18-a41b-3a8d78efb31d
          stepCounter: 1cd9e20d-a3ed-4190-865c-7601e7592954
        config: {}
        dataType: VARCHAR
        description: ""
        name: C_MKTSEGMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f0da0e17-43fa-4e18-a41b-3a8d78efb31d
                stepCounter: 1cd9e20d-a3ed-4190-865c-7601e7592954
            transform: CUSTOMER.C_MKTSEGMENT
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 119c477c-5e0a-478c-8315-a2c44b577bac
          stepCounter: 1cd9e20d-a3ed-4190-865c-7601e7592954
        config: {}
        dataType: VARCHAR
        description: |-
          - Derived from a CASE statement based on 'CUSTOMER.C_ACCTBAL' and 'CUSTOMER.C_MKTSEGMENT' from the 'STG_CUSTOMER' table.
          - Categorizes customers into 'High' or 'Low' value based on their account balance and market segment.
          - Specifically, if 'C_ACCTBAL' exceeds 5000 and 'C_MKTSEGMENT' is either 'BUILDING' or 'HOUSEHOLD', the customer is classified as 'High' value; otherwise, 'Low'.
          - Supports targeted marketing and service strategies by identifying high-value customers.
        name: C_VALUE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 119c477c-5e0a-478c-8315-a2c44b577bac
                stepCounter: 1cd9e20d-a3ed-4190-865c-7601e7592954
            transform: CASE WHEN CUSTOMER.C_ACCTBAL > 5000 AND CUSTOMER.C_MKTSEGMENT IN ('BUILDING', 'HOUSEHOLD') THEN 'High' ELSE 'Low' END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 329d53f8-b01c-4284-bde5-b31240b72166
          stepCounter: 1cd9e20d-a3ed-4190-865c-7601e7592954
        config: {}
        dataType: VARCHAR
        description: ""
        name: C_COMMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 329d53f8-b01c-4284-bde5-b31240b72166
                stepCounter: 1cd9e20d-a3ed-4190-865c-7601e7592954
            transform: CUSTOMER.C_COMMENT
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ad4dd5fe-d3d2-4bb0-ab8d-6e1fef7921e0
          stepCounter: 1cd9e20d-a3ed-4190-865c-7601e7592954
        config: {}
        dataType: VARCHAR
        description: ""
        name: N_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ad4dd5fe-d3d2-4bb0-ab8d-6e1fef7921e0
                stepCounter: 1cd9e20d-a3ed-4190-865c-7601e7592954
            transform: NATION.N_NAME
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e19936a8-118f-4100-986f-d74b73726442
          stepCounter: 1cd9e20d-a3ed-4190-865c-7601e7592954
        config: {}
        dataType: VARCHAR
        description: ""
        name: N_COMMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e19936a8-118f-4100-986f-d74b73726442
                stepCounter: 1cd9e20d-a3ed-4190-865c-7601e7592954
            transform: NATION.N_COMMENT
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4568f41f-0bea-4f8d-82e4-97bd44b9f4fb
          stepCounter: 1cd9e20d-a3ed-4190-865c-7601e7592954
        config: {}
        dataType: VARCHAR
        description: ""
        name: R_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4568f41f-0bea-4f8d-82e4-97bd44b9f4fb
                stepCounter: 1cd9e20d-a3ed-4190-865c-7601e7592954
            transform: REGION.R_NAME
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c8a94675-d79a-45ec-9dca-b179a932b079
          stepCounter: 1cd9e20d-a3ed-4190-865c-7601e7592954
        config: {}
        dataType: VARCHAR
        description: ""
        name: R_COMMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c8a94675-d79a-45ec-9dca-b179a932b079
                stepCounter: 1cd9e20d-a3ed-4190-865c-7601e7592954
            transform: REGION.R_COMMENT
    cteString: ""
    description: ""
    destinationName: ""
    enabledColumnTestIDs: []
    materializationOption: ""
    sourceMapping:
      - aliases:
          CUSTOMER: 473200e1-c8ff-4f6b-8421-2aae1f54c3cd
          NATION: ecad5700-7f15-484a-8ee3-bf6122c1298e
          REGION: e62d8a25-65f1-4590-a0cd-25d28caa728f
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: SOURCE_TPCH
            nodeName: CUSTOMER
          - locationName: SOURCE_TPCH
            nodeName: NATION
          - locationName: SOURCE_TPCH
            nodeName: REGION
        join:
          joinCondition: FROM {{ ref('SOURCE_TPCH', 'CUSTOMER') }} CUSTOMER INNER JOIN {{ ref('SOURCE_TPCH', 'NATION') }} NATION ON CUSTOMER.C_NATIONKEY = NATION.N_NATIONKEY INNER JOIN {{ ref('SOURCE_TPCH', 'REGION') }} REGION ON NATION.N_REGIONKEY = REGION.R_REGIONKEY
        name: STG_CUSTOMER
        noLinkRefs: []
  name: STG_CUSTOMER
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
