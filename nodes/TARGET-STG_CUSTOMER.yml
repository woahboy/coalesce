fileVersion: 1
id: a85f4138-5ef0-42e4-ae31-d76a528ea342
name: STG_CUSTOMER
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: Staging table for customer data, joined with nation and region data
  isMultisource: false
  locationName: TARGET
  materializationType: table
  metadata:
    appliedNodeTests:
      - continueOnFailure: true
        description: ""
        name: Test
        runOrder: After
        templateString: ""
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4334f2ac-7449-4d69-8db1-73943857f673
          stepCounter: a85f4138-5ef0-42e4-ae31-d76a528ea342
        config: {}
        dataType: NUMBER
        description: ""
        name: C_CUSTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4334f2ac-7449-4d69-8db1-73943857f673
                stepCounter: a85f4138-5ef0-42e4-ae31-d76a528ea342
            transform: CUSTOMER.C_CUSTKEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dddff189-d7bc-4947-830d-885921dcf515
          stepCounter: a85f4138-5ef0-42e4-ae31-d76a528ea342
        config: {}
        dataType: VARCHAR
        description: ""
        name: CUSTOMER_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dddff189-d7bc-4947-830d-885921dcf515
                stepCounter: a85f4138-5ef0-42e4-ae31-d76a528ea342
            transform: CASE WHEN "STG_CUSTOMER"."C_NAME" = ' ' THEN NULL ELSE "STG_CUSTOMER"."C_NAME" END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8a3a03a7-e548-4f4a-bdc3-5ad290f66f8b
          stepCounter: a85f4138-5ef0-42e4-ae31-d76a528ea342
        config: {}
        dataType: VARCHAR
        description: ""
        name: CUSTOMER_ADDRESS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8a3a03a7-e548-4f4a-bdc3-5ad290f66f8b
                stepCounter: a85f4138-5ef0-42e4-ae31-d76a528ea342
            transform: CASE WHEN "STG_CUSTOMER"."C_ADDRESS" = ' ' THEN NULL ELSE "STG_CUSTOMER"."C_ADDRESS" END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0acd7bb9-2576-4f96-a9b1-341aaaa568cd
          stepCounter: a85f4138-5ef0-42e4-ae31-d76a528ea342
        config: {}
        dataType: VARCHAR
        description: ""
        name: CUSTOMER_PHONE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0acd7bb9-2576-4f96-a9b1-341aaaa568cd
                stepCounter: a85f4138-5ef0-42e4-ae31-d76a528ea342
            transform: CASE WHEN "STG_CUSTOMER"."C_PHONE" = ' ' THEN NULL ELSE "STG_CUSTOMER"."C_PHONE" END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 511b5781-9ed8-49fe-8368-e2c9c3af0cbc
          stepCounter: a85f4138-5ef0-42e4-ae31-d76a528ea342
        config: {}
        dataType: NUMBER
        description: ""
        name: CUSTOMER_ACCTBAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 511b5781-9ed8-49fe-8368-e2c9c3af0cbc
                stepCounter: a85f4138-5ef0-42e4-ae31-d76a528ea342
            transform: CASE WHEN "STG_CUSTOMER"."C_ACCTBAL" = ' ' THEN NULL ELSE "STG_CUSTOMER"."C_ACCTBAL" END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 331f5528-54a7-48f0-a8af-65e1315d4c17
          stepCounter: a85f4138-5ef0-42e4-ae31-d76a528ea342
        config: {}
        dataType: VARCHAR
        description: ""
        name: C_MKTSEGMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 331f5528-54a7-48f0-a8af-65e1315d4c17
                stepCounter: a85f4138-5ef0-42e4-ae31-d76a528ea342
            transform: CUSTOMER.C_MKTSEGMENT
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d9f7640f-daa6-4e18-af37-8c1e3d65e2f2
          stepCounter: a85f4138-5ef0-42e4-ae31-d76a528ea342
        config: {}
        dataType: VARCHAR
        description: ""
        name: C_VALUE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d9f7640f-daa6-4e18-af37-8c1e3d65e2f2
                stepCounter: a85f4138-5ef0-42e4-ae31-d76a528ea342
            transform: CASE WHEN CUSTOMER.C_ACCTBAL > 5000 AND CUSTOMER.C_MKTSEGMENT IN ('BUILDING', 'HOUSEHOLD') THEN 'High' ELSE 'Low' END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8bba877a-b438-45d3-ab99-5ab39fa55cb7
          stepCounter: a85f4138-5ef0-42e4-ae31-d76a528ea342
        config: {}
        dataType: VARCHAR
        description: ""
        name: C_COMMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8bba877a-b438-45d3-ab99-5ab39fa55cb7
                stepCounter: a85f4138-5ef0-42e4-ae31-d76a528ea342
            transform: CUSTOMER.C_COMMENT
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5c041328-6e93-489a-a9b2-c93f3b6d1f71
          stepCounter: a85f4138-5ef0-42e4-ae31-d76a528ea342
        config: {}
        dataType: VARCHAR
        description: ""
        name: N_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5c041328-6e93-489a-a9b2-c93f3b6d1f71
                stepCounter: a85f4138-5ef0-42e4-ae31-d76a528ea342
            transform: NATION.N_NAME
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d10ef73e-371d-417b-be1d-6643e90dfc73
          stepCounter: a85f4138-5ef0-42e4-ae31-d76a528ea342
        config: {}
        dataType: VARCHAR
        description: ""
        name: N_COMMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d10ef73e-371d-417b-be1d-6643e90dfc73
                stepCounter: a85f4138-5ef0-42e4-ae31-d76a528ea342
            transform: NATION.N_COMMENT
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ab5667a5-3252-41d8-9f3f-b1f6f498a234
          stepCounter: a85f4138-5ef0-42e4-ae31-d76a528ea342
        config: {}
        dataType: VARCHAR
        description: ""
        name: R_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ab5667a5-3252-41d8-9f3f-b1f6f498a234
                stepCounter: a85f4138-5ef0-42e4-ae31-d76a528ea342
            transform: REGION.R_NAME
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dd80e121-6027-460f-935d-3c30ff5978e7
          stepCounter: a85f4138-5ef0-42e4-ae31-d76a528ea342
        config: {}
        dataType: VARCHAR
        description: ""
        name: R_COMMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dd80e121-6027-460f-935d-3c30ff5978e7
                stepCounter: a85f4138-5ef0-42e4-ae31-d76a528ea342
            transform: REGION.R_COMMENT
    cteString: ""
    description: ""
    destinationName: ""
    enabledColumnTestIDs: []
    materializationOption: ""
    sourceMapping:
      - aliases:
          CUSTOMER: 473200e1-c8ff-4f6b-8421-2aae1f54c3cd
          NATION: ecad5700-7f15-484a-8ee3-bf6122c1298e
          REGION: e62d8a25-65f1-4590-a0cd-25d28caa728f
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: SOURCE_TPCH
            nodeName: CUSTOMER
          - locationName: SOURCE_TPCH
            nodeName: NATION
          - locationName: SOURCE_TPCH
            nodeName: REGION
        join:
          joinCondition: FROM {{ ref('SOURCE_TPCH', 'CUSTOMER') }} CUSTOMER INNER JOIN {{ ref('SOURCE_TPCH', 'NATION') }} NATION ON CUSTOMER.C_NATIONKEY = NATION.N_NATIONKEY INNER JOIN {{ ref('SOURCE_TPCH', 'REGION') }} REGION ON NATION.N_REGIONKEY = REGION.R_REGIONKEY
        name: STG_CUSTOMER
        noLinkRefs: []
  name: STG_CUSTOMER
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
