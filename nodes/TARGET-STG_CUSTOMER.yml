steps:
  STG_CUSTOMER-92513e9a-cd5f-403d-82fc-6513e2eb9a39:
    operation:
      config:
        insertStrategy: INSERT
        postSQL: ""
        preSQL: ""
        selectDistinct: true
        testsEnabled: true
        truncateBefore: true
      database: ""
      deployEnabled: true
      description: Customer data as defined by TPC-H
      isMultisource: false
      locationName: TARGET
      materializationType: table
      metadata:
        appliedNodeTests:
          - continueOnFailure: true
            description: ""
            name: Test
            runOrder: After
            templateString: |2
                  SELECT
                    *
                  FROM
                    "JUSTIN_EDW"."DEV_EDW"."STG_CUSTOMER"
                  WHERE
                    "C_MKTSEGMENT" IS NULL
        columns:
          - appliedColumnTests:
              hasNull: false
              isDistinct: false
            columnReference:
              columnCounter: 49bd41a8-264e-484c-b946-0f493290f7d4
              stepCounter: 92513e9a-cd5f-403d-82fc-6513e2eb9a39
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: C_CUSTKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: f0154ab7-dca5-44dc-86ca-b2983a5b235c
                    stepCounter: d0cba679-7f10-4153-a6e2-6d5420aa5ca1
                transform: ""
          - appliedColumnTests:
              hasNull: false
              isDistinct: false
            columnReference:
              columnCounter: 6d0468cd-5662-44f8-90c8-e35f6380f5c8
              stepCounter: 92513e9a-cd5f-403d-82fc-6513e2eb9a39
            dataType: VARCHAR(25)
            description: ""
            hashColumns: []
            hashDetails: null
            name: C_NAME
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 74c266fe-59b0-4fc2-9d31-a82022f6d350
                    stepCounter: d0cba679-7f10-4153-a6e2-6d5420aa5ca1
                transform: INITCAP("CUSTOMER"."C_NAME")
          - appliedColumnTests:
              hasNull: false
              isDistinct: false
            columnReference:
              columnCounter: 83709072-6c72-41b6-b2c6-e58526e507cf
              stepCounter: 92513e9a-cd5f-403d-82fc-6513e2eb9a39
            dataType: VARCHAR(40)
            description: ""
            hashColumns: []
            hashDetails: null
            name: C_ADDRESS
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 65703190-c0cb-488d-bb98-5437860bd5ad
                    stepCounter: d0cba679-7f10-4153-a6e2-6d5420aa5ca1
                transform: INITCAP("CUSTOMER"."C_ADDRESS")
          - appliedColumnTests:
              hasNull: false
              isDistinct: false
            columnReference:
              columnCounter: 998d37bc-ec6b-4ce0-a422-8382fc336156
              stepCounter: 92513e9a-cd5f-403d-82fc-6513e2eb9a39
            dataType: VARCHAR(15)
            description: ""
            hashColumns: []
            hashDetails: null
            name: C_PHONE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 0df0398f-7d87-4569-b3cb-ecc089d05812
                    stepCounter: d0cba679-7f10-4153-a6e2-6d5420aa5ca1
                transform: ""
          - appliedColumnTests:
              hasNull: false
              isDistinct: true
            columnReference:
              columnCounter: 84cb45e3-52c8-44c9-b3d2-415a481fcb74
              stepCounter: 92513e9a-cd5f-403d-82fc-6513e2eb9a39
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: C_ACCTBAL
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: c7f2765f-15ea-4b3f-8bc2-7f0ec4f034c6
                    stepCounter: d0cba679-7f10-4153-a6e2-6d5420aa5ca1
                transform: ""
          - appliedColumnTests:
              hasNull: true
              isDistinct: false
            columnReference:
              columnCounter: 661ccf7e-6dc8-40a0-a10b-fb5173142de8
              stepCounter: 92513e9a-cd5f-403d-82fc-6513e2eb9a39
            dataType: VARCHAR(10)
            description: ""
            hashColumns: []
            hashDetails: null
            name: C_MKTSEGMENT
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: f237e0d6-0bc8-4dcc-8f54-3759ecfff0b9
                    stepCounter: d0cba679-7f10-4153-a6e2-6d5420aa5ca1
                transform: INITCAP("CUSTOMER"."C_MKTSEGMENT")
          - appliedColumnTests:
              hasNull: false
              isDistinct: false
            columnReference:
              columnCounter: 9d1f1449-dfdb-44b0-b4e6-de572d2be14d
              stepCounter: 92513e9a-cd5f-403d-82fc-6513e2eb9a39
            dataType: VARCHAR(10)
            description: ""
            hashColumns: []
            hashDetails: null
            name: C_VALUE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: f237e0d6-0bc8-4dcc-8f54-3759ecfff0b9
                    stepCounter: d0cba679-7f10-4153-a6e2-6d5420aa5ca1
                transform: CASE WHEN "CUSTOMER"."C_ACCTBAL" > 5000 AND "CUSTOMER"."C_MKTSEGMENT" IN ('BUILDING', 'HOUSEHOLD') THEN 'High' ELSE 'Low' END
          - appliedColumnTests:
              hasNull: false
              isDistinct: false
            columnReference:
              columnCounter: 7338f0b9-2329-4937-98ed-50fe13c23682
              stepCounter: 92513e9a-cd5f-403d-82fc-6513e2eb9a39
            dataType: VARCHAR(117)
            description: ""
            hashColumns: []
            hashDetails: null
            name: C_COMMENT
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 5fe3cad5-4290-4918-995f-76afa24d4e92
                    stepCounter: d0cba679-7f10-4153-a6e2-6d5420aa5ca1
                transform: ""
          - appliedColumnTests:
              hasNull: false
              isDistinct: false
            columnReference:
              columnCounter: 4c51194a-9d70-45f1-978f-45f6bf51cd3f
              stepCounter: 92513e9a-cd5f-403d-82fc-6513e2eb9a39
            dataType: VARCHAR(25)
            description: ""
            name: N_NAME
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 4ba2887a-d39f-4961-a9c9-5d1ea13c8edf
                    stepCounter: 48fc0b53-6fc7-4034-abbb-0cdc2c44028c
                transform: ""
          - appliedColumnTests:
              hasNull: false
              isDistinct: false
            columnReference:
              columnCounter: 0f9d8b2d-2ba6-429b-bff3-02954b655c12
              stepCounter: 92513e9a-cd5f-403d-82fc-6513e2eb9a39
            dataType: VARCHAR(152)
            description: ""
            name: N_COMMENT
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: ac26c4fe-f563-4634-92fe-c8c1f3bd3cce
                    stepCounter: 48fc0b53-6fc7-4034-abbb-0cdc2c44028c
                transform: ""
          - appliedColumnTests:
              hasNull: false
              isDistinct: false
            columnReference:
              columnCounter: 2d671b33-2042-4346-ae4f-a874fc97422b
              stepCounter: 92513e9a-cd5f-403d-82fc-6513e2eb9a39
            dataType: VARCHAR(25)
            description: ""
            name: R_NAME
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 73f7cf9a-cad6-48bd-b28b-a3be9cefd514
                    stepCounter: fe36e4ed-7075-46a4-bf1e-a0d1d0ce1ba1
                transform: ""
          - appliedColumnTests:
              hasNull: false
              isDistinct: false
            columnReference:
              columnCounter: 7cd91099-3b78-4294-8415-e2f4598ffea9
              stepCounter: 92513e9a-cd5f-403d-82fc-6513e2eb9a39
            dataType: VARCHAR(152)
            description: ""
            name: R_COMMENT
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 0386fd09-b67a-47e1-ba6b-a0f70a9c04e6
                    stepCounter: fe36e4ed-7075-46a4-bf1e-a0d1d0ce1ba1
                transform: ""
        cteString: ""
        enabledColumnTestIDs:
          - hasNull
          - isDistinct
        sourceMapping:
          - aliases:
              CUSTOMER: d0cba679-7f10-4153-a6e2-6d5420aa5ca1
              NATION: 48fc0b53-6fc7-4034-abbb-0cdc2c44028c
              REGION: fe36e4ed-7075-46a4-bf1e-a0d1d0ce1ba1
            customSQL:
              customSQL: ""
            dependencies:
              - locationName: SOURCE-1
                nodeName: CUSTOMER
              - locationName: SOURCE-1
                nodeName: NATION
              - locationName: SOURCE-1
                nodeName: REGION
            join:
              joinCondition: |-
                FROM {{ ref('SOURCE-1', 'CUSTOMER') }} "CUSTOMER"
                INNER JOIN {{ ref('SOURCE-1', 'NATION') }} "NATION"
                ON "CUSTOMER"."C_NATIONKEY" = "NATION"."N_NATIONKEY"
                INNER JOIN {{ ref('SOURCE-1', 'REGION') }} "REGION"
                ON "NATION"."N_REGIONKEY" = "REGION"."R_REGIONKEY"
            name: STG_CUSTOMER
            noLinkRefs: []
      name: STG_CUSTOMER
      overrideSQL: false
      schema: ""
      sqlType: "247"
      type: sql
    stepCounter: 92513e9a-cd5f-403d-82fc-6513e2eb9a39
