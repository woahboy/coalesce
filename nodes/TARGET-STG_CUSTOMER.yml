fileVersion: 1
id: a594eb17-179c-4682-8184-e664536f28fd
name: STG_CUSTOMER
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: Customer data as defined by TPC-H
  isMultisource: false
  locationName: TARGET
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3a48d1ad-cecd-4418-a217-530f2ed7d5e2
          stepCounter: a594eb17-179c-4682-8184-e664536f28fd
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: C_CUSTKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ff84b972-240e-45b8-905c-8f9ae4fd3d68
                stepCounter: 7e42840e-2bae-41a8-b8cd-156cb4caac87
            transform: ""
          - columnReferences:
              - columnCounter: bb6f8823-3a42-4fb0-9313-6d40e2d9a1de
                stepCounter: 880a0aa7-318b-4382-877e-743113d6c74e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ffb41226-915e-4442-9dcb-a2b3f006fa55
          stepCounter: a594eb17-179c-4682-8184-e664536f28fd
        config: {}
        dataType: VARCHAR(25)
        description: ""
        name: C_NAME
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 83ca4312-d556-4d13-ae3b-cc22f6910471
                stepCounter: 7e42840e-2bae-41a8-b8cd-156cb4caac87
            transform: ""
          - columnReferences:
              - columnCounter: b7670302-065b-469c-8da7-752722d0907a
                stepCounter: 880a0aa7-318b-4382-877e-743113d6c74e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6958fae3-d0f2-43aa-9c7f-c71902038fe7
          stepCounter: a594eb17-179c-4682-8184-e664536f28fd
        config: {}
        dataType: VARCHAR(40)
        description: ""
        name: C_ADDRESS
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 22f9a262-d743-457a-9603-0c23844a47b8
                stepCounter: 7e42840e-2bae-41a8-b8cd-156cb4caac87
            transform: ""
          - columnReferences:
              - columnCounter: 03db3dc0-ede2-4fcd-ade2-68d2ad60a2db
                stepCounter: 880a0aa7-318b-4382-877e-743113d6c74e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 75dcc3e9-26a7-404a-b9b8-943e2e7b9d82
          stepCounter: a594eb17-179c-4682-8184-e664536f28fd
        config: {}
        dataType: VARCHAR(15)
        description: ""
        name: C_PHONE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d7073c12-8b87-4cb0-8aa1-71b4a54524ea
                stepCounter: 7e42840e-2bae-41a8-b8cd-156cb4caac87
            transform: ""
          - columnReferences:
              - columnCounter: 7ab70796-22bf-4d40-afd2-c0f13d429e87
                stepCounter: 880a0aa7-318b-4382-877e-743113d6c74e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 66905313-d010-4a41-aac1-ffafcfbb6e95
          stepCounter: a594eb17-179c-4682-8184-e664536f28fd
        config: {}
        dataType: NUMBER(12,2)
        description: ""
        name: C_ACCTBAL
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 87b44733-ca97-47e8-a9ed-d4fb19c6a2f7
                stepCounter: 7e42840e-2bae-41a8-b8cd-156cb4caac87
            transform: ""
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e79a1591-da39-4cc4-b223-ddcee5a0681c
          stepCounter: a594eb17-179c-4682-8184-e664536f28fd
        config: {}
        dataType: VARCHAR(10)
        description: ""
        name: C_MKTSEGMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1ab6fd1c-e3d0-43ae-8909-f4dedb5621b1
                stepCounter: 7e42840e-2bae-41a8-b8cd-156cb4caac87
            transform: ""
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 18d7d16f-6bb6-47f2-94cf-8f35e5bbe68c
          stepCounter: a594eb17-179c-4682-8184-e664536f28fd
        config: {}
        dataType: VARCHAR(10)
        description: ""
        name: C_VALUE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1ab6fd1c-e3d0-43ae-8909-f4dedb5621b1
                stepCounter: 7e42840e-2bae-41a8-b8cd-156cb4caac87
            transform: CASE WHEN "CUSTOMER"."C_ACCTBAL" > 5000 AND "CUSTOMER"."C_MKTSEGMENT" IN ('BUILDING', 'HOUSEHOLD') THEN 'High' ELSE 'Low' END
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2f110cd4-c287-40f4-89f6-46a256b2a3fb
          stepCounter: a594eb17-179c-4682-8184-e664536f28fd
        config: {}
        dataType: VARCHAR(117)
        description: ""
        name: C_COMMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e767ce71-3078-4a1c-a6ad-f1d029dd8737
                stepCounter: 7e42840e-2bae-41a8-b8cd-156cb4caac87
            transform: ""
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f1b7657d-dc40-4ab3-993d-29a2eb174841
          stepCounter: a594eb17-179c-4682-8184-e664536f28fd
        config: {}
        dataType: VARCHAR(25)
        description: ""
        name: N_NAME
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ee7de597-60b5-45ad-8bea-83b350d42422
                stepCounter: 8aeebc61-4bcd-4261-aa7d-78d1eea7c590
            transform: ""
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b87e9b03-94cd-4e3e-9d3a-3fcd7c0cf500
          stepCounter: a594eb17-179c-4682-8184-e664536f28fd
        config: {}
        dataType: VARCHAR(152)
        description: ""
        name: N_COMMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8252e7cb-7672-45be-968c-45250d37af4c
                stepCounter: 8aeebc61-4bcd-4261-aa7d-78d1eea7c590
            transform: ""
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7d6f0c51-b8e1-4934-93cf-ba5b10f1e983
          stepCounter: a594eb17-179c-4682-8184-e664536f28fd
        config: {}
        dataType: VARCHAR(25)
        description: ""
        name: R_NAME
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c0830c4d-204a-40bf-b0a0-aa0ef9c1837a
                stepCounter: 0cf28db1-d121-44e2-9777-ff4448330d61
            transform: ""
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 47b25fc2-9952-4e2a-82a8-e8360eba5225
          stepCounter: a594eb17-179c-4682-8184-e664536f28fd
        config: {}
        dataType: VARCHAR(152)
        description: ""
        name: R_COMMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 97ac71ba-3602-4541-a244-80c1f19de20f
                stepCounter: 0cf28db1-d121-44e2-9777-ff4448330d61
            transform: ""
          - columnReferences: []
            transform: ""
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          CUSTOMER: 7e42840e-2bae-41a8-b8cd-156cb4caac87
          NATION: 8aeebc61-4bcd-4261-aa7d-78d1eea7c590
          REGION: 0cf28db1-d121-44e2-9777-ff4448330d61
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: SOURCE_TPCH
            nodeName: CUSTOMER
          - locationName: SOURCE_TPCH
            nodeName: NATION
          - locationName: SOURCE_TPCH
            nodeName: REGION
        join:
          joinCondition: |-
            FROM {{ ref('SOURCE_TPCH', 'CUSTOMER') }} "CUSTOMER"
            INNER JOIN {{ ref('SOURCE_TPCH', 'NATION') }} "NATION"
            ON "CUSTOMER"."C_NATIONKEY" = "NATION"."N_NATIONKEY"
            INNER JOIN {{ ref('SOURCE_TPCH', 'REGION') }} "REGION"
            ON "NATION"."N_REGIONKEY" = "REGION"."R_REGIONKEY"
        name: STG_CUSTOMER
        noLinkRefs: []
      - aliases:
          CUSTOMER: 880a0aa7-318b-4382-877e-743113d6c74e
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: SOURCE_CUSTOM
            nodeName: CUSTOMER
        join:
          joinCondition: FROM {{ ref('SOURCE_CUSTOM', 'CUSTOMER') }} "CUSTOMER"
        name: NEW_SOURCE
        noLinkRefs: []
  name: STG_CUSTOMER
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
