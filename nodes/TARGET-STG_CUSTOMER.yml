steps:
  STG_CUSTOMER-832c5f27-ae20-4415-af89-340f85a41ebc:
    operation:
      config:
        insertStrategy: INSERT
        postSQL: ""
        preSQL: ""
        testsEnabled: true
        truncateBefore: true
      database: ""
      deployEnabled: true
      description: Customer data as defined by TPC-H
      isMultisource: false
      locationName: TARGET
      materializationType: table
      metadata:
        appliedNodeTests: []
        columns:
          - appliedColumnTests:
              hasNull: false
              isDistinct: false
            columnReference:
              columnCounter: 1b00a3cf-ec90-413f-a8ed-05dda359ca22
              stepCounter: 832c5f27-ae20-4415-af89-340f85a41ebc
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: C_CUSTKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 4a204123-3a3e-4701-a0f2-6d1851cc8a47
                    stepCounter: 76fa780b-0677-4ed1-aa97-7ab2078be408
                transform: ""
          - appliedColumnTests:
              hasNull: false
              isDistinct: false
            columnReference:
              columnCounter: 343379fe-4e45-45f6-953d-d1dba9190643
              stepCounter: 832c5f27-ae20-4415-af89-340f85a41ebc
            dataType: VARCHAR(25)
            description: ""
            hashColumns: []
            hashDetails: null
            name: C_NAME
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 57155dce-c4ad-41f9-a1fb-6ceb40cc46f9
                    stepCounter: 76fa780b-0677-4ed1-aa97-7ab2078be408
                transform: INITCAP("CUSTOMER"."C_NAME")
          - appliedColumnTests:
              hasNull: false
              isDistinct: false
            columnReference:
              columnCounter: ffd586de-b8a7-46c2-b662-026859ab5686
              stepCounter: 832c5f27-ae20-4415-af89-340f85a41ebc
            dataType: VARCHAR(40)
            description: ""
            hashColumns: []
            hashDetails: null
            name: C_ADDRESS
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: d624627f-071f-40b1-b48c-cb7f7069233e
                    stepCounter: 76fa780b-0677-4ed1-aa97-7ab2078be408
                transform: INITCAP("CUSTOMER"."C_ADDRESS")
          - appliedColumnTests:
              hasNull: false
              isDistinct: true
            columnReference:
              columnCounter: b56b0342-6540-4627-b88a-e29f6c4dfd9c
              stepCounter: 832c5f27-ae20-4415-af89-340f85a41ebc
            dataType: VARCHAR(15)
            description: ""
            hashColumns: []
            hashDetails: null
            name: C_PHONE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 99f84226-cd45-482d-979c-45228fecaf26
                    stepCounter: 76fa780b-0677-4ed1-aa97-7ab2078be408
                transform: INITCAP("CUSTOMER"."C_PHONE")
          - appliedColumnTests:
              hasNull: true
              isDistinct: false
            columnReference:
              columnCounter: 91c217ae-2ec6-4ba0-8570-44055e5369d9
              stepCounter: 832c5f27-ae20-4415-af89-340f85a41ebc
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: C_ACCTBAL
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 911cdb6b-2524-4f3e-8324-b9ad2ef3da8f
                    stepCounter: 76fa780b-0677-4ed1-aa97-7ab2078be408
                transform: ""
          - appliedColumnTests:
              hasNull: false
              isDistinct: false
            columnReference:
              columnCounter: 45716144-8c90-488d-b19c-769edc83d254
              stepCounter: 832c5f27-ae20-4415-af89-340f85a41ebc
            dataType: VARCHAR(10)
            description: ""
            hashColumns: []
            hashDetails: null
            name: C_MKTSEGMENT
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 5c0808d6-d1a4-4256-accc-790b345b54a4
                    stepCounter: 76fa780b-0677-4ed1-aa97-7ab2078be408
                transform: INITCAP("CUSTOMER"."C_MKTSEGMENT")
          - appliedColumnTests:
              hasNull: false
              isDistinct: false
            columnReference:
              columnCounter: a0016d03-ec8f-466b-80af-dea90722c90c
              stepCounter: 832c5f27-ae20-4415-af89-340f85a41ebc
            dataType: VARCHAR(10)
            description: ""
            hashColumns: []
            hashDetails: null
            name: C_VALUE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 5c0808d6-d1a4-4256-accc-790b345b54a4
                    stepCounter: 76fa780b-0677-4ed1-aa97-7ab2078be408
                transform: CASE WHEN "CUSTOMER"."C_ACCTBAL" > 5000 AND "CUSTOMER"."C_MKTSEGMENT" IN ('BUILDING', 'HOUSEHOLD') THEN 'High' ELSE 'Low' END
          - appliedColumnTests:
              hasNull: false
              isDistinct: false
            columnReference:
              columnCounter: 8370e86b-5156-4b07-a5c4-77da91b04957
              stepCounter: 832c5f27-ae20-4415-af89-340f85a41ebc
            dataType: VARCHAR(117)
            description: ""
            hashColumns: []
            hashDetails: null
            name: C_COMMENT
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: cf387185-93d3-4a92-a6e2-aa12da166080
                    stepCounter: 76fa780b-0677-4ed1-aa97-7ab2078be408
                transform: INITCAP("CUSTOMER"."C_COMMENT")
          - appliedColumnTests:
              hasNull: false
              isDistinct: false
            columnReference:
              columnCounter: 15135192-41dc-465b-b454-110727a6fad7
              stepCounter: 832c5f27-ae20-4415-af89-340f85a41ebc
            dataType: VARCHAR(25)
            description: ""
            name: N_NAME
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 99ae9189-82fc-49ee-949b-47dae49a19c3
                    stepCounter: d1fc0f58-268b-4fac-9b16-aa3dc7dc246d
                transform: INITCAP("NATION"."N_NAME")
          - appliedColumnTests:
              hasNull: false
              isDistinct: false
            columnReference:
              columnCounter: 2ff725b8-3ab2-4bab-a532-50f4204aab90
              stepCounter: 832c5f27-ae20-4415-af89-340f85a41ebc
            dataType: VARCHAR(152)
            description: ""
            name: N_COMMENT
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 58ff6996-db06-4198-946f-8fe871d6d984
                    stepCounter: d1fc0f58-268b-4fac-9b16-aa3dc7dc246d
                transform: INITCAP("NATION"."N_COMMENT")
          - appliedColumnTests:
              hasNull: false
              isDistinct: false
            columnReference:
              columnCounter: e1eba711-e915-4100-ab22-c43858cf1530
              stepCounter: 832c5f27-ae20-4415-af89-340f85a41ebc
            dataType: VARCHAR(25)
            description: ""
            name: R_NAME
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 4a9a48fb-28be-47aa-afb7-8312bad2e182
                    stepCounter: a28cb554-6622-45a7-992a-1cf4f34a4092
                transform: INITCAP("REGION"."R_NAME")
          - appliedColumnTests:
              hasNull: false
              isDistinct: false
            columnReference:
              columnCounter: 3b2852cf-351a-4b1a-8a16-b1ed0890bc9f
              stepCounter: 832c5f27-ae20-4415-af89-340f85a41ebc
            dataType: VARCHAR(152)
            description: ""
            name: R_COMMENT
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 77a69d33-d235-4fd8-aa08-f5836878d35a
                    stepCounter: a28cb554-6622-45a7-992a-1cf4f34a4092
                transform: INITCAP("REGION"."R_COMMENT")
        cteString: ""
        enabledColumnTestIDs:
          - hasNull
          - isDistinct
        sourceMapping:
          - aliases:
              CUSTOMER: 76fa780b-0677-4ed1-aa97-7ab2078be408
              NATION: d1fc0f58-268b-4fac-9b16-aa3dc7dc246d
              REGION: a28cb554-6622-45a7-992a-1cf4f34a4092
            customSQL:
              customSQL: ""
            dependencies:
              - locationName: SOURCE-1
                nodeName: CUSTOMER
              - locationName: SOURCE-1
                nodeName: NATION
              - locationName: SOURCE-1
                nodeName: REGION
            join:
              joinCondition: |-
                FROM {{ ref('SOURCE-1', 'CUSTOMER') }} "CUSTOMER"
                INNER JOIN {{ ref('SOURCE-1', 'NATION') }} "NATION"
                ON "CUSTOMER"."C_NATIONKEY" = "NATION"."N_NATIONKEY"
                INNER JOIN {{ ref('SOURCE-1', 'REGION') }} "REGION"
                ON "NATION"."N_REGIONKEY" = "REGION"."R_REGIONKEY"
            name: STG_CUSTOMER
            noLinkRefs: []
      name: STG_CUSTOMER
      overrideSQL: false
      schema: ""
      sqlType: Stage
      type: sql
    stepCounter: 832c5f27-ae20-4415-af89-340f85a41ebc
