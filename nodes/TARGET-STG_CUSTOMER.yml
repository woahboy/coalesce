fileVersion: 1
id: 4e11f20a-1465-4e83-828f-addc45206395
name: STG_CUSTOMER
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: Staging table for customer data with nation and region details
  isMultisource: false
  locationName: TARGET
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 75322001-f0ae-45f6-b497-0c59a9d96202
          stepCounter: 4e11f20a-1465-4e83-828f-addc45206395
        config: {}
        dataType: NUMBER
        description: ""
        name: C_CUSTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 75322001-f0ae-45f6-b497-0c59a9d96202
                stepCounter: 4e11f20a-1465-4e83-828f-addc45206395
            transform: CUSTOMER.C_CUSTKEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 337585bc-066e-429d-b3f1-3a62dc449771
          stepCounter: 4e11f20a-1465-4e83-828f-addc45206395
        config: {}
        dataType: VARCHAR
        description: ""
        name: C_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 337585bc-066e-429d-b3f1-3a62dc449771
                stepCounter: 4e11f20a-1465-4e83-828f-addc45206395
            transform: CUSTOMER.C_NAME
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 460ec8fd-343a-4e31-8371-1d40730e240a
          stepCounter: 4e11f20a-1465-4e83-828f-addc45206395
        config: {}
        dataType: VARCHAR
        description: ""
        name: C_ADDRESS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 460ec8fd-343a-4e31-8371-1d40730e240a
                stepCounter: 4e11f20a-1465-4e83-828f-addc45206395
            transform: CUSTOMER.C_ADDRESS
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 143856ea-4c5c-499c-85dc-5e8b0e8eb52d
          stepCounter: 4e11f20a-1465-4e83-828f-addc45206395
        config: {}
        dataType: VARCHAR
        description: ""
        name: C_PHONE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 143856ea-4c5c-499c-85dc-5e8b0e8eb52d
                stepCounter: 4e11f20a-1465-4e83-828f-addc45206395
            transform: CUSTOMER.C_PHONE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 39bb989a-d967-4dd7-b449-c2e1d7f7efc2
          stepCounter: 4e11f20a-1465-4e83-828f-addc45206395
        config: {}
        dataType: NUMBER
        description: ""
        name: C_ACCTBAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 39bb989a-d967-4dd7-b449-c2e1d7f7efc2
                stepCounter: 4e11f20a-1465-4e83-828f-addc45206395
            transform: CUSTOMER.C_ACCTBAL
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eeb48bea-a841-44bf-a953-753bf4827ba7
          stepCounter: 4e11f20a-1465-4e83-828f-addc45206395
        config: {}
        dataType: VARCHAR
        description: ""
        name: C_MKTSEGMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eeb48bea-a841-44bf-a953-753bf4827ba7
                stepCounter: 4e11f20a-1465-4e83-828f-addc45206395
            transform: CUSTOMER.C_MKTSEGMENT
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0ce13a69-f0c5-4e41-8546-f64dc6c5e1e8
          stepCounter: 4e11f20a-1465-4e83-828f-addc45206395
        config: {}
        dataType: VARCHAR
        description: ""
        name: C_VALUE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0ce13a69-f0c5-4e41-8546-f64dc6c5e1e8
                stepCounter: 4e11f20a-1465-4e83-828f-addc45206395
            transform: CASE WHEN CUSTOMER.C_ACCTBAL > 5000 AND CUSTOMER.C_MKTSEGMENT IN ('BUILDING', 'HOUSEHOLD') THEN 'High' ELSE 'Low' END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ea81ed0d-e5ce-460b-b646-60742ae2acfa
          stepCounter: 4e11f20a-1465-4e83-828f-addc45206395
        config: {}
        dataType: VARCHAR
        description: ""
        name: C_COMMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ea81ed0d-e5ce-460b-b646-60742ae2acfa
                stepCounter: 4e11f20a-1465-4e83-828f-addc45206395
            transform: CUSTOMER.C_COMMENT
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fbd169a9-4f10-4cb6-9bbd-a0a42ce0c424
          stepCounter: 4e11f20a-1465-4e83-828f-addc45206395
        config: {}
        dataType: VARCHAR
        description: ""
        name: N_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fbd169a9-4f10-4cb6-9bbd-a0a42ce0c424
                stepCounter: 4e11f20a-1465-4e83-828f-addc45206395
            transform: NATION.N_NAME
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2513c1d9-2c87-4583-8a1c-eb18acf76e45
          stepCounter: 4e11f20a-1465-4e83-828f-addc45206395
        config: {}
        dataType: VARCHAR
        description: ""
        name: N_COMMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2513c1d9-2c87-4583-8a1c-eb18acf76e45
                stepCounter: 4e11f20a-1465-4e83-828f-addc45206395
            transform: NATION.N_COMMENT
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 21b49977-af3b-476e-ae5d-3f4bdbdcd9ad
          stepCounter: 4e11f20a-1465-4e83-828f-addc45206395
        config: {}
        dataType: VARCHAR
        description: ""
        name: R_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 21b49977-af3b-476e-ae5d-3f4bdbdcd9ad
                stepCounter: 4e11f20a-1465-4e83-828f-addc45206395
            transform: REGION.R_NAME
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 625c557c-de67-41ce-8ac8-2215489782bb
          stepCounter: 4e11f20a-1465-4e83-828f-addc45206395
        config: {}
        dataType: VARCHAR
        description: ""
        name: R_COMMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 625c557c-de67-41ce-8ac8-2215489782bb
                stepCounter: 4e11f20a-1465-4e83-828f-addc45206395
            transform: REGION.R_COMMENT
    cteString: ""
    description: ""
    destinationName: ""
    enabledColumnTestIDs: []
    materializationOption: ""
    sourceMapping:
      - aliases:
          CUSTOMER: 473200e1-c8ff-4f6b-8421-2aae1f54c3cd
          NATION: ecad5700-7f15-484a-8ee3-bf6122c1298e
          REGION: e62d8a25-65f1-4590-a0cd-25d28caa728f
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: SOURCE_TPCH
            nodeName: CUSTOMER
          - locationName: SOURCE_TPCH
            nodeName: NATION
          - locationName: SOURCE_TPCH
            nodeName: REGION
        join:
          joinCondition: FROM {{ ref('SOURCE_TPCH', 'CUSTOMER') }} CUSTOMER INNER JOIN {{ ref('SOURCE_TPCH', 'NATION') }} NATION ON CUSTOMER.C_NATIONKEY = NATION.N_NATIONKEY INNER JOIN {{ ref('SOURCE_TPCH', 'REGION') }} REGION ON NATION.N_REGIONKEY = REGION.R_REGIONKEY
        name: STG_CUSTOMER
        noLinkRefs: []
  name: STG_CUSTOMER
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
