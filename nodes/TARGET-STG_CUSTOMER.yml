fileVersion: 1
id: eede1e46-b189-44ea-b26c-cf3c35ed59c9
name: STG_CUSTOMER
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: Description from Stages to Views
  isMultisource: false
  locationName: TARGET
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7b457c67-5b88-4e34-a479-1dd1f1bdcb31
          stepCounter: eede1e46-b189-44ea-b26c-cf3c35ed59c9
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        hashColumns: []
        hashDetails: null
        name: C_CUSTKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9fac994a-dc10-4277-bf4a-536f3bcfe8f6
                stepCounter: 4f6680e9-aeaa-44b3-b968-eee7d31abc01
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 32a8224a-225d-4b9e-8c5b-a7e3f002c550
          stepCounter: eede1e46-b189-44ea-b26c-cf3c35ed59c9
        config: {}
        dataType: VARCHAR(25)
        description: ""
        hashColumns: []
        hashDetails: null
        name: C_NAME
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1719f571-95a1-4ebe-bebb-22cdf51261ff
                stepCounter: 4f6680e9-aeaa-44b3-b968-eee7d31abc01
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9622e881-ccc8-48f2-a680-64a4f9c6a397
          stepCounter: eede1e46-b189-44ea-b26c-cf3c35ed59c9
        config: {}
        dataType: VARCHAR(40)
        description: ""
        hashColumns: []
        hashDetails: null
        name: C_ADDRESS
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 74766960-d18d-45ac-b55f-37c2dbc35c38
                stepCounter: 4f6680e9-aeaa-44b3-b968-eee7d31abc01
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5c5bc5d5-7fae-4f4c-bf68-7f1189613b58
          stepCounter: eede1e46-b189-44ea-b26c-cf3c35ed59c9
        config: {}
        dataType: VARCHAR(15)
        description: ""
        hashColumns: []
        hashDetails: null
        name: C_PHONE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9c09be1e-d254-475d-a447-146443a454d9
                stepCounter: 4f6680e9-aeaa-44b3-b968-eee7d31abc01
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a8790d1d-7358-4596-83b1-434be8a419d1
          stepCounter: eede1e46-b189-44ea-b26c-cf3c35ed59c9
        config: {}
        dataType: NUMBER(12,2)
        description: ""
        hashColumns: []
        hashDetails: null
        name: C_ACCTBAL
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4ab12ab7-5c1c-4c67-a8fa-393b8b36b065
                stepCounter: 4f6680e9-aeaa-44b3-b968-eee7d31abc01
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 93153218-40d3-4f47-9450-e0c5e54ffdd1
          stepCounter: eede1e46-b189-44ea-b26c-cf3c35ed59c9
        config: {}
        dataType: VARCHAR(10)
        description: ""
        hashColumns: []
        hashDetails: null
        name: C_MKTSEGMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a557d30d-0a0a-43d5-a11b-da793ea1b984
                stepCounter: 4f6680e9-aeaa-44b3-b968-eee7d31abc01
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 79a0fcff-ba37-4dbd-8a51-a1ecb01a941d
          stepCounter: eede1e46-b189-44ea-b26c-cf3c35ed59c9
        config: {}
        dataType: VARCHAR(10)
        description: ""
        hashColumns: []
        hashDetails: null
        name: C_VALUE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a557d30d-0a0a-43d5-a11b-da793ea1b984
                stepCounter: 4f6680e9-aeaa-44b3-b968-eee7d31abc01
            transform: CASE WHEN "CUSTOMER"."C_ACCTBAL" > 5000 AND "CUSTOMER"."C_MKTSEGMENT" IN ('BUILDING', 'HOUSEHOLD') THEN 'High' ELSE 'Low' END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 50bf7bad-5975-4e0e-89a4-9935ce3319e8
          stepCounter: eede1e46-b189-44ea-b26c-cf3c35ed59c9
        config: {}
        dataType: VARCHAR(117)
        description: ""
        hashColumns: []
        hashDetails: null
        name: C_COMMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f532f34b-587b-4672-964a-3c4067353243
                stepCounter: 4f6680e9-aeaa-44b3-b968-eee7d31abc01
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 61001b5e-bd61-45bd-bc19-1a234abb0abf
          stepCounter: eede1e46-b189-44ea-b26c-cf3c35ed59c9
        config: {}
        dataType: VARCHAR(25)
        description: ""
        name: N_NAME
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3613ae84-2dba-4357-aaa7-d7197268670d
                stepCounter: 7f844125-8458-49f7-ba6a-ee9753353faf
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e30ebf3e-a2da-4581-8b15-0c04f7fba9b2
          stepCounter: eede1e46-b189-44ea-b26c-cf3c35ed59c9
        config: {}
        dataType: VARCHAR(152)
        description: ""
        name: N_COMMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7ecd36d0-a273-47a5-87bb-b39a840c5ba2
                stepCounter: 7f844125-8458-49f7-ba6a-ee9753353faf
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c406763b-adfd-4301-9585-eb152d7dd045
          stepCounter: eede1e46-b189-44ea-b26c-cf3c35ed59c9
        config: {}
        dataType: VARCHAR(25)
        description: ""
        name: R_NAME
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 67391709-4cc7-4088-acf5-73d13f8b7fc0
                stepCounter: 4ad0a46b-bdb4-47b6-8b3e-964bfe5f0cf1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5da6720f-8b77-44d4-8271-3dee9edb8bbb
          stepCounter: eede1e46-b189-44ea-b26c-cf3c35ed59c9
        config: {}
        dataType: VARCHAR(152)
        description: ""
        name: R_COMMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: abbc4abe-9c3a-45bd-b9c6-dc92dc73860d
                stepCounter: 4ad0a46b-bdb4-47b6-8b3e-964bfe5f0cf1
            transform: ""
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          CUSTOMER: 4f6680e9-aeaa-44b3-b968-eee7d31abc01
          NATION: 7f844125-8458-49f7-ba6a-ee9753353faf
          REGION: 4ad0a46b-bdb4-47b6-8b3e-964bfe5f0cf1
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: SOURCE-1
            nodeName: CUSTOMER
          - locationName: SOURCE-1
            nodeName: NATION
          - locationName: SOURCE-1
            nodeName: REGION
        join:
          joinCondition: |-
            FROM {{ ref('SOURCE-1', 'CUSTOMER') }} "CUSTOMER"
            INNER JOIN {{ ref('SOURCE-1', 'NATION') }} "NATION"
            ON "CUSTOMER"."C_NATIONKEY" = "NATION"."N_NATIONKEY"
            INNER JOIN {{ ref('SOURCE-1', 'REGION') }} "REGION"
            ON "NATION"."N_REGIONKEY" = "REGION"."R_REGIONKEY"
        name: STG_CUSTOMER
        noLinkRefs: []
  name: STG_CUSTOMER
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
type: Node
