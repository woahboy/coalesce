fileVersion: 1
id: 83f09d9c-871b-4e69-bef9-5f12fc97b07a
name: V_CUSTOMER_LOYALTY
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns: []
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: |-
            {{ stage('Override Create SQL') }}
            CREATE OR REPLACE VIEW {{ ref('TARGET', 'V_CUSTOMER_LOYALTY')}} AS (
            SELECT "CUSTOMER_ID",
              "FIRST_NAME",
              "LAST_NAME",
              UPPER("CITY") AS CITY,
              "COUNTRY",
              LEFT("POSTAL_CODE", 5) AS POSTAL_CODE,
              "E_MAIL",
              "PHONE_NUMBER",
              COALESCE("E_MAIL", "PHONE_NUMBER") AS CONTACT_INFO
            FROM
              "FROSTBYTE_TASTY_BYTES"."RAW_CUSTOMER"."CUSTOMER_LOYALTY" "CUSTOMER_LOYALTY"
            WHERE CUSTOMER_ID IS NOT NULL
            AND (E_MAIL IS NOT NULL OR PHONE_NUMBER IS NOT NULL)
            )
        dependencies:
          - locationName: SOURCE_TASTYBYTES_CUSTOMER
            nodeName: CUSTOMER_LOYALTY
        join:
          joinCondition: FROM {{ ref('SOURCE_TASTYBYTES_CUSTOMER', 'CUSTOMER_LOYALTY') }} "CUSTOMER_LOYALTY"
        name: V_CUSTOMER_LOYALTY
        noLinkRefs: []
  name: V_CUSTOMER_LOYALTY
  overrideSQL: true
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
