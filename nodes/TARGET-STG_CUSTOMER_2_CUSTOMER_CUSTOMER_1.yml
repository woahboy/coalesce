steps:
  STG_CUSTOMER_2_CUSTOMER_CUSTOMER_1-aa6beb92-8431-4882-9f54-a0427f74c168:
    operation:
      config:
        insertStrategy: INSERT
        postSQL: ""
        preSQL: ""
        testsEnabled: true
        truncateBefore: true
      database: ""
      deployEnabled: true
      description: ""
      isDataVault: false
      isMultisource: false
      locationName: TARGET
      materializationType: table
      metadata:
        appliedNodeTests: []
        columns:
          - appliedColumnTests:
              hasNull: true
              isDistinct: false
            columnReference:
              columnCounter: 9d43f4fa-0aaa-479b-b636-57adf1cb389f
              stepCounter: aa6beb92-8431-4882-9f54-a0427f74c168
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: C_CUSTKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 682e0646-a09a-415a-98f1-4b4be4c275ba
                    stepCounter: 3ee5edc1-fc4a-44e7-b6b3-14f8ea5c8676
                transform: ""
          - appliedColumnTests:
              hasNull: false
              isDistinct: true
            columnReference:
              columnCounter: 841fca62-ebd6-44b1-940d-962e5c4cddb2
              stepCounter: aa6beb92-8431-4882-9f54-a0427f74c168
            dataType: VARCHAR(25)
            description: ""
            hashColumns: []
            hashDetails: null
            name: C_NAME
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 25299353-bf9f-4807-9601-819576bcd93d
                    stepCounter: 9bdbc78c-f323-4a64-86cb-d13475a33238
                transform: ""
          - appliedColumnTests:
              hasNull: true
              isDistinct: false
            columnReference:
              columnCounter: e961d690-32ed-41ef-8e8c-6969dee821a2
              stepCounter: aa6beb92-8431-4882-9f54-a0427f74c168
            dataType: VARCHAR(15)
            description: ""
            hashColumns: []
            hashDetails: null
            name: C_PHONE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 443fb232-d6f0-4dd9-ad2b-9dc748dcf5af
                    stepCounter: 9bdbc78c-f323-4a64-86cb-d13475a33238
                transform: ""
          - appliedColumnTests:
              hasNull: false
              isDistinct: false
            columnReference:
              columnCounter: ce2534a8-c3b4-4634-be6e-e54b0066b2f8
              stepCounter: aa6beb92-8431-4882-9f54-a0427f74c168
            dataType: VARCHAR(10)
            description: ""
            hashColumns: []
            hashDetails: null
            name: C_MKTSEGMENT
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: a195cc01-712a-4772-9d6f-b922e6f8314e
                    stepCounter: 1fc050ad-c4f9-411c-a74a-6b7e9bb65c0d
                transform: INITCAP("SATV0_CUSTOMER_2"."C_MKTSEGMENT")
          - appliedColumnTests:
              hasNull: false
              isDistinct: false
            columnReference:
              columnCounter: 41ca69b2-f8c5-476c-81f5-9bf8719c7510
              stepCounter: aa6beb92-8431-4882-9f54-a0427f74c168
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: C_ACCTBAL
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 4dbb0ea4-f260-46c9-a073-5a758260e359
                    stepCounter: 1fc050ad-c4f9-411c-a74a-6b7e9bb65c0d
                transform: ""
          - appliedColumnTests:
              hasNull: false
              isDistinct: false
            columnReference:
              columnCounter: 5574d677-6db4-41d3-b4f8-71c838def0cc
              stepCounter: aa6beb92-8431-4882-9f54-a0427f74c168
            dataType: STRING
            description: ""
            hashColumns: []
            hashDetails: null
            name: C_VALUE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 4dbb0ea4-f260-46c9-a073-5a758260e359
                    stepCounter: 1fc050ad-c4f9-411c-a74a-6b7e9bb65c0d
                transform: CASE WHEN "SATV0_CUSTOMER_2"."C_ACCTBAL" > 5000 AND "SATV0_CUSTOMER_2"."C_MKTSEGMENT" IN ('HOUSEHOLD', 'MACHINERY') THEN 'HIGH' ELSE 'LOW' END
          - appliedColumnTests:
              hasNull: false
              isDistinct: false
            columnReference:
              columnCounter: 3c6d8fd2-d086-41a8-b73d-5b786cd86fe9
              stepCounter: aa6beb92-8431-4882-9f54-a0427f74c168
            dataType: VARCHAR(40)
            description: ""
            hashColumns: []
            hashDetails: null
            name: C_ADDRESS
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 1563d235-704e-4ba7-bc80-8fec51a37e9d
                    stepCounter: 9bdbc78c-f323-4a64-86cb-d13475a33238
                transform: ""
          - appliedColumnTests:
              hasNull: false
              isDistinct: false
            columnReference:
              columnCounter: 5aa62e59-de27-482c-8945-feb06d8c7cfc
              stepCounter: aa6beb92-8431-4882-9f54-a0427f74c168
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: C_NATIONKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: ecced513-75f6-4bc1-b748-75686149d0db
                    stepCounter: 9bdbc78c-f323-4a64-86cb-d13475a33238
                transform: ""
          - appliedColumnTests:
              hasNull: false
              isDistinct: false
            columnReference:
              columnCounter: ee2cfda6-eddf-4acf-b3e8-72c62b053d1a
              stepCounter: aa6beb92-8431-4882-9f54-a0427f74c168
            dataType: VARCHAR(117)
            description: ""
            name: C_COMMENT
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: c099ac68-13c4-4191-a4ee-6c53b4573657
                    stepCounter: 1fc050ad-c4f9-411c-a74a-6b7e9bb65c0d
                transform: ""
        cteString: ""
        enabledColumnTestIDs:
          - hasNull
          - isDistinct
        sourceMapping:
          - aliases:
              HUB_CUSTOMER: 3ee5edc1-fc4a-44e7-b6b3-14f8ea5c8676
              SATV0_CUSTOMER_1: 9bdbc78c-f323-4a64-86cb-d13475a33238
              SATV0_CUSTOMER_2: 1fc050ad-c4f9-411c-a74a-6b7e9bb65c0d
            customSQL:
              customSQL: ""
            dependencies:
              - locationName: SOURCE
                nodeName: HUB_CUSTOMER
              - locationName: SOURCE
                nodeName: SATV0_CUSTOMER_1
              - locationName: SOURCE
                nodeName: SATV0_CUSTOMER_2
            join:
              joinCondition: |-
                FROM {{ ref('SOURCE', 'SATV0_CUSTOMER_2') }} "SATV0_CUSTOMER_2"
                INNER JOIN {{ ref('SOURCE', 'HUB_CUSTOMER') }} "HUB_CUSTOMER"
                ON "SATV0_CUSTOMER_2"."HUB_CUSTOMER_HASH" = "HUB_CUSTOMER"."HUB_CUSTOMER_HASH"
                INNER JOIN {{ ref('SOURCE', 'SATV0_CUSTOMER_1') }} "SATV0_CUSTOMER_1"
                ON "SATV0_CUSTOMER_2"."HUB_CUSTOMER_HASH" = "SATV0_CUSTOMER_1"."HUB_CUSTOMER_HASH"
            name: STG_CUSTOMER_2_CUSTOMER_CUSTOMER_1
            noLinkRefs: []
      name: STG_CUSTOMER_2_CUSTOMER_CUSTOMER_1
      overrideSQL: false
      schema: ""
      sqlType: Stage
      type: sql
    stepCounter: aa6beb92-8431-4882-9f54-a0427f74c168
