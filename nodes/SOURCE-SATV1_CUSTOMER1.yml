steps:
  SATV1_CUSTOMER1-d956366d-9a60-438a-a9e8-db0795161f90:
    operation:
      config:
        postSQL: ""
        preSQL: ""
      database: ""
      deployEnabled: true
      description: Customer data as defined by TPC-H
      isDataVault: false
      isMultisource: false
      locationName: SOURCE
      materializationType: view
      metadata:
        appliedNodeTests: []
        columns:
          - columnReference:
              columnCounter: 448d03be-4d27-4abb-8427-cd7180188059
              stepCounter: d956366d-9a60-438a-a9e8-db0795161f90
            config:
              is_hk: true
            dataType: STRING
            description: ""
            hashColumns: []
            hashDetails: null
            name: HUB_CUSTOMER_HK
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: c6a8beaf-103b-4e0b-8f91-38dc004c44ba
                    stepCounter: 6cae4b4c-153c-464e-a528-e2e0f20a0a1d
                transform: ""
          - columnReference:
              columnCounter: a33af6e8-1f9e-4f42-aa3e-eee8c81f8984
              stepCounter: d956366d-9a60-438a-a9e8-db0795161f90
            dataType: STRING
            description: ""
            hashColumns: []
            hashDetails: null
            name: SAT_CUSTOMER2_HD
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 39fcce48-0546-4a40-ad32-4c42c1c9cb0a
                    stepCounter: 6cae4b4c-153c-464e-a528-e2e0f20a0a1d
                transform: ""
          - columnReference:
              columnCounter: 999dc36e-5664-46d3-ad26-e55535923ce0
              stepCounter: d956366d-9a60-438a-a9e8-db0795161f90
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: C_ACCTBAL
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: d4da2bdc-b71d-4313-a52b-cebba203fb49
                    stepCounter: 6cae4b4c-153c-464e-a528-e2e0f20a0a1d
                transform: ""
          - columnReference:
              columnCounter: 79d5c3b4-3a5f-423f-8ca5-84b51a428258
              stepCounter: d956366d-9a60-438a-a9e8-db0795161f90
            dataType: STRING
            description: ""
            hashColumns: []
            hashDetails: null
            name: C_MKTSEGMENT
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 409e2a01-ab12-42af-a4c1-ab8fe0157f99
                    stepCounter: 6cae4b4c-153c-464e-a528-e2e0f20a0a1d
                transform: ""
          - columnReference:
              columnCounter: 3c1f8c64-3645-406c-b353-292ffff74387
              stepCounter: d956366d-9a60-438a-a9e8-db0795161f90
            dataType: STRING
            description: ""
            hashColumns: []
            hashDetails: null
            name: C_COMMENT
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: f83cfddc-b6d5-4192-a306-ae06078276c5
                    stepCounter: 6cae4b4c-153c-464e-a528-e2e0f20a0a1d
                transform: ""
          - columnReference:
              columnCounter: 3c0871e1-6399-4c93-8cfe-7af7c0594e7d
              stepCounter: d956366d-9a60-438a-a9e8-db0795161f90
            dataType: TIMESTAMP
            description: The Load Date Timestamp (LDTS) describes when this data first arrived in the Data Warehouse.
            hashColumns: []
            hashDetails: null
            name: LDTS
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 9a4bde37-2d76-47ac-99a3-b9e7c07d7304
                    stepCounter: 6cae4b4c-153c-464e-a528-e2e0f20a0a1d
                transform: ""
          - columnReference:
              columnCounter: 0b3b38cb-0855-4efc-8db7-ef3736567077
              stepCounter: d956366d-9a60-438a-a9e8-db0795161f90
            dataType: STRING
            description: The Record Source (RSRC) describes the source of this data.
            hashColumns: []
            hashDetails: null
            name: RSRC
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 1fdee035-ee8e-4b45-b029-6dbfafee4266
                    stepCounter: 6cae4b4c-153c-464e-a528-e2e0f20a0a1d
                transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 3e7bd2df-4360-4599-885d-a92d8bec22a8
              stepCounter: d956366d-9a60-438a-a9e8-db0795161f90
            config: {}
            dataType: TIMESTAMP
            defaultValue: ""
            description: ""
            hashColumns: []
            is_system_ledts: true
            name: LEDTS
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: |-
                  COALESCE(LEAD("{{ datavault4coalesce.config.ldts_alias }}" - INTERVAL '1 MICROSECOND') 
                  OVER (PARTITION BY "{{ get_value_by_column_attribute("is_hk") }}" 
                  ORDER BY "{{ datavault4coalesce.config.ldts_alias }}"), {{ datavault4coalesce__string_to_timestamp(datavault4coalesce.config.timestamp_format, datavault4coalesce.config.end_of_all_times) }})
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: c74dcbc5-bbec-4ea0-91f1-1712fa5241b6
              stepCounter: d956366d-9a60-438a-a9e8-db0795161f90
            config: {}
            dataType: BOOLEAN
            defaultValue: ""
            description: ""
            hashColumns: []
            is_system_current_col: true
            name: IS_CURRENT
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: |-
                  CASE 
                    WHEN 
                      LEAD("{{ datavault4coalesce.config.ldts_alias }}" - INTERVAL '1 MICROSECOND') 
                      OVER (PARTITION BY "{{ get_value_by_column_attribute("is_hk") }}" 
                      ORDER BY "{{ datavault4coalesce.config.ldts_alias }}") IS NULL 
                    THEN TRUE 
                    ELSE FALSE 
                  END
        cteString: ""
        enabledColumnTestIDs: []
        sourceMapping:
          - customSQL:
              customSQL: ""
            dependencies:
              - locationName: SOURCE
                nodeName: SATV0_CUSTOMER1
            join:
              joinCondition: FROM {{ ref('SOURCE', 'SATV0_CUSTOMER1') }} "SATV0_CUSTOMER1"
            name: SATV1_CUSTOMER1
            noLinkRefs: []
      name: SATV1_CUSTOMER1
      overrideSQL: false
      schema: ""
      sqlType: SCALEFREE-DATAVAULT4COALESCE::9
      type: sql
    stepCounter: d956366d-9a60-438a-a9e8-db0795161f90
