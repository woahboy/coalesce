steps:
  SATV1_LINEITEM_N-2aff00dc-0c82-4ada-8e7c-c9e34e066a1a:
    operation:
      config:
        postSQL: ""
        preSQL: ""
      database: ""
      dependencies: []
      deployEnabled: true
      description: Lineitem data as defined by TPC-H
      isDataVault: false
      isMultisource: false
      locationID: ""
      locationName: SOURCE
      materializationType: view
      metadata:
        appliedNodeTests: []
        columns:
          - columnReference:
              columnCounter: 846cf40b-1543-48aa-b533-0a151a449223
              stepCounter: 2aff00dc-0c82-4ada-8e7c-c9e34e066a1a
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_ORDERKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 49830604-96d6-4312-b7e2-6fbb03acf35e
                    stepCounter: 32bfd55c-8b38-4c4b-83d9-9b1f704f60db
                transform: ""
          - columnReference:
              columnCounter: 4e4f796e-e0e0-4a80-b343-f6dfe35a92e6
              stepCounter: 2aff00dc-0c82-4ada-8e7c-c9e34e066a1a
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_PARTKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 8be3f7a1-cbf8-419e-a624-f86345eb67b9
                    stepCounter: 32bfd55c-8b38-4c4b-83d9-9b1f704f60db
                transform: ""
          - columnReference:
              columnCounter: 0b542a2c-3963-43f3-81db-23d14558cec5
              stepCounter: 2aff00dc-0c82-4ada-8e7c-c9e34e066a1a
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_SUPPKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: dab1de24-3244-4ded-a7b9-9ff5485246cb
                    stepCounter: 32bfd55c-8b38-4c4b-83d9-9b1f704f60db
                transform: ""
          - columnReference:
              columnCounter: cdc1b596-3d58-4545-be2e-95ff2fc268a0
              stepCounter: 2aff00dc-0c82-4ada-8e7c-c9e34e066a1a
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_LINENUMBER
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 690edc84-a2c5-4291-a380-f2a3d9ea1f03
                    stepCounter: 32bfd55c-8b38-4c4b-83d9-9b1f704f60db
                transform: ""
          - columnReference:
              columnCounter: 8613e9f3-80bc-4ca9-888d-0e4e49a41a44
              stepCounter: 2aff00dc-0c82-4ada-8e7c-c9e34e066a1a
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_QUANTITY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: c7fa88ad-098f-47df-a960-8da7ec734ef0
                    stepCounter: 32bfd55c-8b38-4c4b-83d9-9b1f704f60db
                transform: ""
          - columnReference:
              columnCounter: 7aa33cfa-022a-4a58-b8d4-f5d2da7417d0
              stepCounter: 2aff00dc-0c82-4ada-8e7c-c9e34e066a1a
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_EXTENDEDPRICE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 30f177fd-8be4-4a35-a6c8-3b5fd5246b70
                    stepCounter: 32bfd55c-8b38-4c4b-83d9-9b1f704f60db
                transform: ""
          - columnReference:
              columnCounter: 129778c1-3d14-4af4-91f1-40d1ec19e4fe
              stepCounter: 2aff00dc-0c82-4ada-8e7c-c9e34e066a1a
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_DISCOUNT
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 4b9e718c-e301-4c1b-87b0-f3d30bac5b38
                    stepCounter: 32bfd55c-8b38-4c4b-83d9-9b1f704f60db
                transform: ""
          - columnReference:
              columnCounter: 6e48cb25-5511-4e2d-8a2e-01b427480a5f
              stepCounter: 2aff00dc-0c82-4ada-8e7c-c9e34e066a1a
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_TAX
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 7b49770d-db7b-4a6c-b096-cb0a1736b35c
                    stepCounter: 32bfd55c-8b38-4c4b-83d9-9b1f704f60db
                transform: ""
          - columnReference:
              columnCounter: 1bc9da18-8453-4587-882c-a4ffab920680
              stepCounter: 2aff00dc-0c82-4ada-8e7c-c9e34e066a1a
            dataType: VARCHAR(1)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_RETURNFLAG
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: da42c33b-bd6b-4c15-a7ca-6dc7d71c5a48
                    stepCounter: 32bfd55c-8b38-4c4b-83d9-9b1f704f60db
                transform: ""
          - columnReference:
              columnCounter: 7bc3b404-8597-4a27-9c87-167aa6a36f28
              stepCounter: 2aff00dc-0c82-4ada-8e7c-c9e34e066a1a
            dataType: VARCHAR(1)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_LINESTATUS
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: b047c553-f74d-42cb-aa43-fd5b1b205287
                    stepCounter: 32bfd55c-8b38-4c4b-83d9-9b1f704f60db
                transform: ""
          - columnReference:
              columnCounter: 341a0056-935e-483a-83a0-3e51cf256422
              stepCounter: 2aff00dc-0c82-4ada-8e7c-c9e34e066a1a
            dataType: DATE
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_SHIPDATE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 143e2322-ccfd-4261-9f6f-c3a356bd8bff
                    stepCounter: 32bfd55c-8b38-4c4b-83d9-9b1f704f60db
                transform: ""
          - columnReference:
              columnCounter: 66897a39-1dc6-4d2b-862a-a696c1bf9129
              stepCounter: 2aff00dc-0c82-4ada-8e7c-c9e34e066a1a
            dataType: DATE
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_COMMITDATE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: e2cbfde7-eb8c-4d97-89f7-8102d17bc6ed
                    stepCounter: 32bfd55c-8b38-4c4b-83d9-9b1f704f60db
                transform: ""
          - columnReference:
              columnCounter: ef1b6601-199b-4416-a678-17116de608cf
              stepCounter: 2aff00dc-0c82-4ada-8e7c-c9e34e066a1a
            dataType: DATE
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_RECEIPTDATE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: b8cb21bd-6705-4559-8033-dbc0e07ed0f9
                    stepCounter: 32bfd55c-8b38-4c4b-83d9-9b1f704f60db
                transform: ""
          - columnReference:
              columnCounter: e1a4d555-8e0a-476f-94fa-3d282508605a
              stepCounter: 2aff00dc-0c82-4ada-8e7c-c9e34e066a1a
            dataType: VARCHAR(25)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_SHIPINSTRUCT
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 6833285e-f7fa-4d9b-999d-892a8a3f3d9c
                    stepCounter: 32bfd55c-8b38-4c4b-83d9-9b1f704f60db
                transform: ""
          - columnReference:
              columnCounter: 178b6731-e3b8-4c11-bcd1-39f6144f67fc
              stepCounter: 2aff00dc-0c82-4ada-8e7c-c9e34e066a1a
            dataType: VARCHAR(10)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_SHIPMODE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 253ee584-656c-41f9-8709-16242baedca9
                    stepCounter: 32bfd55c-8b38-4c4b-83d9-9b1f704f60db
                transform: ""
          - columnReference:
              columnCounter: e3202d5c-1a3c-4ae3-9ba4-852ff6dec337
              stepCounter: 2aff00dc-0c82-4ada-8e7c-c9e34e066a1a
            dataType: VARCHAR(44)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_COMMENT
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 92d5f30d-1763-4af6-b002-371159ec9139
                    stepCounter: 32bfd55c-8b38-4c4b-83d9-9b1f704f60db
                transform: ""
          - columnReference:
              columnCounter: 49b90eb4-b059-49a3-8ded-7202d9012294
              stepCounter: 2aff00dc-0c82-4ada-8e7c-c9e34e066a1a
            dataType: TIMESTAMP
            description: The Load Date Timestamp (LDTS) describes when this data first arrived in the Data Warehouse.
            hashColumns: []
            hashDetails: null
            name: LDTS
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 98281a10-f9c7-4071-90bc-384317b707ba
                    stepCounter: 32bfd55c-8b38-4c4b-83d9-9b1f704f60db
                transform: ""
          - columnReference:
              columnCounter: c41381b7-9e78-48f4-b1a9-6b172dcc3ab6
              stepCounter: 2aff00dc-0c82-4ada-8e7c-c9e34e066a1a
            dataType: STRING
            description: The Record Source (RSRC) describes the source of this data.
            hashColumns: []
            hashDetails: null
            name: RSRC
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: cce489ed-d7b4-44bc-aabe-6bf0a9307585
                    stepCounter: 32bfd55c-8b38-4c4b-83d9-9b1f704f60db
                transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 85b9fd51-c540-4b25-ab36-e9a810b8d9ad
              stepCounter: 2aff00dc-0c82-4ada-8e7c-c9e34e066a1a
            config: {}
            dataType: TIMESTAMP
            defaultValue: ""
            description: ""
            hashColumns: []
            is_system_ledts: true
            name: LEDTS
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: |-
                  COALESCE(LEAD("{{ datavault4coalesce.config.ldts_alias }}" - INTERVAL '1 MICROSECOND') 
                  OVER (PARTITION BY "{{ get_value_by_column_attribute("is_hk") }}" 
                  ORDER BY "{{ datavault4coalesce.config.ldts_alias }}"), {{ datavault4coalesce__string_to_timestamp(datavault4coalesce.config.timestamp_format, datavault4coalesce.config.end_of_all_times) }})
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 780c88ae-4435-4651-866a-6b6bd0067f6c
              stepCounter: 2aff00dc-0c82-4ada-8e7c-c9e34e066a1a
            config: {}
            dataType: BOOLEAN
            defaultValue: ""
            description: ""
            hashColumns: []
            is_system_current_col: true
            name: IS_CURRENT
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: |-
                  CASE 
                    WHEN 
                      LEAD("{{ datavault4coalesce.config.ldts_alias }}" - INTERVAL '1 MICROSECOND') 
                      OVER (PARTITION BY "{{ get_value_by_column_attribute("is_hk") }}" 
                      ORDER BY "{{ datavault4coalesce.config.ldts_alias }}") IS NULL 
                    THEN TRUE 
                    ELSE FALSE 
                  END
        cteString: ""
        enabledColumnTestIDs: []
        sourceMapping:
          - customSQL:
              customSQL: ""
            dependencies:
              - locationName: SOURCE
                nodeName: SATV0_LINEITEM_N
            join:
              joinCondition: FROM {{ ref('SOURCE', 'SATV0_LINEITEM_N') }} "SATV0_LINEITEM_N"
            name: SATV1_LINEITEM_N
            noLinkRefs: []
      name: SATV1_LINEITEM_N
      overrideSQL: false
      schema: ""
      sqlType: SCALEFREE-DATAVAULT4COALESCE::9
      type: sql
    stepCounter: 2aff00dc-0c82-4ada-8e7c-c9e34e066a1a
